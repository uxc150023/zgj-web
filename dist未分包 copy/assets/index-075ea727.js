import{c as e}from"./tree-8bedc90b.js";import{_ as a,v as l,h as t,H as o,i as s,s as d,r as n,o as i,c as p,m as u,a as r,w as c,u as m,F as f,e as y,f as v,l as h,b3 as g,g as I,cB as b,y as w,z as T,P as k,Q as x,t as M,a2 as D,b4 as V,j as S,k as _,n as C,b as B,p as A,q as U,cC as j,cD as N,ad as L,x as E,Y as F}from"./main-5d732c2e.js";import{_ as O}from"./ketanchude-65de0c89.js";import{K as q}from"./KDocumentTypeDialog-1f624042.js";import{u as R,a as z,M as J}from"./index-60e1d355.js";import P from"./index-54331740.js";import $ from"./index-bf861a3a.js";import H from"./index-c35f8797.js";import{M as Y}from"./ModelApi-c4f72d60.js";import{a as W}from"./index-b9b96043.js";import{J as K}from"./JyTable-96032540.js";import{_ as G}from"./index-4f386a23.js";/* empty css                                                             */import"./home-back-426c97de.js";import"./logo-00c7cf54.js";import"./request-util-ecea08f4.js";import"./sangedian-b1ee72e5.js";import"./Layout-db7f64fa.js";import"./searchForm-a97b647c.js";import"./pagination-569fa38f.js";import"./batch-e7262433.js";import"./index-18b4acbd.js";import"./cha-kong-1ced20bc.js";import"./index-01980554.js";import"./yuan-hui-e1a80bc6.js";const Q=e=>(w("data-v-b5f496d1"),e=e(),T(),e),X={class:"flowManage-basics-info"},Z={class:"info-box"},ee=Q((()=>u("div",{class:"info-title"}," 请填写如下基础信息 ",-1))),ae={class:"info-from"},le=I(" 物理用印 "),te=I(" 电子签章 "),oe={class:"contbox"},se=Q((()=>u("div",{class:"box-icon"},[u("img",{class:"box-icon-img",src:O,alt:""})],-1))),de={class:"contbox"},ne=Q((()=>u("div",{class:"box-icon"},[u("img",{class:"box-icon-img",src:O,alt:""})],-1))),ie=I(" 变更会清空已设计的流程，请问确定要继续吗？ "),pe=a({props:{businessList:{type:Array,default:()=>[]},modelValue:{type:String,default:""},sealId:{type:String,default:""},sealApplyInitId:{type:String,default:""},openType:{type:String,default:"add"},editBasicsForm:{type:Object,default:()=>({flowName:"",applyTypeId:"",sealUseTypeId:"1",fileTypeIds:[],fileTypeScope:[],showDataScope:[],dataScope:[],readme:""})},modelLinkId:{type:Object,deftault:()=>({})}},emits:"update:modelValue",setup(e,{expose:a,emit:I}){const w=e,T=R(),k=l(!1),x=l(!1),M=l([]),D=l(["user","organ"]),V=l("user"),S=l([]),_=l([]),C=l(null),B=l(!1),A=t({flowName:"",applyTypeId:"",sealUseTypeId:"1",fileTypeIds:[],fileTypeScope:[],showDataScope:[],dataScope:[],readme:""}),U=t({flowName:[{required:!0,message:"请填写流程名称",trigger:"change"}],applyTypeId:[{required:!0,message:"请选择业务类型",trigger:"change"}],sealUseTypeId:[{required:!0,message:"请选择用印类型",trigger:"change"}],fileTypeIds:[{required:!0,message:"请选择文件类型",trigger:["change","blur"]}],showDataScope:[{required:!0,message:"请选择流程适用范围",trigger:["change","blur"]}]}),j=o("accountInfo")&&o("accountInfo").userInfo?o("accountInfo").userInfo.userId:"",N=l({userId:j});s((()=>w.editBasicsForm),(e=>{if(e&&e.flowName&&"edit"===w.openType){A.flowName=e.flowName,A.applyTypeId=e.applyTypeId,A.sealUseTypeId=e.sealUseTypeId,A.readme=e.readme;const a=JSON.parse(JSON.stringify(e.fileTypeScope)),l=JSON.parse(JSON.stringify(e.dataScope));J(l),ue(a),M.value=l,Q.value=a}}));const L=l(null),E=()=>{L.value.blur(),x.value=!0},F=l(null),O=()=>{F.value.blur(),k.value=!0};A.sealUseTypeId=d({get:()=>w.sealId,set(e){I("update:sealId",e)}});const z=e=>{M.value=e,J(e)},J=e=>{const a=[];e&&e.length>0?(A.dataScope=[],_.value=e,e.forEach((e=>{a.push(e.id),A.dataScope.push({scopeId:e.id,scopeName:e.name,includeChild:e.includeChild,scopeType:"user"===e.type?1:2})})),A.showDataScope=a):(A.showDataScope=[],A.dataScope=[])},P=d({get:()=>w.modelLinkId,set(e){I("update:modelLinkId",e)}}),$=l("apply"),H=l(null),Y=()=>{P.value.modelId&&(H.value.blur(),B.value=!0,$.value="apply")},W=()=>{B.value=!1,"apply"===$.value?H.value.toggleMenu():A.sealUseTypeId="1"===A.sealUseTypeId?"2":"1",T.setModelId("",""),P.value={modleId:"",definitionId:""}},K=()=>{B.value=!1,"apply"===$.value&&H.value.blur()},G=e=>{P.value.modelId&&(A.sealUseTypeId=e,B.value=!0,$.value="sealType")};s((()=>A.applyTypeId),(e=>{I("update:modelValue",e)})),s((()=>w.modelValue),(e=>{A.applyTypeId=e}),{deep:!0,immediate:!0});const Q=l([]),pe=e=>{Q.value=e,ue(e)},ue=e=>{const a=[],l=[],t=[];e.forEach((e=>{a.push({fileTypeId:e.id,fileTypeName:e.name,includeChild:e.includeChild?"1":"0",type:"fileType"}),l.push({id:e.id,name:e.name}),t.push(e.id)})),S.value=l,A.fileTypeIds=t,A.fileTypeScope=a},re=e=>{Q.value=me(Q.value,e)},ce=e=>{M.value=me(M.value,e)},me=(e,a)=>Array.isArray(e)&&0!==e.length?e.filter((e=>e.id!==a)):e;return a({getBasicsFormValue:async()=>{const e=await C.value.validate().catch((e=>e));return"boolean"==typeof e&&e?A:[e]},form:A}),(e,a)=>{const l=n("el-input"),t=n("el-form-item"),o=n("el-option"),s=n("el-option-group"),d=n("el-select"),I=n("el-radio"),T=n("el-radio-group"),j=n("el-form"),R=b;return i(),p("div",X,[u("div",Z,[ee,u("div",ae,[r(j,{model:m(A),"label-width":"120px",rules:m(U),ref_key:"ruleFormRef",ref:C},{default:c((()=>[r(t,{label:"流程名称",prop:"flowName"},{default:c((()=>[r(l,{modelValue:m(A).flowName,"onUpdate:modelValue":a[0]||(a[0]=e=>m(A).flowName=e),placeholder:"请输入",clearable:"",maxlength:"45"},null,8,["modelValue"])])),_:1}),r(t,{label:"业务类型",prop:"applyTypeId"},{default:c((()=>[r(d,{modelValue:m(A).applyTypeId,"onUpdate:modelValue":a[1]||(a[1]=e=>m(A).applyTypeId=e),ref_key:"selectApplyRef",ref:H,onClick:Y},{default:c((()=>[(i(!0),p(f,null,y(w.businessList,(e=>(i(),v(s,{key:e.applyTypeName,label:e.applyTypeName},{default:c((()=>[(i(!0),p(f,null,y(e.children,(e=>(i(),v(o,{key:e.applyTypeId,label:e.applyTypeName,value:e.applyTypeId},null,8,["label","value"])))),128))])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),m(A).applyTypeId===w.sealApplyInitId?(i(),v(t,{key:0,label:"用印类型",prop:"sealUseTypeId"},{default:c((()=>[r(T,{modelValue:m(A).sealUseTypeId,"onUpdate:modelValue":a[4]||(a[4]=e=>m(A).sealUseTypeId=e)},{default:c((()=>[r(I,{label:"1",size:"large",onChange:a[2]||(a[2]=e=>G("2"))},{default:c((()=>[le])),_:1}),r(I,{label:"2",size:"large",onChange:a[3]||(a[3]=e=>G("1"))},{default:c((()=>[te])),_:1})])),_:1},8,["modelValue"])])),_:1})):h("",!0),m(A).applyTypeId===w.sealApplyInitId?(i(),v(t,{key:1,label:"文件类型",prop:"fileTypeIds"},{default:c((()=>[u("div",oe,[r(d,{modelValue:m(A).fileTypeIds,"onUpdate:modelValue":a[5]||(a[5]=e=>m(A).fileTypeIds=e),ref_key:"selectRef",ref:L,placeholder:"请选择",multiple:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":4,onClick:E,onRemoveTag:re},{default:c((()=>[(i(!0),p(f,null,y(S.value,(e=>(i(),v(o,{label:e.name,value:e.id,key:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),se])])),_:1})):h("",!0),r(t,{label:"流程适用范围",prop:"showDataScope"},{default:c((()=>[u("div",de,[r(d,{modelValue:m(A).showDataScope,"onUpdate:modelValue":a[6]||(a[6]=e=>m(A).showDataScope=e),ref_key:"selectFileRef",ref:F,placeholder:"请选择",multiple:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":4,onClick:O,onRemoveTag:ce},{default:c((()=>[(i(!0),p(f,null,y(_.value,(e=>(i(),v(o,{label:e.name,value:e.id,key:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),ne])])),_:1}),r(t,{label:"流程说明"},{default:c((()=>[r(l,{modelValue:m(A).readme,"onUpdate:modelValue":a[7]||(a[7]=e=>m(A).readme=e),type:"textarea",maxlength:"100","show-word-limit":"",placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])]),k.value?(i(),v(m(g),{key:0,show:k.value,"onUpdate:show":a[8]||(a[8]=e=>k.value=e),searchSelected:M.value,"onUpdate:searchSelected":z,tabsShow:D.value,activeTab:V.value},null,8,["show","searchSelected","tabsShow","activeTab"])):h("",!0),x.value?(i(),v(m(q),{key:1,show:x.value,"onUpdate:show":a[9]||(a[9]=e=>x.value=e),searchSelected:Q.value,"onUpdate:searchSelected":pe,queryParams:N.value},null,8,["show","searchSelected","queryParams"])):h("",!0),r(R,{modelValue:B.value,"onUpdate:modelValue":a[10]||(a[10]=e=>B.value=e),mode:1,onOnConfirm:W,onOnCancel:K},{default:c((()=>[ie])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-b5f496d1"]]),ue="/assets/vector-0f9d5285.svg",re=e=>(w("data-v-7dc9f8f7"),e=e(),T(),e),ce={class:"flowManage-Association-form"},me={class:"choice"},fe={class:"info-box"},ye=D('<div class="info-title" data-v-7dc9f8f7> 选择表单进行关联 </div><div class="info-remind" data-v-7dc9f8f7><div class="info-remind-title" data-v-7dc9f8f7><div class="info-remind-title-icon" data-v-7dc9f8f7><i class="icon" data-v-7dc9f8f7><svg class="iconpark-icon" data-v-7dc9f8f7><use href="#Check-Circle" data-v-7dc9f8f7></use></svg></i></div><div class="info-remind-title-text" data-v-7dc9f8f7> 提示 </div></div><div class="info-remind-p" data-v-7dc9f8f7> 1: 如果关联表单，则该流程仅用于当前表单； </div><div class="info-remind-p" data-v-7dc9f8f7> 2: 若当前业务类型/文件类型换绑新的表单，则新表单无法使用当前流程； </div><div class="info-remind-p" data-v-7dc9f8f7> 3: 如果不关联表单，无论当前业务类型/文件类型绑定的表单怎么变更，该流程都可使用。 </div></div>',2),ve={class:"info-form"},he=I(" 物理用印 "),ge=I(" 电子签章 "),Ie={key:0,class:"info-noContent"},be=[re((()=>u("img",{src:ue},null,-1))),re((()=>u("div",{class:"text"},"去创建",-1)))],we=re((()=>u("div",{class:"info-noContent-desc"},[u("img",{src:"/assets/info-6c401016.svg"}),I(" 暂无可关联的表单 ")],-1))),Te={key:1,class:"info-list"},ke={class:"container-list"},xe={class:"list-desc"},Me={style:{"margin-top":"4px"}},De=I(" 选择 "),Ve=[re((()=>u("img",{src:ue},null,-1))),re((()=>u("div",{class:"text"},"去创建",-1)))],Se=re((()=>u("i",null,null,-1))),_e=re((()=>u("i",null,null,-1))),Ce=re((()=>u("i",null,null,-1))),Be=re((()=>u("i",null,null,-1))),Ae=re((()=>u("i",null,null,-1))),Ue=re((()=>u("i",null,null,-1))),je={key:0,class:"exhibition"},Ne={class:"info-footer"},Le=I("编辑"),Ee=I("重新选择"),Fe=I(" 变更会清空已设计的流程，请问确定要继续吗？ "),Oe=a({props:{businessList:{type:Array,default:()=>[]},modelValue:{type:String,default:""},sealId:{type:String,default:"1"},sealApplyInitId:{type:String,default:""},openType:{type:String,default:"add"},formMessageId:{type:String,default:""},modelLinkId:{type:Object,deftault:()=>({})}},emits:"update:modelValue",setup(e,{expose:a,emit:o}){const g=e,I=R(),w=l(null),T=l(""),D=l(null),S=l(!0),_=l(!1),C=l(!1),B=t({currentState:"1",list:{radio:"",data:[]},JyElMessageBox:{show:!1,header:{data:""},content:{data:""}},SealformData:{},SealoptionData:{},showRelatedfFlow:{show:!1,header:{data:"",icon:"/src/assets/svg/common/warning.svg"},content:{data:""}},componentsBatch:{selectionData:[],defaultAttribute:{disabled:!0},data:[{name:"批量删除"}],butDatas:[{name:"知道了",type:"",clickName:function(){}}]}});const A=t({ProcessName:"",ProcessType:!1,sealUseTypeId:"1",applyTypeId:"",formMessageId:"",formDefinitionId:""}),U=d({get:()=>g.modelLinkId,set(e){o("update:modelLinkId",e)}}),j=l("apply"),N=l(null),L=()=>{U.value.modelId&&(N.value.blur(),C.value=!0,j.value="apply")},E=()=>{C.value=!1,"apply"===j.value?N.value.toggleMenu():A.sealUseTypeId="1"===A.sealUseTypeId?"2":"1",I.setModelId("",""),U.value={modleId:"",definitionId:""}},F=()=>{C.value=!1,"apply"===j.value&&N.value.blur()},O=e=>{U.value.modelId&&(A.sealUseTypeId=e,C.value=!0,j.value="sealType")},q=l(""),J=e=>{q.value=e.formMessageId,S.value=!1,z.getFormJsonById({formMessageId:e.formMessageId}).then((a=>{A.formMessageId=a.data.formMessageId,A.formDefinitionId=a.data.formDefinitionId,B.currentState="2",T.value=a.success&&JSON.parse(a.data.formInfo)||"",D.value=e,S.value=!0}))};s((()=>g.formMessageId),(e=>{e&&J({formMessageId:e})}));const W=()=>{B.currentState="1"},K=()=>{!async function(e){if(!e)return D.value={formMessageId:null},void(B.JyElMessageBox.show=!0);const a=await V.flowList({formMessageId:e});a.data&&0!==a.data.length?(B.showRelatedfFlow.show=!0,G.value={header:"提示",content:"当前表单被已启用的以下流程所使用，仅当以下流程停用才允许编辑",selectionData:a.data}):(D.value={formMessageId:null},B.JyElMessageBox.show=!0)}(q.value)},G=l(null);const Q=async()=>{try{const e={applyTypeId:A.applyTypeId,sealUseTypeId:A.sealUseTypeId},a=await z.flowSettingForm(e);B.list.data=a.data||[],_.value=!0}catch(e){}};s((()=>A.applyTypeId),(e=>{if(!e)return _.value=!1;B.list.data=[],Q(),o("update:modelValue",e)}),{deep:!0,immediate:!0}),s((()=>g.modelValue),(e=>{A.applyTypeId=e}),{deep:!0,immediate:!0}),A.sealUseTypeId=d({get:()=>g.sealId,set(e){o("update:sealId",e)}}),s((()=>A.sealUseTypeId),(e=>{e&&!U.value.modelId&&Q()}),{deep:!0,immediate:!0});return a({getAssociationValue:()=>A.formDefinitionId?A:[{formDefinitionId:[{message:"请选择关联表单",fieldValue:"",field:"formDefinitionId"}]}],saveAddModel:e=>new Promise(((a,l)=>{if(!A.formDefinitionId)return void l("请选择表单");const t=Math.random();Y.add({modelKey:t,formIdList:[A.formDefinitionId],modelName:e}).then((()=>{Y.getModelKey({modelKey:t}).then((e=>{a({modelId:e.modelId,definitionId:e.definitionId})}))}))}))}),(e,a)=>{const l=n("el-option"),t=n("el-option-group"),o=n("el-select"),s=n("el-form-item"),d=n("el-radio"),I=n("el-radio-group"),V=n("el-form"),U=n("el-button"),j=n("el-scrollbar"),q=$,R=n("JyElMessageBox"),z=P,Y=b;return i(),p("div",ce,[k(u("div",me,[u("div",fe,[ye,u("div",ve,[r(V,{model:m(A),"label-width":"80px","status-icon":"",style:{width:"500px"}},{default:c((()=>[r(s,{label:"业务类型",prop:"applyTypeId",required:""},{default:c((()=>[r(o,{modelValue:m(A).applyTypeId,"onUpdate:modelValue":a[0]||(a[0]=e=>m(A).applyTypeId=e),ref_key:"selectApplyRef",ref:N,onClick:L},{default:c((()=>[(i(!0),p(f,null,y(g.businessList,(e=>(i(),v(t,{key:e.applyTypeName,label:e.applyTypeName},{default:c((()=>[(i(!0),p(f,null,y(e.children,(e=>(i(),v(l,{key:e.applyTypeId,label:e.applyTypeName,value:e.applyTypeId},null,8,["label","value"])))),128))])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),m(A).applyTypeId===g.sealApplyInitId?(i(),v(s,{key:0,label:"用印类型",prop:"sealUseTypeId"},{default:c((()=>[r(I,{modelValue:m(A).sealUseTypeId,"onUpdate:modelValue":a[3]||(a[3]=e=>m(A).sealUseTypeId=e)},{default:c((()=>[r(d,{label:"1",size:"large",onChange:a[1]||(a[1]=e=>O("2"))},{default:c((()=>[he])),_:1}),r(d,{label:"2",size:"large",onChange:a[2]||(a[2]=e=>O("1"))},{default:c((()=>[ge])),_:1})])),_:1},8,["modelValue"])])),_:1})):h("",!0)])),_:1},8,["model"])]),0===m(B).list.data.length&&_.value?(i(),p("div",Ie,[u("div",{class:"info-noContent-backcolor",onClick:K},be),we])):h("",!0),m(A).applyTypeId&&0!==m(B).list.data.length?(i(),p("div",Te,[r(j,{style:{height:"100%"},"view-style":"padding: 0 54px"},{default:c((()=>[u("div",ke,[(i(!0),p(f,null,y(m(B).list.data,((e,a)=>(i(),p("div",{class:"list",key:a},[u("div",xe,M(e.formName),1),u("div",Me,[r(U,{type:"primary",class:"btn",onClick:a=>J(e)},{default:c((()=>[De])),_:2},1032,["onClick"])])])))),128)),u("div",{class:"info-noContent-backcolor",onClick:K},Ve),Se,_e,Ce,Be,Ae,Ue])])),_:1})])):h("",!0)])],512),[[x,"1"===m(B).currentState]]),"2"===m(B).currentState?(i(),p("div",je,[r(j,{class:"info-box",always:""},{default:c((()=>[S.value?(i(),v(q,{key:0,mode:"render",formJson:T.value,formData:m(B).SealformData,optionData:m(B).SealoptionData,ref_key:"refFillFormInformation",ref:w,onOnLoaded:a[4]||(a[4]=e=>w.value.disableForm())},null,8,["formJson","formData","optionData"])):h("",!0)])),_:1}),u("div",Ne,[r(U,{type:"primary",onClick:K},{default:c((()=>[Le])),_:1}),r(U,{onClick:W},{default:c((()=>[Ee])),_:1})])])):h("",!0),u("div",null,[r(R,{modelValue:m(B).JyElMessageBox.show,"onUpdate:modelValue":a[7]||(a[7]=e=>m(B).JyElMessageBox.show=e),"custom-content":!0,defaultAttribute:{fullscreen:!0,height:"100%"}},{default:c((()=>[m(B).JyElMessageBox.show?(i(),v(H,{key:0,modelValue:m(B).JyElMessageBox.show,"onUpdate:modelValue":a[5]||(a[5]=e=>m(B).JyElMessageBox.show=e),addTitle:"编辑",columnData:D.value,onClose:a[6]||(a[6]=e=>m(B).JyElMessageBox.show=!1),sealUseTypeId:m(A).sealUseTypeId,applyTypeId:m(A).applyTypeId,optionData:g.businessList,onReloadData:J},null,8,["modelValue","columnData","sealUseTypeId","applyTypeId","optionData"])):h("",!0)])),_:1},8,["modelValue"])]),r(z,{"onUpdate:modelValue":a[8]||(a[8]=e=>m(B).showRelatedfFlow.show=!1),show:m(B).showRelatedfFlow.show,selectionData:m(B).componentsBatch.selectionData,showToastDialogContent:G.value,label:"flowName"},null,8,["show","selectionData","showToastDialogContent"]),r(Y,{modelValue:C.value,"onUpdate:modelValue":a[9]||(a[9]=e=>C.value=e),mode:1,onOnConfirm:E,onOnCancel:F},{default:c((()=>[Fe])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-7dc9f8f7"]]),qe=e=>(w("data-v-4d3f2f55"),e=e(),T(),e),Re={class:"flowManage-advanced-setup"},ze={class:"info-box"},Je={class:"time"},Pe={class:"time-eminder"},$e=D('<div class="time-eminder-label" data-v-4d3f2f55><span class="time-eminder-label-text" data-v-4d3f2f55> 超时提醒 </span><i class="icon" data-v-4d3f2f55><svg class="iconpark-icon" data-v-4d3f2f55><use href="#Vector1" data-v-4d3f2f55></use></svg></i></div>',1),He={class:"time-eminder-switch"},Ye={class:"time-Number"},We=qe((()=>u("span",{class:"time-Number-text"},"超时",-1))),Ke={class:"time-Number-input"},Ge=qe((()=>u("span",{class:"time-Number-text"},"小时",-1))),Qe={class:"deWeight"},Xe=qe((()=>u("span",{class:"deWeight-text"},"审批人自动去重",-1))),Ze={class:"deWeight-radio"},ea=I("不去重"),aa=I("出现多次时，仅保留第一次"),la=I("在连续出现时，仅保留第一次"),ta=a({setup(e){const a=t({isTimeoutRemind:1,remindDuration:24,autoDistinct:0});return(e,l)=>{const t=n("el-switch"),o=n("el-input-number"),s=n("el-radio"),d=n("el-radio-group");return i(),p("div",Re,[u("div",ze,[u("div",Je,[u("div",Pe,[$e,u("div",He,[r(t,{modelValue:m(a).isTimeoutRemind,"onUpdate:modelValue":l[0]||(l[0]=e=>m(a).isTimeoutRemind=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])]),u("div",Ye,[We,u("div",Ke,[r(o,{modelValue:m(a).remindDuration,"onUpdate:modelValue":l[1]||(l[1]=e=>m(a).remindDuration=e),min:0},null,8,["modelValue"])]),Ge])]),u("div",Qe,[Xe,u("div",Ze,[r(d,{modelValue:m(a).autoDistinct,"onUpdate:modelValue":l[2]||(l[2]=e=>m(a).autoDistinct=e)},{default:c((()=>[r(s,{label:0},{default:c((()=>[ea])),_:1}),r(s,{label:1},{default:c((()=>[aa])),_:1}),r(s,{label:2},{default:c((()=>[la])),_:1})])),_:1},8,["modelValue"])])])])])}}},[["__scopeId","data-v-4d3f2f55"]]),oa=e=>(w("data-v-a7c7c40d"),e=e(),T(),e),sa={class:"components-ElMessageBox"},da={key:0,class:"dialog-header"},na={key:0,class:"dialog-header-icon"},ia=[oa((()=>u("svg",{class:"iconpark-icon"},[u("use",{href:"#icon4"})],-1)))],pa={key:1,class:"dialog-header-cont"},ua=[oa((()=>u("svg",{class:"iconpark-icon"},[u("use",{href:"#Vector"})],-1)))],ra={key:1,class:"cut-off-rule"},ca={key:2,class:"cut-off-rule"},ma=I("确定"),fa=I("取消"),ya=a({props:{type:{type:String,default:"0"},modelValue:{type:Boolean,default:!0},"show-cut-off-rule":{type:Boolean,default:!1},"show-close":{type:Boolean,default:!0},"show-icon":{type:Boolean,default:!1},"show-title":{type:Boolean,default:!0},"show-footer":{type:Boolean,default:!0},"show-header":{type:Boolean,default:!0},"custom-content":{type:Boolean,default:!1},defaultAttribute:{type:Object,default:()=>({})}},emits:["close","update:modelValue"],setup(e,{emit:a}){const l=e,o=t({props:{defaultAttribute:{"align-center":!0,"show-close":!1,width:"500px",center:!1}}});function d(){const e=o.props;for(const a in l)Object.hasOwnProperty.call(e,a)?"defaultAttribute"!==a&&(e[a]=l[a]):e[a]=l[a];for(const a in l.defaultAttribute)Object.hasOwnProperty.call(l.defaultAttribute,a)&&(e.defaultAttribute[a]=l.defaultAttribute[a])}function f(){o.props.modelValue=!1}function y(){o.props.modelValue=!1,a("update:modelValue",o.props.modelValue)}return s(l,((e,a)=>{d()})),S((()=>{d()})),_((()=>{})),(e,a)=>{const l=n("el-button"),t=J;return i(),p("div",sa,[r(t,U({visible:m(o).props.modelValue,"onUpdate:visible":a[0]||(a[0]=e=>m(o).props.modelValue=e)},m(o).props.defaultAttribute,{footer:null,keyboard:!1,width:"100%","wrap-class-name":"full-modal",getContainer:!1,closable:!1,zIndex:1003,onOnCancel:y,onOnOk:y}),{default:c((()=>[m(o).props.customContent?(i(),p("div",{key:0,class:"dialog",style:C({height:m(o).props.defaultAttribute.height})},[B(e.$slots,"default",{},void 0,!0)],4)):(i(),p("div",{key:1,class:"dialog",style:C({height:m(o).props.defaultAttribute.height})},[m(o).props.showHeader&&(m(o).props.showIcon||m(o).props.showTitle||m(o).props.showCutOffRule)?(i(),p("div",da,[m(o).props.showIcon?(i(),p("div",na,ia)):h("",!0),m(o).props.showTitle?(i(),p("div",pa,[B(e.$slots,"header",{},void 0,!0)])):h("",!0),m(o).props.showClose?(i(),p("div",{key:2,class:"dialog-header-remove",onClick:f},ua)):h("",!0)])):h("",!0),m(o).props.showCutOffRule?(i(),p("div",ra)):h("",!0),u("div",{class:A(["dialog-content",{"center-content":!!m(o).props.defaultAttribute.center}])},[B(e.$slots,"content",{},void 0,!0)],2),m(o).props.showCutOffRule?(i(),p("div",ca)):h("",!0),m(o).props.showFooter?(i(),p("div",{key:3,class:A(["dialog-footer",{"center-footer":!!m(o).props.defaultAttribute.center}])},[B(e.$slots,"footer",{},(()=>[r(l,{type:"primary"},{default:c((()=>[ma])),_:1}),r(l,{onClick:f},{default:c((()=>[fa])),_:1})]),!0)],2)):h("",!0)],4))])),_:3},16,["visible"])])}}},[["__scopeId","data-v-a7c7c40d"]]),va=e=>(w("data-v-385067d7"),e=e(),T(),e),ha={class:"add-flow-modal"},ga={class:"flowManage-layout"},Ia={class:"process"},ba={class:"header"},wa={class:"process-back"},Ta=[va((()=>u("svg",{class:"iconpark-icon"},[u("use",{href:"#Vector8Stroke"})],-1)))],ka={class:"process-back-text"},xa={class:"process-tabs"},Ma=["onClick"],Da={class:"tabs-icon"},Va={class:"tabs-text"},Sa={class:"process-save"},_a={class:"process-save-down"},Ca={class:"process-save-down-text"},Ba={class:"popover-cont"},Aa=va((()=>u("div",{class:"popover-cont-title"}," 内容不完善，当前无法发布 ",-1))),Ua=va((()=>u("div",{class:"popover-cont-subTitle"}," 以下内容不完善，请修改后发布 ",-1))),ja={key:0,class:"popover-cont-list"},Na={class:"popover-cont-list-li-name"},La={class:"popover-cont-list-li-desc"},Ea=va((()=>u("div",{class:"popover-cont-list-li-but"},"去修改 ",-1))),Fa={class:"content"},Oa=I(" 确定 "),qa=a({props:{modelValue:{type:Boolean,default:!1},businessList:{type:Array,default:()=>[]},openType:{type:String,default:"add"},treeSelectedId:{type:String,default:""},sealApplyInitId:{type:String,default:""},editModleIds:{type:Object,default:()=>({definitionId:"",modelId:"",flowMessageId:""})}},emits:"update:modelValue",setup(e,{emit:a}){const o=e,g=R(),b=l("1"),w=j({loader:()=>N((()=>import("./index-80055260.js")),["assets/index-80055260.js","assets/index-60e1d355.js","assets/main-5d732c2e.js","assets/index-85f82b84.css","assets/home-back-426c97de.js","assets/logo-00c7cf54.js","assets/request-util-ecea08f4.js","assets/index-61c3ae3b.css","assets/ModelApi-c4f72d60.js","assets/index-db21537e.css"])}),T=t({checkedIndex:"1",tabsData:[{index:"1",label:"基础信息",checked:!0},{index:"2",label:"关联表单"},{index:"3",label:"流程设计"},{index:"4",label:"高级设置"}],jyBoxHeader:"",jyBoxCont:"",jyBoxShow:!1}),D=d({get:()=>o.modelValue,set(e){a("update:modelValue",e)}}),S=d({get:()=>o.treeSelectedId,set(e){a("update:treeSelectedId",e)}}),_=()=>{D.value=!1,a("reloadData")},C=l(null),B=l(null),U=l(null),O=l(null),q=l([]),J=l({modelId:"",definitionId:""}),P=l(!0),$=l(!1),H=l({applyTypeId:"",fileTypeScope:[],dataScope:[],flowName:"",readme:"",sealUseTypeId:""}),W=l("");"edit"===o.openType&&(J.value.definitionId=o.editModleIds.definitionId,J.value.modelId=o.editModleIds.modelId,g.setModelId(J.value.modelId,J.value.definitionId),z.flowDetail({flowMessageId:o.editModleIds.flowMessageId}).then((e=>{const a=e.data.organScope?e.data.organScope:[],l=e.data.organUserScope?e.data.organUserScope:[];H.value={applyTypeId:e.data.applyTypeId,fileTypeScope:e.data.fileTypeScope,dataScope:a.concat(l),flowName:e.data.flowName,readme:e.data.readme,sealUseTypeId:e.data.sealUseTypeId},W.value=e.data.formMessageId})));const K=e=>{T.tabsData.forEach((a=>{a.checked=!1,a.index===e.index&&(a.checked=!0,T.checkedIndex=a.index)}))},G=async()=>{q.value=[];const e=await U.value.getBasicsFormValue();if(Array.isArray(e))for(const a in e[0])q.value.push({type:"基础信息",message:e[0][a][0].message});const l=B.value.getAssociationValue();if(Array.isArray(l))for(const a in l[0])q.value.push({type:"关联表单",message:l[0][a][0].message});let t=[];if(C.value){if(t=await C.value.designSave("add"===o.openType?"designModel":"updateModel"),Array.isArray(t))for(const a in t[0])q.value.push({type:"流程设计",message:t[0][a][0].message})}else q.value.push({type:"流程设计",message:"请设计流程"});if(q.value.length>0)return;const s={...e,...l,...t};"add"===o.openType?z.add(s).then((()=>{_(),a("reloadData")})):"edit"===o.openType&&Y.detail({modelId:o.editModleIds.modelId}).then((e=>{z.flowEdit({...s,flowMessageId:o.editModleIds.flowMessageId,modelId:o.editModleIds.modelId,definitionId:e.definitionId}).then((()=>{_(),a("reloadData")}))}))};return s((()=>J.value),(e=>{if(e){if(!e||!e.modelId)return;g.setModelId(e.modelId,e.definitionId)}})),(a,l)=>{const t=n("el-popover"),s=n("el-button"),d=n("JyElMessageBox"),g=L("loading");return i(),p("div",ha,[r(ya,{modelValue:m(D),"onUpdate:modelValue":l[6]||(l[6]=e=>E(D)?D.value=e:null),"custom-content":!0,defaultAttribute:{fullscreen:!0,height:"100%"}},{default:c((()=>[u("div",ga,[u("div",Ia,[u("div",ba,[u("div",wa,[u("i",{class:"iconpark",onClick:_},Ta),u("span",ka,[k(u("span",null,M(a.$t("t-zgj-sync.add")),513),[[x,"add"===o.openType]]),k(u("span",null,M(a.$t("t-editors")),513),[[x,"edit"===o.openType]])])]),u("div",xa,[(i(!0),p(f,null,y(m(T).tabsData,((e,a)=>(i(),p("div",{class:A(["tabs",{"checked-tabs":!!e.checked}]),key:a,onClick:a=>(async e=>{if("3"===e.index){if("edit"===o.openType&&J.value.modelId)return $.value=!0,K(e),P.value?void V.flowDetail({...o.editModleIds,edit:!0}).then((e=>{$.value=!1,P.value=!1,C.value.handleSetData(e.data.data)})):void($.value=!1);q.value=[];const a=await U.value.getBasicsFormValue();if(Array.isArray(a)){for(const e in a[0])q.value.push({type:"基础信息",message:a[0][e][0].message});F.warning("请填写基础信息")}const l=B.value.getAssociationValue();if(Array.isArray(l)){for(const e in l[0])q.value.push({type:"关联表单",message:l[0][e][0].message});F.warning("请选择关联表单")}if(q.value.length>0)return;J.value=await B.value.saveAddModel(U.value.form.flowName).catch((e=>{T.jyBoxHeader="提示？",T.jyBoxCont=e,T.jyBoxShow=!0})),J.value||(T.jyBoxHeader="提示？",T.jyBoxCont="请填写完整信息",T.jyBoxShow=!0)}K(e)})(e)},[u("div",Da,M(e.index),1),u("div",Va,M(e.label),1)],10,Ma)))),128))]),u("div",Sa,[u("div",_a,[r(t,{placement:"bottom",width:400,trigger:"click"},{reference:c((()=>[u("div",Ca,[k(u("span",null,M(q.value.length)+"项不完善 ",513),[[x,0!==q.value.length]])])])),default:c((()=>[u("div",Ba,[Aa,Ua,q.value?(i(),p("div",ja,[(i(!0),p(f,null,y(q.value,((e,a)=>(i(),p("div",{class:"popover-cont-list-li",key:a},[u("div",Na,M(e.type),1),u("div",La,M(e.message),1),Ea])))),128))])):h("",!0)])])),_:1})]),r(s,{class:"process-save-but",type:"primary",onClick:G},{default:c((()=>[I(M(a.$t("t-zgj-Save")),1)])),_:1})])]),u("div",Fa,[k(r(pe,{ref_key:"refBasicsInfo",ref:U,modelValue:m(S),"onUpdate:modelValue":l[0]||(l[0]=e=>E(S)?S.value=e:null),sealId:b.value,"onUpdate:sealId":l[1]||(l[1]=e=>b.value=e),modelLinkId:J.value,"onUpdate:modelLinkId":l[2]||(l[2]=e=>J.value=e),businessList:o.businessList,sealApplyInitId:o.sealApplyInitId,openType:e.openType,editBasicsForm:H.value},null,8,["modelValue","sealId","modelLinkId","businessList","sealApplyInitId","openType","editBasicsForm"]),[[x,"1"==m(T).checkedIndex]]),k(r(Oe,{ref_key:"refAssociationForm",ref:B,modelValue:m(S),"onUpdate:modelValue":l[3]||(l[3]=e=>E(S)?S.value=e:null),sealId:b.value,"onUpdate:sealId":l[4]||(l[4]=e=>b.value=e),modelLinkId:J.value,"onUpdate:modelLinkId":l[5]||(l[5]=e=>J.value=e),businessList:o.businessList,sealApplyInitId:o.sealApplyInitId,openType:e.openType,formMessageId:W.value},null,8,["modelValue","sealId","modelLinkId","businessList","sealApplyInitId","openType","formMessageId"]),[[x,"2"==m(T).checkedIndex]]),J.value.modelId?k((i(),v(m(w),{key:0,ref_key:"refVFlowDesign",ref:C,initObj:J.value,openType:e.openType,style:{height:"calc(100vh - 100px)"}},null,8,["initObj","openType"])),[[x,"3"==m(T).checkedIndex],[g,$.value]]):h("",!0),k(r(ta,{ref_key:"refAdvancedSetup",ref:O},null,512),[[x,"4"==m(T).checkedIndex]])])])])])),_:1},8,["modelValue"]),r(d,{modelValue:m(T).jyBoxShow,"onUpdate:modelValue":l[8]||(l[8]=e=>m(T).jyBoxShow=e),show:m(T).jyBoxShow,defaultAttribute:{},onOnCancel:l[9]||(l[9]=e=>m(T).jyBoxShow=!1)},{header:c((()=>[I(M(m(T).jyBoxHeader),1)])),content:c((()=>[I(M(m(T).jyBoxCont),1)])),footer:c((()=>[r(s,{type:"primary",onClick:l[7]||(l[7]=e=>m(T).jyBoxShow=!1)},{default:c((()=>[Oa])),_:1})])),_:1},8,["modelValue","show"])])}}},[["__scopeId","data-v-385067d7"]]),Ra=[{prop:"flowName",label:"流程名称",fixed:"left",sortable:!0,flex:!0,"min-width":150,show:!0},{prop:"applyTypeName",label:"业务类型",sortable:!0,"min-width":150,show:!0},{prop:"fileTypeName",label:"文件类型",sortable:!0,"min-width":150,show:!0},{prop:"flag",label:"状态",sortable:!0,"min-width":120,show:!0},{prop:"createUserName",label:"创建人",sortable:!0,"min-width":120,show:!0},{prop:"modifyDatetime",label:"更新时间",sortable:!0,"min-width":180,show:!0},{prop:"caozuo",label:"操作",fixed:"right","min-width":280,align:"center",show:!0,rankDisplayData:[{name:"t-zgj-Edit"},{name:"t-zgj-Delete"},{name:"status"},{name:"t-zgj-qyWechat.Copy"}]}],za=[{prop:"flowName",label:"流程名称",sortable:!0,flex:!0,"min-width":150,show:!0},{prop:"applyTypeName",label:"业务类型",sortable:!0,"min-width":150,show:!0},{prop:"flag",label:"状态",sortable:!0,"min-width":120,show:!0},{prop:"createUserName",label:"创建人",sortable:!0,"min-width":120,show:!0},{prop:"modifyDatetime",label:"更新时间",sortable:!0,"min-width":180,show:!0},{prop:"caozuo",label:"操作",fixed:"right","min-width":260,show:!0,align:"center",rankDisplayData:[{name:"t-zgj-Edit"},{name:"t-zgj-Delete"},{name:"status"},{name:"t-zgj-qyWechat.Copy"}]}],Ja={class:"flowManage-index"},Pa={class:"title"},$a={class:"title-more"},Ha={class:"title-more-add"},Ya=(e=>(w("data-v-38977b56"),e=e(),T(),e))((()=>u("div",{class:"title-more-down"},null,-1))),Wa={class:"header-div"},Ka=["src"],Ga={class:"content-div"},Qa=I(" 确认 "),Xa=I("取消"),Za={class:"header-div"},el=["src"],al={class:"content-div"},ll=a({setup(a){const o=l(!1),s=l([]),d=l({modelId:"",definitionId:""}),g=l(!1),b=l(null),w=l(null),T=l({flowMessageId:"",modelId:"",definitionId:""}),k=()=>{g.value=!0,b.value="add"},x=l(null),D=l({}),V=l(""),_=[{id:"keyword",label:"关键词",type:"input",inCommonUse:!0,defaultAttribute:{placeholder:"表单名称/创建人"}},{id:"status",label:"状态",type:"select",optionLabel:"label",optionValue:"value",inCommonUse:!0,defaultAttribute:{placeholder:"请选择"},options:[{value:"1",label:"启用"},{value:"0",label:"停用"}]},{id:"updateTime",label:"更新时间",type:"picker",requestType:"array",startRequest:"updateStartTime",endRequest:"updateEndTime",inCommonUse:!1,defaultAttribute:{type:"daterange","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"YYYY-MM-DD","disabled-date":e=>e.getTime()>Date.now(),"default-value":[new Date((new Date).setMonth((new Date).getMonth()-1)),new Date]},style:{}},{id:"fileTypeId",requestParams:"fileTypeId",label:"文件类型",type:"derivable",inCommonUse:!1,defaultAttribute:{placeholder:"请选择",type:"fileType",multiple:!1,joinStr:","},options:[]},{id:"sealUseTypeId",label:"用印类型",type:"select",optionLabel:"label",optionValue:"value",inCommonUse:!1,defaultAttribute:{placeholder:"请选择"},options:[{value:"1",label:"物理用印"},{value:"2",label:"电子签章"}]},{id:"formMessageId",label:"关联表单",type:"select",optionLabel:"formName",optionValue:"formMessageId",filterable:!0,inCommonUse:!1,defaultAttribute:{placeholder:"请选择"},requestObj:{method:"GET",url:"/form/list",type:"flow"}}],C=[{id:"keyword",label:"关键词",type:"input",inCommonUse:!0,defaultAttribute:{placeholder:"表单名称/创建人"}},{id:"status",label:"状态",type:"select",optionLabel:"label",optionValue:"value",inCommonUse:!0,defaultAttribute:{placeholder:"请选择"},options:[{value:"1",label:"启用"},{value:"0",label:"停用"}]},{id:"updateTime",label:"更新时间",type:"picker",requestType:"array",startRequest:"updateStartTime",endRequest:"updateEndTime",inCommonUse:!1,defaultAttribute:{type:"daterange","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"YYYY-MM-DD","disabled-date":e=>e.getTime()>Date.now(),"default-value":[new Date((new Date).setMonth((new Date).getMonth()-1)),new Date]},style:{}},{id:"formMessageId",label:"关联表单",type:"select",optionLabel:"formName",optionValue:"formMessageId",filterable:!0,inCommonUse:!1,defaultAttribute:{placeholder:"请选择"},requestObj:{method:"GET",url:"/form/list",type:"flow"}}],B=t({flowMessageId:"",columnData:{},batchColumnData:[],MessageBox:{show:!1,header:{data:"",icon:"/src/assets/svg/common/warning.svg"},content:{data:""},type:"删除"},showToastDialog:{show:!1,header:{data:"",icon:"/src/assets/svg/common/warning.svg"},content:{data:""},type:"删除"},componentsSearchForm:{style:{lineStyle:{width:"30%"},labelStyle:{width:"100px"}},data:_,butData:[{id:"more",name:"展开",type:"unfold",defaultAttribute:{type:"primary"},style:{}},{id:"inquire",name:"查询",type:"click",defaultAttribute:{type:"primary"},style:{}},{id:"reset",name:"重置",type:"click",defaultAttribute:{},style:{}}]},componentsTable:{header:Ra,data:[],defaultAttribute:{stripe:!0,"header-cell-style":{background:"var(--jy-color-fill--3)"},"cell-style":({row:e,column:a,rowIndex:l,columnIndex:t})=>{if("flowName"===a.property)return{color:"var(--jy-info-6)",cursor:"pointer"}}}},componentsPagination:{data:{amount:0,index:1,pageNumber:10},defaultAttribute:{layout:"prev, pager, next, jumper",total:0,"page-sizes":[10,100,200,300,400],background:!0}},componentsTree:{data:[],defaultAttribute:{"check-on-click-node":!0,"show-checkbox":!1,"default-expand-all":!0,"expand-on-click-node":!1,"check-strictly":!0,"highlight-current":!0,"node-key":"applyTypeId","current-node-key":"2"},defaultProps:{label:"applyTypeName",children:"children"},value:""},componentsBatch:{selectionData:[],defaultAttribute:{disabled:!0},data:[{name:"批量删除"},{name:"批量启用"},{name:"批量停用"}],butDatas:[{name:"知道了",type:"",clickName:j}]}}),A=(e,a,l,t)=>{"flowName"===a.property&&(o.value=!0,d.value={modelId:e.modelId,definitionId:e.definitionId},s.value=[{value:"detail",params:{flowMessageId:e.flowMessageId}},{value:"record",params:{operationId:e.flowMessageId}},{value:"version",params:{flowMessageId:e.flowMessageId}}])},U=(e,a,l,t)=>{B.columnData=a,B.flowMessageId=a.flowMessageId,B.title=l.name,"t-zgj-qyWechat.Copy"===l.name&&F.warning("功能暂未实现，敬请期待"),"t-zgj-Edit"===l.name&&("1"===a.flag?F.warning("请将流程停用后再进行修改"):(g.value=!0,b.value="edit",T.value.flowMessageId=a.flowMessageId,T.value.definitionId=a.definitionId,T.value.modelId=a.modelId)),"t-zgj-Delete"===l.name&&(B.MessageBox.header.data="提示",B.MessageBox.content.data="确认要删除流程吗？",B.MessageBox.show=!0,B.MessageBox.type="删除"),"status"===l.name&&"1"===a.flag&&(B.MessageBox.header.data="停用",B.MessageBox.content.data="请问确定停用该流程吗？",B.MessageBox.show=!0,B.MessageBox.type="停用"),"status"===l.name&&"0"===a.flag&&(B.MessageBox.header.data="启用",B.MessageBox.content.data="请问确定启用该流程吗？",B.MessageBox.show=!0,B.MessageBox.type="启用")};function j(){B.showToastDialog.show=!1}const N=(e,a)=>{a.then((a=>{200===a.code?F.success(`${e}成功！`):F.success(`${e}失败，请重试`),B.MessageBox.show=!1,R()}))};function L(e,a){B.batchColumnData=[],a.forEach((e=>{B.batchColumnData.push(e.flowName)})),B.showToastDialog.header.data=e.name,B.showToastDialog.content.data=`已选中以下流程，请问确定要${e.name}吗？`,B.showToastDialog.show=!0,B.showToastDialog.type=e.name,B.componentsBatch.butDatas=[{name:"确定",type:"primary",clickName:()=>E(a)},{name:"取消",type:"",clickName:j}]}const E=e=>{const a=e,l=[];switch(B.showToastDialog.type){case"批量删除":B.batchColumnData=[],a.forEach((e=>{"1"===e.flag&&B.batchColumnData.push(e.flowName),l.push(e.flowMessageId)})),B.batchColumnData.length>0?(B.showToastDialog.header.data=B.showToastDialog.type,B.showToastDialog.content.data="请将以下流程停用后再进行删除",B.componentsBatch.butDatas=[{name:"知道了",type:"primary",clickName:j}]):O("批量删除",z.batchDelete({flowMessageIds:l}));break;case"批量停用":a.forEach((e=>{l.push(e.flowMessageId)})),O("批量停用",z.batachEnable({flowMessageIds:l,flag:"0"}));break;case"批量启用":a.forEach((e=>{l.push(e.flowMessageId)})),O("批量启用",z.batachEnable({flowMessageIds:l,flag:"1"}))}},O=(e,a)=>{a.then((a=>{200===a.code?F.success(`${e}成功！`):F.error(`${e}失败，请重试！`),B.showToastDialog.show=!1,R()}))},q=(e,a)=>{1!==a.level&&(D.value.applyTypeId=e.applyTypeId?e.applyTypeId:null,B.componentsTree.value=e.applyTypeId,J(e.applyTypeId))},R=()=>{J(B.componentsTree.value),x.value.reloadData()},J=e=>{e===V.value?(B.componentsSearchForm.data=_,B.componentsTable.header=Ra,x.value.reloadSearchForm(_,{applyTypeId:e}),x.value.setTableHeader(Ra)):(B.componentsSearchForm.data=C,B.componentsTable.header=za,x.value.setTableHeader(za),x.value.reloadSearchForm(C,{applyTypeId:e})),x.value.reloadData()};return S((()=>{W.listApplyTypeTree({}).then((e=>{const a=[];e.data.forEach((e=>{if(e.applyTypePid){"用印申请"===e.applyTypeName&&(V.value=e.applyTypeId);const l=a.findIndex((a=>a.applyTypeId===e.applyTypePid));l>-1&&a[l].children.push(e)}else e.children=[],a.push(e)})),B.componentsTree.data=a,B.componentsTree.value=a[0].children[0].applyTypeId,D.value.applyTypeId=V.value,R()}))})),(a,l)=>{const t=n("el-button"),S=n("JyElMessageBox"),_=n("el-scrollbar");return i(),p("div",Ja,[r(K,{url:"/flow/page",ref_key:"table",ref:x,hasTree:!0,needAutoRequest:!1,componentsSearchForm:m(B).componentsSearchForm,componentsTableHeader:m(B).componentsTable.header,componentsBatch:m(B).componentsBatch,queryParams:D.value,statusColoum:"flag",tableClick:"flowName",openValue:"1",isNo:!1,onCellClick:A,onCustomClick:U,onClickBatchButton:L},{title:c((()=>[u("div",Pa,[u("div",null,M(a.$t("t-zgj-cg-menu-liucheng-guanli")),1),u("div",$a,[u("div",Ha,[r(t,{type:"primary",onClick:k},{default:c((()=>[I(" + "+M(a.$t("t-zgj-sync.add")),1)])),_:1})]),Ya])])])),tree:c((()=>[u("div",null,[m(B).componentsTree.value?(i(),v(m(e),{key:0,ref_key:"tree",ref:w,modelValue:m(B).componentsTree.value,"onUpdate:modelValue":l[0]||(l[0]=e=>m(B).componentsTree.value=e),data:m(B).componentsTree.data,defaultAttribute:m(B).componentsTree.defaultAttribute,defaultProps:m(B).componentsTree.defaultProps,onCurrentChange:q},null,8,["modelValue","data","defaultAttribute","defaultProps"])):h("",!0)])])),_:1},8,["componentsSearchForm","componentsTableHeader","componentsBatch","queryParams"]),r(G,{modelValue:o.value,"onUpdate:modelValue":l[1]||(l[1]=e=>o.value=e),modulesName:"system_flow_management",detailParams:s.value,importParams:d.value},null,8,["modelValue","detailParams","importParams"]),g.value?(i(),v(qa,{key:0,modelValue:g.value,"onUpdate:modelValue":l[2]||(l[2]=e=>g.value=e),openType:b.value,sealApplyInitId:V.value,editModleIds:T.value,treeSelectedId:m(B).componentsTree.value,"onUpdate:treeSelectedId":l[3]||(l[3]=e=>m(B).componentsTree.value=e),businessList:m(B).componentsTree.data,onReloadData:R},null,8,["modelValue","openType","sealApplyInitId","editModleIds","treeSelectedId","businessList"])):h("",!0),r(S,{modelValue:m(B).MessageBox.show,"onUpdate:modelValue":l[6]||(l[6]=e=>m(B).MessageBox.show=e),show:m(B).MessageBox.show,defaultAttribute:{}},{header:c((()=>[u("div",Wa,[u("img",{src:m(B).MessageBox.header.icon,alt:""},null,8,Ka),u("span",null,M(m(B).MessageBox.header.data),1)])])),content:c((()=>[u("div",Ga,M(m(B).MessageBox.content.data),1)])),footer:c((()=>[r(t,{type:"primary",onClick:l[4]||(l[4]=e=>(e=>{if("取消"===e&&(B.MessageBox.show=!1),"删除"===e){if("1"===B.columnData.flag)return B.MessageBox.show=!1,void F.warning("请将流程停用后再进行删除");N(e,z.flowDelete({flowMessageId:B.flowMessageId}))}"停用"===e&&N(e,z.flowEnable({flowMessageId:B.flowMessageId,flag:"0"})),"启用"===e&&N(e,z.flowEnable({flowMessageId:B.flowMessageId,flag:"1"})),"编辑"===e&&(B.MessageBox.show=!0)})(m(B).MessageBox.type))},{default:c((()=>[Qa])),_:1}),r(t,{onClick:l[5]||(l[5]=e=>m(B).MessageBox.show=!1)},{default:c((()=>[Xa])),_:1})])),_:1},8,["modelValue","show"]),r(S,{modelValue:m(B).showToastDialog.show,"onUpdate:modelValue":l[7]||(l[7]=e=>m(B).showToastDialog.show=e),show:m(B).showToastDialog.show,defaultAttribute:{}},{header:c((()=>[u("div",Za,[u("img",{src:m(B).showToastDialog.header.icon,alt:""},null,8,el),u("span",null,M(m(B).showToastDialog.header.data),1)])])),content:c((()=>[u("div",al,M(m(B).showToastDialog.content.data),1),r(_,{class:"scrollbar","max-height":"200px"},{default:c((()=>[(i(!0),p(f,null,y(m(B).batchColumnData,(e=>(i(),p("div",{key:e,class:"scrollbar-demo-item"},M(e),1)))),128))])),_:1})])),footer:c((()=>[(i(!0),p(f,null,y(m(B).componentsBatch.butDatas,(e=>(i(),v(t,{key:e.name,type:e.type,onClick:e.clickName},{default:c((()=>[I(M(e.name),1)])),_:2},1032,["type","onClick"])))),128))])),_:1},8,["modelValue","show"])])}}},[["__scopeId","data-v-38977b56"]]);export{ll as default};
