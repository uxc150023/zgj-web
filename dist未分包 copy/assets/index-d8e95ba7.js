import e from"./index-54331740.js";import{J as a}from"./JyTable-96032540.js";import{a as o}from"./actionOneDialog-7ef0bd64.js";import{a as t}from"./actionMoreDialog-4a1fdaac.js";import{_ as s,v as l,I as n,h as i,k as r,r as d,o as u,c as h,a as m,w as p,m as g,g as c,t as w,u as D,cv as y,y as B,z as T}from"./main-5d732c2e.js";import{a as b}from"./businessRule-e9d2bdc8.js";import{_ as f}from"./index-4f386a23.js";import"./sangedian-b1ee72e5.js";import"./Layout-db7f64fa.js";import"./searchForm-a97b647c.js";import"./ketanchude-65de0c89.js";import"./KDocumentTypeDialog-1f624042.js";import"./pagination-569fa38f.js";import"./batch-e7262433.js";import"./index-b9b96043.js";import"./index-18b4acbd.js";import"./cha-kong-1ced20bc.js";import"./index-01980554.js";import"./yuan-hui-e1a80bc6.js";import"./index-60e1d355.js";import"./home-back-426c97de.js";import"./logo-00c7cf54.js";import"./request-util-ecea08f4.js";const C=[{prop:"ruleBusinessName",label:"业务规则名称","min-width":150,fixed:"left",show:!0},{prop:"ruleBusinessNo",label:"业务规则编码",width:180,align:"center",show:!0},{prop:"fileTypeName",label:"文件类型","min-width":180,show:!0},{prop:"sealUseTypeName",label:"用印类型",align:"center",width:120,show:!0},{prop:"flag",label:"状态",sortable:"custom",align:"center",width:120,show:!0},{prop:"modifyDatetime",label:"更新时间",sortable:"custom",align:"center",width:180,show:!0},{prop:"createUserName",label:"创建人",align:"center","min-width":150,show:!0},{prop:"caozuo",label:"操作",width:280,fixed:"right",align:"center",show:!0,rankDisplayData:[{name:"t-zgj-Edit"},{name:"t-zgj-Delete"},{name:"status"},{name:"t-zgj-qyWechat.Copy"}]}],j=e=>(B("data-v-ec9c8c16"),e=e(),T(),e),x={class:"title"},E=j((()=>g("div",null,"业务规则配置",-1))),v={class:"title-more"},M={class:"title-more-add"},J=c(" 业务规则复制 "),N=j((()=>g("div",{class:"from-label"},"业务规则名称",-1))),z=c(" 提交 "),I=c("取消"),k=s({setup(s){const B=l(!1),T=l([]),j=n(),k=i({componentsSearchForm:{data:[{id:"keyword",label:"关键词",type:"input",inCommonUse:!0,defaultAttribute:{placeholder:"业务规则名称/业务规则编码/创建人"}},{id:"flag",label:"状态",type:"select",inCommonUse:!0,defaultAttribute:{placeholder:"请选择"},options:[{value:"1",label:"启用"},{value:"0",label:"停用"}]},{id:"updateTime",label:"更新时间",type:"picker",inCommonUse:!1,requestType:"array",startRequest:"updateStartTime",endRequest:"updateEndTime",defaultAttribute:{type:"daterange","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"YYYY-MM-DD","disabled-date":e=>e.getTime()>Date.now(),"default-value":[new Date((new Date).setMonth((new Date).getMonth()-1)),new Date]},style:{}},{id:"sealUseTypeId",label:"用印类型",type:"select",inCommonUse:!1,defaultAttribute:{placeholder:"请选择"},options:[{value:"1",label:"物理用印"},{value:"2",label:"电子签章"}]},{id:"fileTypeId",requestParams:"fileTypeId",label:"文件类型",type:"derivable",inCommonUse:!1,defaultAttribute:{placeholder:"请选择",type:"fileType",multiple:!0,joinStr:","},options:[]}],butData:[{id:"more",name:"展开",type:"unfold",defaultAttribute:{type:"primary"},style:{}},{id:"inquire",name:"查询",type:"click",defaultAttribute:{type:"primary"},style:{}},{id:"reset",name:"重置",type:"click",defaultAttribute:{},style:{}}]},componentsTable:{header:C},componentsBatch:{selectionData:[],defaultAttribute:{disabled:!0},data:[{name:"t-zgj-seal.BatchDelete"},{name:"t-zgj-dept.BatchEnable"},{name:"t-zgj-dept.BatchDeactivation"}]},JyElMessageBox:{type:"",id:"",flag:"",show:!1,header:{data:""},content:{data:""}},showToastDialog:{curKey:"",type:"",show:!1,header:{data:""},content:{data:""}},showFormDialog:{show:!1,header:{data:"业务规则复制"},content:{data:""},ruleBusinessName:""},showToastDialogContent:{show:!1,header:"",content:"",selectionTableData:{headers:[{prop:"fileTypeName",label:"文件类型",align:"center"},{prop:"ruleBusinessName",label:"关联业务规则(已启用)",align:"center"}],data:[]}}}),F=l(null),V=l(null),_=()=>{j.push({name:"EditBusinessRule"})};function U(e,a,o,t){"ruleBusinessName"===a.property&&(B.value=!0,T.value=[{value:"detail",params:e.ruleBusinessId},{value:"record",params:{operationId:""}}])}function q(e,a,o,t){"t-zgj-Edit"===o.name&&j.push({name:"EditBusinessRule",query:{ruleBusinessId:a.ruleBusinessId}}),"t-zgj-Delete"===o.name&&(k.JyElMessageBox.type=o.name,k.JyElMessageBox.id=a.ruleBusinessId,k.JyElMessageBox.header.data="提示？",k.JyElMessageBox.content.data="您确定要删除该记录吗？",k.JyElMessageBox.show=!0),"status"===o.name&&(k.JyElMessageBox.type=o.name,k.JyElMessageBox.flag=a.flag,k.JyElMessageBox.id=a.ruleBusinessId,k.JyElMessageBox.header.data="提示？",k.JyElMessageBox.content.data=`您确定要${"1"===a.flag?"停用":"启用"}该记录吗？`,k.JyElMessageBox.show=!0),"t-zgj-qyWechat.Copy"===o.name&&(k.showFormDialog.show=!0,k.showFormDialog.id=a.ruleBusinessId,k.showFormDialog.ruleBusinessName=a.ruleBusinessName+" - 副本")}const A=()=>{V.value.validate((e=>{e&&b.ruleCopy({ruleBusinessId:k.showFormDialog.id,ruleBusinessName:k.showFormDialog.ruleBusinessName}).then((()=>{y("复制成功"),k.showFormDialog.show=!1,F.value.reloadData()}))}))},S=()=>{k.showFormDialog.show=!1},K=()=>{"t-zgj-Delete"===k.JyElMessageBox.type?b.ruleBatchDelete({ruleBusinessIds:[k.JyElMessageBox.id]}).then((()=>{y("删除成功"),F.value.reloadData()}),(e=>{e.data&&(k.showToastDialogContent.show=!0)})).finally((()=>{k.JyElMessageBox.show=!1})):"status"===k.JyElMessageBox.type&&b.ruleDisable({ruleBusinessId:k.JyElMessageBox.id,flag:"1"===k.JyElMessageBox.flag?"0":"1"}).then((()=>{y("1"===k.JyElMessageBox.flag?"停用成功":"启用成功"),F.value.reloadData()}),(e=>{e.data&&(k.showToastDialogContent.show=!0,k.showToastDialogContent.header="1"===k.JyElMessageBox.flag?"停用失败":"启用失败",k.showToastDialogContent.content="当前业务规则中关联的一下文件类型已用于其他已启用的业务规则，请确保一个文件类型仅关联一个已启用的业务规则",k.showToastDialogContent.selectionTableData.data=e.data)})).finally((()=>{k.JyElMessageBox.show=!1}))},R=(e,a)=>{k.componentsBatch.selectionData=a,"t-zgj-seal.BatchDelete"===e.name?(k.showToastDialog.show=!0,k.showToastDialog.type=e.name,k.showToastDialog.curKey="ruleBusinessName",k.showToastDialog.header={data:"批量删除"},k.showToastDialog.content={data:"是否删除以下业务规则？"}):"t-zgj-dept.BatchEnable"===e.name?(k.showToastDialog.show=!0,k.showToastDialog.type=e.name,k.showToastDialog.curKey="ruleBusinessName",k.showToastDialog.header={data:"批量启用"},k.showToastDialog.content={data:"是否启用以下业务规则？"}):"t-zgj-dept.BatchDeactivation"===e.name&&(k.showToastDialog.show=!0,k.showToastDialog.type=e.name,k.showToastDialog.curKey="ruleBusinessName",k.showToastDialog.header={data:"批量停用"},k.showToastDialog.content={data:"是否停用以下业务规则？"})},Y=()=>{"t-zgj-seal.BatchDelete"===k.showToastDialog.type?b.ruleBatchDelete({ruleBusinessIds:k.componentsBatch.selectionData.map((e=>e.ruleBusinessId))}).then((()=>{y("删除成功"),F.value.reloadData()}),(e=>{e.data&&(k.showToastDialogContent.show=!0,k.showToastDialogContent.header="删除失败",k.showToastDialogContent.content=e.msg,k.showToastDialogContent.selectionTableData.data=e.data)})).finally((()=>{k.showToastDialog.show=!1})):"t-zgj-dept.BatchEnable"===k.showToastDialog.type?b.ruleBatchEnable({ruleBusinessIds:k.componentsBatch.selectionData.map((e=>e.ruleBusinessId))}).then((()=>{y("启用成功"),F.value.reloadData()}),(e=>{e.data&&(k.showToastDialogContent.show=!0,k.showToastDialogContent.header="启用失败",k.showToastDialogContent.content=e.msg,k.showToastDialogContent.selectionTableData.data=e.data)})).finally((()=>{k.showToastDialog.show=!1})):"t-zgj-dept.BatchDeactivation"===k.showToastDialog.type&&b.ruleBatchDisable({ruleBusinessIds:k.componentsBatch.selectionData.map((e=>e.ruleBusinessId))}).then((()=>{y("停用成功"),F.value.reloadData()}),(e=>{e.data&&(k.showToastDialogContent.show=!0,k.showToastDialogContent.header="停用失败",k.showToastDialogContent.content=e.msg,k.showToastDialogContent.selectionTableData.data=e.data)})).finally((()=>{k.showToastDialog.show=!1}))};return r((()=>{})),(s,l)=>{const n=d("el-button"),i=d("el-input"),r=d("el-form-item"),y=d("el-form"),b=d("JyElMessageBox"),C=e;return u(),h("div",null,[m(a,{url:"/biz/rule/page",ref_key:"table",ref:F,method:"POST",componentsSearchForm:D(k).componentsSearchForm,componentsTableHeader:D(k).componentsTable.header,componentsBatch:D(k).componentsBatch,tableClick:"ruleBusinessName",statusColoum:"flag",openValue:"1",onCellClick:U,onCustomClick:q,onClickBatchButton:R},{title:p((()=>[g("div",x,[E,g("div",v,[g("div",M,[m(n,{type:"primary",onClick:_},{default:p((()=>[c("+ "+w(s.$t("t-zgj-add")),1)])),_:1})])])])])),_:1},8,["componentsSearchForm","componentsTableHeader","componentsBatch"]),m(f,{modelValue:B.value,"onUpdate:modelValue":l[0]||(l[0]=e=>B.value=e),modulesName:"rule_business_management",detailParams:T.value},null,8,["modelValue","detailParams"]),m(o,{modelValue:D(k).JyElMessageBox.show,"onUpdate:modelValue":[l[1]||(l[1]=e=>D(k).JyElMessageBox.show=e),D(k).JyElMessageBox.show],JyElMessageBox:D(k).JyElMessageBox,onSubmitElMessageBox:K},null,8,["modelValue","JyElMessageBox","onUpdate:modelValue"]),m(D(t),{"onUpdate:modelValue":l[2]||(l[2]=e=>D(k).showToastDialog.show=!1),show:D(k).showToastDialog.show,selectionData:D(k).componentsBatch.selectionData,showToastDialogContent:D(k).showToastDialog,label:"formName",onSureAction:Y,curKey:D(k).showToastDialog.curKey},null,8,["show","selectionData","showToastDialogContent","curKey"]),m(b,{modelValue:D(k).showFormDialog.show,"onUpdate:modelValue":l[4]||(l[4]=e=>D(k).showFormDialog.show=e),show:D(k).showFormDialog.show,defaultAttribute:{}},{header:p((()=>[J])),content:p((()=>[m(y,{ref_key:"formRef",ref:V,"label-position":"left","label-width":"100px",model:D(k).showFormDialog,"hide-required-asterisk":""},{default:p((()=>[m(r,{prop:"ruleBusinessName",rules:[{required:!0,message:"业务规则名称不能为空",trigger:"change"}]},{label:p((()=>[N])),default:p((()=>[m(i,{modelValue:D(k).showFormDialog.ruleBusinessName,"onUpdate:modelValue":l[3]||(l[3]=e=>D(k).showFormDialog.ruleBusinessName=e),placeholder:"请输入",style:{width:"210px"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),footer:p((()=>[m(n,{type:"primary",onClick:A},{default:p((()=>[z])),_:1}),m(n,{onClick:S},{default:p((()=>[I])),_:1})])),_:1},8,["modelValue","show"]),m(C,{show:D(k).showToastDialogContent.show,showToastDialogContent:D(k).showToastDialogContent,"onUpdate:modelValue":l[5]||(l[5]=e=>D(k).showToastDialogContent.show=!1)},null,8,["show","showToastDialogContent"])])}}},[["__scopeId","data-v-ec9c8c16"]]);export{k as default};
