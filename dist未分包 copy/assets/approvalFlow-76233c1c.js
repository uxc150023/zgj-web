import{c as e}from"./JyTabs-6af6e902.js";import{c as a}from"./documentsDetails-5d74be5e.js";import{R as t}from"./RecordSealToReview-dca792f4.js";import{_ as l,v as o,h as s,s as r,i as n,j as d,r as i,o as p,c,a as u,w as m,V as f,P as b,Q as v,p as g,u as h,m as y,f as I,q as k,l as w,F as _,e as S,g as T,t as A,b3 as x,b4 as D,Y as j,M as C,y as V,z as B,aW as M,b1 as L,k as N}from"./main-5d732c2e.js";import F from"./index-bf861a3a.js";import{_ as O}from"./ketanchude-65de0c89.js";import{b as z,l as R,_ as U,a as J}from"./index-60e1d355.js";import{M as W}from"./ModelApi-c4f72d60.js";import{R as P}from"./request-util-ecea08f4.js";import{A as q}from"./ApproverApi-307336dc.js";import{J as E}from"./JyTable-96032540.js";/* empty css                                                               */import"./cha-kong-1ced20bc.js";import"./table-12670e99.js";import"./sangedian-b1ee72e5.js";/* empty css                                                                         */import"./portion-92af8719.js";/* empty css                                                                */import"./yuan-hui-e1a80bc6.js";import"./index-b9b96043.js";import"./home-back-426c97de.js";import"./logo-00c7cf54.js";import"./Layout-db7f64fa.js";import"./searchForm-a97b647c.js";import"./KDocumentTypeDialog-1f624042.js";import"./pagination-569fa38f.js";import"./batch-e7262433.js";class ${static findPage(e){return P.getAndLoadData("/ruTask/page",e)}static findList(e){return P.getAndLoadData("/ruTask/list",e)}static add(e){return P.post("/ruTask/add",e)}static edit(e){return P.post("/ruTask/edit",e)}static delete(e){return P.post("/ruTask/delete",e)}static detail(e){return P.getAndLoadData("/ruTask/detail",e)}static preList(e){return P.getAndLoadData("/ruTask/pre",e)}}class K{static detailByTaskId(e){return P.getAndLoadData("/nodeAttr/detailByTaskId",e)}}const G=e=>(V("data-v-4f77a3f6"),e=e(),B(),e),Q={class:"top-container"},H={key:0,class:"top-container"},Y={class:"approval-footer"},X=T("同意"),Z=T("不同意"),ee=T("转交"),ae={class:"contentBoxes"},te={class:"ap-box-contBox"},le=[G((()=>y("img",{class:"ap-box-contBox-icon-img",src:O,alt:""},null,-1)))],oe={class:"select-box-contBox"},se={key:0,class:"contentBoxes"},re={class:"ap-box-contBox"},ne=[G((()=>y("img",{class:"ap-box-contBox-icon-img",src:O,alt:""},null,-1)))],de={class:"footer-btns"},ie=l({props:{show:{type:Boolean,default:!1},title:{type:String,default:""},params:{type:Object,default:()=>({})}},emits:["update:show","on-confirm","on-cancel"],setup(e,{emit:a}){const t=e,{toUgroup:l}=z(),{backApprovalTypeDatas:V}=R(),B=o(!1),L=o("first"),N=o([{name:"用印详情",value:"first"},{name:"审批流程",value:"second"},{name:"操作记录",value:"third"}]),O=o(null),J=o(!1);o(0);const P=o(null),E=o(null),G=o([]),ie=o([]),pe=o({height:"calc(100% - 270px)",overflow:"hidden"}),ce=o(""),ue=s({searchSelected:[],carbonSelected:[],approverSelected:[],nextApproverSelected:[],form:{remark:"同意",carbon:!1,suggest:"1",nextApprover:"",nextApproverIds:[],addSignMode:[2,3].includes(t.params.approvalMode)?3:4===t.params.approvalMode?4:3,destTaskId:"",backType:"",adminId:"",approver:""},rules:{suggest:[{required:!0,message:"请选择审批选项",trigger:"blur"}],nextApprover:[{required:!0,message:"请选择下一步审批人"}]}}),me=e=>{a("on-cancel",!1)},fe=r({get:()=>t.show,set(e){a("update:show",e)}}),be=()=>{E.value.disableWidgets(t.params.disableWidgets),E.value.hideWidgets(t.params.hideWidgets),E.value.setFormData(t.params.formData)},ve=()=>{O.value.validate((e=>{if(e){J.value=!0;const e=M;let a={},l={};const s=t.params.formData,r=o(null);E.value.getFormData().then((async o=>{r.value=o;for(const t in r.value){e.indexOf(t)>-1?a={...a,[t]:o[t]?o[t]:s[t]}:l={...l,[t]:s[t]}}const n=await D.formQuery({formMessageId:s.formMessageId}),d=await D.queryIdByGunsId({gunsSysId:t.params.instanceId});await D.editForm({formMessageId:s.formMessageId,formVersionId:s.formVersionId,flowVersionId:s.flowVersionId,flowMessageId:s.flowMessageId,applyTypeId:n.data.applyTypeId,sealUseTypeId:n.data.sealUseTypeId,gunsSysId:t.params.instanceId,sealUseApplyId:d.data,customApplyField:"{}"===JSON.stringify(l)?null:l,...a}),"1"===ue.form.suggest?he({...a,formMessageId:s.formMessageId,formVersionId:s.formVersionId,flowVersionId:s.flowVersionId,flowMessageId:s.flowMessageId}):"2"===ue.form.suggest?ge():"3"===ue.form.suggest?Ie():"4"===ue.form.suggest?ye():"5"===ue.form.suggest?ke():ue.form.suggest}))}}))},ge=e=>{const l={instanceId:t.params.instanceId,modelId:t.params.modelId,formData:t.params.formData,definitionId:t.params.definitionId,remark:ue.form.remark,suggest:2};q.reject(l).then((e=>{"00000"===e.code&&(j.success("提交成功"),a("on-confirm")),J.value=!1})).catch((()=>{J.value=!1}))},he=e=>{const l={instanceId:t.params.instanceId,modelId:t.params.modelId,formData:e,definitionId:t.params.definitionId,remark:ue.form.remark,suggest:1};q.agree(l).then((e=>{"00000"===e.code&&(j.success("提交成功！"),a("on-confirm",e)),J.value=!1})).catch((()=>{J.value=!1}))},ye=()=>{const e=[];ue.approverSelected.forEach((a=>{e.push(a.value)}));const l={taskId:t.params.taskId,assigneeList:e,addSignMode:ue.form.addSignMode,whisper:ue.form.remark};q.addSign(l).then((e=>{"00000"===e.code&&(j.success("加签成功！"),a("on-confirm",e)),J.value=!1})).catch((()=>{J.value=!1}))},Ie=()=>{const e=[];ue.approverSelected.forEach((a=>{e.push(a.value)}));const l={taskId:t.params.taskId,assigneeList:e,whisper:ue.form.remark};q.turn(l).then((e=>{"00000"===e.code&&(j.success("转交成功！"),a("on-confirm",e)),J.value=!1})).catch((()=>{J.value=!1}))},ke=async()=>{try{const e={instanceId:t.params.instanceId,modelId:t.params.modelId,definitionId:t.params.definitionId,taskId:t.params.taskId,suggest:1,remark:ue.form.remark};q.consultSubmit(e).then((e=>{J.value=!1,Se()})).catch((()=>{J.value=!1}))}catch(e){J.value=!1}},we=async()=>{try{const e={taskId:t.params.taskId,instanceId:t.params.instanceId},a=await K.detailByTaskId(e),o=a.allowBackType,s=a.backApprovalType;if(s){const e=l(s);V.forEach((a=>{e.includes(a.value)&&G.value.push(a)}))}if(2===o){const a=await $.preList(e);a&&a.length>0&&(ie.value=[],a.forEach((e=>{ie.value.push({label:e.approverWrapper,value:e.taskId,popovers:[{title:e.nodeName,content:`任务类型:${e.taskTypeWrapper}`},{content:`接收时间:${e.createTime}`},{content:`审批时间:${e.updateTime}`}]})})))}}finally{}},_e=e=>{ce.value=e,"carbon"===e?ue.searchSelected=ue.carbonSelected.map((e=>({id:e.value,name:e.label,type:"user"}))):"approver"===e?ue.searchSelected=ue.approverSelected.map((e=>({id:e.value,name:e.label,type:"user"}))):"nextApprover"===e&&(ue.searchSelected=ue.nextApproverSelected.map((e=>({id:e.value,name:e.label,type:"user"})))),B.value=!0},Se=e=>{a("on-cancel",e),fe.value=!1},Te=e=>{"1"===e?(ue.form.remark="同意",ue.rules={suggest:[{required:!0,message:"请选择审批选项",trigger:"change"}],nextApprover:[{required:!0,message:"请选择下一步审批人"}]}):"2"===e?(ue.form.remark="不同意",ue.rules={suggest:[{required:!0,message:"请选择审批选项",trigger:"change"}]}):ue.form.remark="请审批","3"!==e&&"4"!==e&&"5"!==e||(ue.rules={suggest:[{required:!0,message:"请选择审批选项",trigger:"change"}],approver:[{required:!0,message:"请选择审批人",trigger:"change"}]}),"6"===e&&we()},Ae=e=>{if("approver"===ce.value)ue.approverSelected=e.map((e=>({label:e.name,value:e.id}))),ue.form.approver=e;else if("carbon"===ce.value)ue.carbonSelected=e.map((e=>({label:e.name,value:e.id})));else if("nextApprover"===ce.value){ue.nextApproverSelected=e.map((e=>({label:e.name,value:e.id})));const a=[];e.forEach((e=>{a.push(e.name),ue.form.nextApproverIds.push(e.id)})),ue.form.nextApprover=a.join(",")}},xe=e=>{ue.searchSelected=De(ue.searchSelected,e)},De=(e,a)=>Array.isArray(e)&&0!==e.length?e.filter((e=>e.id!==a)):e,je=o(null);return n((()=>t.show),(()=>{t.show&&(W.predictionDesign({formData:t.params.formData,instanceId:t.params.instanceId,definitionId:t.params.definitionId}).then((e=>{je.value=e.data})),(async()=>{await $.findList({instanceId:t.params.instanceId})})())})),d((()=>{})),(e,a)=>{const l=F,o=i("el-scrollbar"),s=i("el-radio"),r=i("el-radio-group"),n=i("el-form-item"),d=i("el-option"),D=i("el-select"),j=i("el-checkbox"),V=i("el-input"),M=i("el-form"),z=i("el-button"),R=C;return p(),c(_,null,[u(R,{"onUpdate:show":a[12]||(a[12]=e=>fe.value=e),show:h(fe),"destroy-on-close":"",title:e.$t(t.title),oneBtn:!1,confirmText:e.$t("t-zgj-operation.submit"),concelText:e.$t("t-zgj-operation.cancel"),height:650,width:930,footer:!1,onClose:me,noScroll:!1},{noScroll:m((()=>[u(f,{label:N.value,active:L.value,"onUpdate:active":a[0]||(a[0]=e=>L.value=e),border:!1},null,8,["label","active"]),b(u(o,{class:g(["el-scrollbar-nomal",{"el-scrollbar-add":"3"===h(ue).form.suggest||"4"===h(ue).form.suggest||"5"===h(ue).form.suggest}]),always:""},{default:m((()=>[u(l,{mode:"render",formJson:t.params.formJson,formData:t.params.formData,ref_key:"formInformation",ref:E,onOnLoaded:be},null,8,["formJson","formData"])])),_:1},8,["class"]),[[v,"first"===L.value]]),b(y("div",Q,[je.value?(p(),I(U,k({key:0,ref_key:"flowDesign",ref:P},{readable:!0,mapable:!1,scroll:!0,top:"20"},{node:je.value,wrapStyle:pe.value}),null,16,["node","wrapStyle"])):w("",!0)],512),[[v,"second"===L.value]]),"third"===L.value?(p(),c("div",H)):w("",!0),y("div",Y,[u(M,{model:h(ue).form,rules:h(ue).rules,ref_key:"vFormRef",ref:O,"label-width":"110px"},{default:m((()=>[u(n,{label:"审批选项",prop:"suggest"},{default:m((()=>[u(r,{onChange:Te,modelValue:h(ue).form.suggest,"onUpdate:modelValue":a[1]||(a[1]=e=>h(ue).form.suggest=e)},{default:m((()=>[u(s,{label:"1"},{default:m((()=>[X])),_:1}),u(s,{label:"2"},{default:m((()=>[Z])),_:1}),u(s,{label:"3"},{default:m((()=>[ee])),_:1}),(p(!0),c(_,null,S(t.params.buttons.filter((e=>["agree","reject"].includes(e.buttonCode))),(e=>(p(),I(s,{label:e.buttonCode,key:e.buttonCode},{default:m((()=>[T(A(e.buttonName),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),"5"===h(ue).form.suggest||"4"===h(ue).form.suggest||"3"===h(ue).form.suggest?(p(),I(n,{key:0,label:"审批人",prop:"approver"},{default:m((()=>[y("div",ae,[y("div",te,[u(D,{modelValue:h(ue).approverSelected,"onUpdate:modelValue":a[2]||(a[2]=e=>h(ue).approverSelected=e),multiple:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":6,placeholder:"+请选择审批人",style:{width:"100%"},"popper-class":"hidePoper",class:g({hasContent:h(ue).approverSelected.length}),onClick:a[3]||(a[3]=e=>_e("approver"))},{default:m((()=>[(p(!0),c(_,null,S(h(ue).approverSelected,(e=>(p(),I(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","class"]),y("div",{class:"ap-box-contBox-icon",onClick:a[4]||(a[4]=e=>_e("approver"))},le)])])])),_:1})):w("",!0),ie.value.length>0?(p(),I(n,{key:1,label:"被退回人",name:"destTaskId",rules:[{required:!0,message:"请选择人员!"}]},{default:m((()=>[u(r,{value:h(ue).form.destTaskId,"onUpdate:value":a[5]||(a[5]=e=>h(ue).form.destTaskId=e),class:"w-fill",size:e.size},{default:m((()=>[(p(!0),c(_,null,S(ie.value,((e,a)=>(p(),I(s,{key:a,value:e.value},{default:m((()=>[y("span",null,A(e.label),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value","size"])])),_:1})):w("",!0),"6"===h(ue).form.suggest?(p(),I(n,{key:2,label:"退回后发起审批",prop:"approver"},{default:m((()=>[u(D,{style:{width:"264px"},modelValue:e.sate.form.adminId,"onUpdate:modelValue":a[6]||(a[6]=a=>e.sate.form.adminId=a),filterable:"",onChange:e.changeAdmin},{default:m((()=>[(p(!0),c(_,null,S(G.value,((a,t)=>(p(),I(d,{key:t,label:a[e.labelName],value:a[e.valueName]},{default:m((()=>[T(A(a[e.labelName]),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})):w("",!0),u(n,{label:"添加抄送",prop:"carbon"},{default:m((()=>[y("div",oe,[u(j,{modelValue:h(ue).form.carbon,"onUpdate:modelValue":a[7]||(a[7]=e=>h(ue).form.carbon=e),style:{"margin-right":"12px"},size:"mini"},null,8,["modelValue"]),h(ue).form.carbon?(p(),c("div",se,[y("div",re,[u(D,{modelValue:h(ue).carbonSelected,"onUpdate:modelValue":a[8]||(a[8]=e=>h(ue).carbonSelected=e),multiple:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":6,placeholder:"+请选择抄送人",style:{width:"100%"},"popper-class":"hidePoper",class:g({hasContent:h(ue).carbonSelected.length}),onClick:a[9]||(a[9]=e=>_e("carbon")),onRemoveTag:xe},{default:m((()=>[(p(!0),c(_,null,S(h(ue).carbonSelected,(e=>(p(),I(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","class"]),y("div",{class:"ap-box-contBox-icon",onClick:a[10]||(a[10]=e=>_e("carbon"))},ne)])])):w("",!0)])])),_:1}),u(n,{label:"审批意见",prop:"remark"},{default:m((()=>[u(V,{modelValue:h(ue).form.remark,"onUpdate:modelValue":a[11]||(a[11]=e=>h(ue).form.remark=e),maxlength:"100","show-word-limit":"",type:"textarea",placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"]),y("div",de,[u(z,{type:"primary",loading:J.value,onClick:ve},{default:m((()=>[T(A(e.$t("t-zgj-operation.submit")),1)])),_:1},8,["loading"]),u(z,{onClick:Se},{default:m((()=>[T(A(e.$t("t-zgj-operation.cancel")),1)])),_:1})])])])),_:1},8,["show","title","confirmText","concelText"]),B.value?(p(),I(h(x),{key:0,show:B.value,"onUpdate:show":a[13]||(a[13]=e=>B.value=e),tabsShow:["user"],"onUpdate:searchSelected":Ae,searchSelected:h(ue).searchSelected},null,8,["show","searchSelected"])):w("",!0)],64)}}},[["__scopeId","data-v-4f77a3f6"]]),pe=[{prop:"instanceTitle",label:"流程名称",sortable:!0,"min-width":190},{prop:"subTypeName",label:"流程类型",sortable:!0,"min-width":150},{prop:"applicantWrapper",label:"申请人",sortable:!0,"min-width":150},{prop:"orgName",label:"申请部门",sortable:!0,"min-width":150},{prop:"createTime",label:"申请时间",sortable:!0,"min-width":180},{prop:"caozuo",label:"操作",fixed:"right","min-width":80,rankDisplayData:[{name:"t-zgj-Approval",label:"审批"}]}],ce=[{prop:"instanceTitle",label:"流程名称",sortable:!0,"min-width":190},{prop:"subTypeName",label:"流程类型",sortable:!0,"min-width":150},{prop:"applicantWrapper",label:"申请人",sortable:!0,"min-width":150},{prop:"orgName",label:"申请部门",sortable:!0,"min-width":150},{prop:"createTime",label:"申请时间",sortable:!0,"min-width":180},{prop:"updateTime",label:"审批时间",sortable:!0,"min-width":180},{prop:"taskStatusWrapper",label:"审批状态",sortable:!0,"min-width":150},{prop:"caozuo",label:"操作",fixed:"right","min-width":80,rankDisplayData:[{name:"t-zgj-F_WORKFLOW_RE_APPROVAL",label:"重批"}]}];class ue{static findPage(e){return P.getAndLoadData("/nodeButton/page",e)}static findList(e){return P.getAndLoadData("/nodeButton/list",e)}static add(e){return P.post("/nodeButton/add",e)}static edit(e){return P.post("/nodeButton/edit",e)}static delete(e){return P.post("/nodeButton/delete",e)}static detail(e){return P.getAndLoadData("/nodeButton/detail",e)}}class me{static findPage(e){return P.getAndLoadData("/ruInstance/page",e)}static add(e){return P.post("/ruInstance/add",e)}static edit(e){return P.post("/ruInstance/edit",e)}static delete(e){return P.post("/ruInstance/delete",e)}static detail(e){return P.getAndLoadData("/ruInstance/detail",e)}}const fe={class:"approvalFlow-approvalFlow"},be={class:"title"},ve={class:"title-more"},ge={class:"title-more-add"},he={class:"ap-box"},ye=l({setup(l){const r=L(),n=o({show:!1,title:"t-zgj-Approval",formJson:t}),d=o(null),f=o(""),b=s({searchSelected:[],approvalModes:{1:"审批中",2:"会签中",3:"会签中",4:"或签中"},params:{formJson:null,formData:{},taskId:"",instanceId:"",approvalMode:"",modelName:"",modelId:"",nodeId:"",definitionId:"",buttons:[],detailData:[],basicInformation:{title:"基本信息",show:!0,data:[{label:"单据名称",value:"上海建筑材料清单合同明细"},{label:"文件类型：",value:"1份"},{label:"金额：",value:"110,88,00"},{label:"申请事由：",value:"20次"},{label:"印章名称：",value:"销售合同"},{label:"常规盖章：",value:"20次"},{label:"盖章码：",value:"554778"},{label:"申请人员：",value:"20次"},{label:"申请时间：",value:"2022-11-12 19:00:12"},{label:"所属部门：",value:"20次"}],labelStyle:{width:"8rem"}}},componentsTabs:{data:[{label:"待审批",name:"todo"},{label:"已审批",name:"done"}],activeName:"todo"},componentsDocumentsDetails:{show:!1,visible:[{label:"用印详情",name:"approval-process"},{label:"保管记录",name:"Record-of-custody"},{label:"操作记录",name:"operating-record"}]},componentsSearchForm:{style:{lineStyle:{width:"calc(100% / 3)"},labelStyle:{width:"100px"}},data:[],butData:[{id:"more",name:"展开",type:"unfold",defaultAttribute:{type:"primary"},style:{}},{id:"inquire",name:"t-zgj-query",label:"查询",type:"click",defaultAttribute:{type:"primary"},style:{}},{id:"reset",name:"t-zgj-reset",label:"重置",type:"click",defaultAttribute:{},style:{}}]},componentsTable:{header:pe,data:[],defaultAttribute:{stripe:!0,"header-cell-style":{background:"var(--jy-color-fill--3)"},"cell-style":({row:e,column:a,rowIndex:t,columnIndex:l})=>{if("instanceTitle"===a.property)return{color:"var(--jy-info-6)",cursor:"pointer"}}},loading:!1},componentsPagination:{data:{amount:0,index:1,pageNumber:10},defaultAttribute:{layout:"prev, pager, next, jumper",total:0,"page-sizes":[10,50,400],background:!0}},componentsBreadcrumb:{data:[{name:"ceshi"},{name:"ceshi"}],defaultAttribute:{separator:"/"}},componentsBatch:{selectionData:[],defaultAttribute:{disabled:!0},data:[]}}),v=o(null),g=e=>{n.value.show=!1},I=e=>{n.value.show=!1,v.value.reloadData()},k=[{id:"keyword",label:"关键词",type:"input",inCommonUse:!0,defaultAttribute:{placeholder:"单据名称"}},{id:"picker",label:"申请时间",type:"picker",pickerType:"date",inCommonUse:!0,defaultAttribute:{type:"daterange","start-placeholder":"开始时间","end-placeholder":"结束时间"},style:{}},{id:"applyOrganId",label:"申请部门",type:"derivable",defaultAttribute:{placeholder:"+选择部门"}},{id:"applyTypeId",label:"流程类型",type:"select",options:[{label:"用印申请",value:"1"},{label:"刻章申请",value:"2"},{label:"销毁申请",value:"3"},{label:"停用申请",value:"4"},{label:"变更申请",value:"5"},{label:"启用申请",value:"6"}],defaultAttribute:{multiple:!1}},{id:"relatedCompanyId",label:"往来单位",type:"dialog",defaultAttribute:{type:"JyRelatedCompany",placeholder:"+往来单位"},options:[],values:[]},{id:"sealIds",label:"印章名称",type:"dialog",defaultAttribute:{type:"JySelectSeal",multiple:!1,placeholder:"+选择印章"},options:[],values:[]}],w=[{id:"keyword",label:"关键词",type:"input",inCommonUse:!0,defaultAttribute:{placeholder:"单据名称"}},{id:"picker",label:"申请时间",type:"picker",pickerType:"date",inCommonUse:!0,defaultAttribute:{type:"daterange","start-placeholder":"开始时间","end-placeholder":"结束时间"},style:{}},{id:"approvalStatus",label:"审批状态",type:"select",options:[{label:"未审批",value:"1"},{label:"已审批",value:"2"}],defaultAttribute:{multiple:!1}},{id:"applyOrganId",label:"申请部门",type:"derivable",defaultAttribute:{type:"organ",placeholder:"+选择部门"},options:[],values:[]},{id:"applyTypeId",label:"流程类型",type:"select",options:[{label:"用印申请",value:"1"},{label:"刻章申请",value:"2"},{label:"销毁申请",value:"3"},{label:"停用申请",value:"4"},{label:"变更申请",value:"5"},{label:"启用申请",value:"6"}],defaultAttribute:{multiple:!1}},{id:"relatedCompanyId",label:"往来单位",type:"dialog",defaultAttribute:{type:"JyRelatedCompany",placeholder:"+往来单位"},options:[],values:[]},{id:"sealIds",label:"印章名称",type:"dialog",defaultAttribute:{type:"JySelectSeal",multiple:!1,placeholder:"+选择印章"},options:[],values:[]}];function _(e){b.componentsTabs.activeName=e,"todo"===e?(b.componentsTable.header=pe,b.componentsTable.data=[]):"done"===e&&(b.componentsTable.header=ce,b.componentsTable.data=[]),"todo"===e?b.componentsSearchForm.data=k:"done"===e&&(b.componentsSearchForm.data=w),v.value.reloadData()}function S(){b.componentsDocumentsDetails.show=!1}function x(e,a,t,l){n.value.title=t.name,"t-zgj-Approval"===t.name&&(b.params.instanceId=a.instanceId,b.params.taskId=a.taskId,b.params.approvalMode=a.approvalMode,b.params.instanceStatus=a.instanceStatus,b.params.approvalMode=a.approvalMode,D(a,"t-zgj-Approval")),"t-zgj-F_WORKFLOW_RE_APPROVAL"===t.name&&(b.params.instanceId=a.instanceId,b.params.taskId=a.taskId,b.params.approvalMode=a.approvalMode,b.params.instanceStatus=a.instanceStatus,b.params.approvalMode=a.approvalMode,D(a,"t-zgj-F_WORKFLOW_RE_APPROVAL"))}b.componentsSearchForm.data=k;const D=(e,a)=>{const t={instanceId:e.instanceId};me.detail(t).then((t=>{b.params.formData=JSON.parse(t.formJson),b.params.modelName=t.modelName,b.params.modelId=t.modelId,b.params.nodeId=t.nodeId,b.params.definitionId=t.definitionId,f.value=b.params.formData.formVersionId,1===b.params.instanceStatus&&C(),j(e,a),V(t.privileges)})).catch((()=>{}))},j=(e,a)=>{const t={modelId:e.modelId,definitionId:e.definitionId};J.queryByGunsId(t).then((e=>{b.params.formJson=JSON.parse(e.data),n.value.show=!0,n.value.title=a}))},C=async()=>{const e={modelId:b.params.modelId,definitionId:b.params.definitionId,nodeId:b.params.nodeId},a=await ue.findList(e);a&&(b.params.buttons=a.filter((e=>e.checked)))},V=e=>{const a=[];e.forEach((e=>{e.readable&&a.push(e.fieldKey)}));const t=[];e.forEach((e=>{e.displayable&&t.push(e.fieldKey)})),b.params.disableWidgets=a,b.params.hideWidgets=t},B=(e,a,t,l)=>{"instanceTitle"===a.property&&(b.componentsDocumentsDetails.show=!0)};return N((()=>{r.getMoneyType()})),(t,l)=>{const o=i("el-button");return p(),c("div",fe,[u(E,{url:`/queryTask/${h(b).componentsTabs.activeName}`,ref_key:"table",ref:v,hasTabs:"",componentsSearchForm:h(b).componentsSearchForm,componentsTableHeader:h(b).componentsTable.header,componentsBatch:h(b).componentsBatch,tableClick:"instanceTitle",onCellClick:B,onCustomClick:x,handleApprovalStatus:!0},{title:m((()=>[y("div",be,[y("div",null,A(t.$t("t-zgj-workflow.ApprovalProcess")),1),y("div",ve,[y("div",ge,[u(o,{type:"primary"},{default:m((()=>[T(A(t.$t("t-zgj-F_SEAL_INFO_EXPORT_STANDING_BOOK")),1)])),_:1})])])])])),tabs:m((()=>[y("div",null,[u(e,{activeName:h(b).componentsTabs.activeName,data:h(b).componentsTabs.data,onTabChange:_},null,8,["activeName","data"])])])),_:1},8,["url","componentsSearchForm","componentsTableHeader","componentsBatch"]),y("div",he,[u(a,{show:h(b).componentsDocumentsDetails.show,visible:h(b).componentsDocumentsDetails.visible,onClickClose:S},null,8,["show","visible"])]),u(ie,{ref_key:"drawer",ref:d,show:n.value.show,"onUpdate:show":l[0]||(l[0]=e=>t.show=e),params:h(b).params,title:n.value.title,onOnCancel:g,onOnConfirm:I},null,8,["show","params","title"])])}}},[["__scopeId","data-v-8d5de101"]]);export{ye as default};
