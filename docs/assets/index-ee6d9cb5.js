import{_ as e}from"./gengduo-caozuo-730fe1cb.js";import{J as a}from"./JyTable-8de6d2e9.js";import{B as t,g as o,P as l,n}from"./chunk-vform-ec6574e8.js";import{_ as d}from"./ketanchude-a94e84bc.js";import{a as r,at as m,b as s,e as p,aQ as c,W as i,X as u,ap as h,ai as y,u as g,Y as f,ah as C,am as b,a3 as w,a9 as j,ao as v,an as x,ba as A,bb as D}from"./chunk-ant-design-vue-a1de3c57.js";import{_ as F}from"./index-6bc53c26.js";import{E as I}from"./chunk-element-plus-636450f3.js";import"./sangedian-6ea00dcf.js";import"./Layout-58d8fae6.js";import"./searchForm-bc074dfc.js";import"./KDocumentTypeDialog-21febff4.js";import"./pagination-35741a8b.js";import"./batch-21ddcba8.js";import"./index-bd96bee1.js";import"./index-e7b1e71f.js";import"./cha-kong-c10eac4e.js";import"./index-a02cc9a9.js";import"./yuan-hui-31c99901.js";import"./index-09e205e2.js";import"./home-back-d5b479fa.js";import"./logo-ad08cc7e.js";import"./request-util-82325ac7.js";const N={getRelatedCompanyList:e=>t({method:"GET",url:"/tenant/relatedCompany/list",params:e}),addRelatedCompany:e=>t({method:"POST",url:"/tenant/relatedCompany/add",data:e}),updateRelatedCompany:e=>t({method:"POST",url:"/tenant/relatedCompany/update",data:e}),deleteRelatedCompany:e=>t({method:"POST",url:"/tenant/relatedCompany/delete",data:e}),batchImportRelatedCompany:e=>t({method:"GET",url:"/tenant/relatedCompany/batchImport",params:e}),detailRelatedCompany:e=>t({method:"GET",url:`/tenant/relatedCompany/detail/${e}`}),detailGetRelatedCompanyNo:e=>t({method:"GET",url:"/tenant/relatedCompany/getRelatedCompanyNo"})},B={class:"select-box-contBox"},V={class:"ap-box-contBox-icon"},E=o({props:{showAdd:{type:Boolean,default:!1},title:{type:String,default:"t-zgj-add"},column:{type:Object,default:()=>({})}},emits:["update:showAdd","on-confirm","on-cancel"],setup(e,{emit:a}){const t=e,o=r(null),j=r(!1),v=m({searchSelected:[],componentsAddForm:{formData:{relatedCompanyName:"",organId:"",organName:"",contactName:"",contactInformation:"",relatedCompanyId:"",readme:""},formRules:{relatedCompanyName:[{required:!0,message:"请输入企业名称",trigger:"change"}],organId:[{required:!0,message:"请选择所属部门",trigger:"change"}],contactName:[{required:!0,message:"请输入联系人",trigger:"change"}],contactInformation:[{required:!0,message:"请输入正确的手机号",pattern:/^1(3[0-9]|4[01456879]|5[0-35-9]|6[2567]|7[0-8]|8[0-9]|9[0-35-9])\d{8}$/,trigger:"change"}]}}});s((()=>t.column),(e=>{if(e)if("t-zgj-Edit"===t.title){v.searchSelected=[{id:e.organId,idFullPathSet:[e.organId],name:e.organName,type:"organ"}];for(const a in e)v.componentsAddForm.formData[a]=e[a]}else{if(o.value){o.value.resetFields(),v.searchSelected=[];for(const e in v.componentsAddForm.formData)v.componentsAddForm.formData[e]=""}x()}}));const x=()=>{N.detailGetRelatedCompanyNo().then((e=>{200===e.code&&(v.componentsAddForm.formData.relatedCompanyNo=e.data)}))},A=p({get:()=>t.showAdd,set(e){a("update:showAdd",e)}}),D=()=>{a("on-cancel",!1)},F=()=>{o.value.validate((e=>{e&&(v.componentsAddForm.formData.relatedCompanyId&&"t-zgj-Edit"===t.title?N.updateRelatedCompany(v.componentsAddForm.formData).then((e=>{a("on-confirm",e,"修改")})):N.addRelatedCompany(v.componentsAddForm.formData).then((e=>{a("on-confirm",e,"新增")})))}))},I=e=>{j.value=!0},E=e=>{e&&e.length>0&&(v.searchSelected=e,v.componentsAddForm.formData.organName=e[0].name,v.componentsAddForm.formData.organId=e[0].id),j.value=!1};return(e,a)=>{const r=c("el-input"),m=c("el-form-item"),s=c("el-form"),p=n;return i(),u(w,null,[h(p,{"onUpdate:show":a[10]||(a[10]=e=>A.value=e),show:g(A),title:e.$t(t.title),centerBtn:!0,confirmText:e.$t("t-zgj-operation.submit"),concelText:e.$t("t-zgj-operation.cancel"),width:900,height:420,onClose:D,onConfirm:F},{default:y((()=>[h(s,{model:g(v).componentsAddForm.formData,rules:g(v).componentsAddForm.formRules,ref_key:"formRef",ref:o,"label-width":"100px"},{default:y((()=>[h(m,{label:"企业编码",prop:"relatedCompanyNo"},{default:y((()=>[h(r,{type:"hidden",modelValue:g(v).componentsAddForm.formData.relatedCompanyId,"onUpdate:modelValue":a[0]||(a[0]=e=>g(v).componentsAddForm.formData.relatedCompanyId=e)},null,8,["modelValue"]),h(r,{disabled:"",modelValue:g(v).componentsAddForm.formData.relatedCompanyNo,"onUpdate:modelValue":a[1]||(a[1]=e=>g(v).componentsAddForm.formData.relatedCompanyNo=e),placeholder:"请输入企业编码"},null,8,["modelValue"])])),_:1}),h(m,{label:"企业名称",prop:"relatedCompanyName"},{default:y((()=>[h(r,{modelValue:g(v).componentsAddForm.formData.relatedCompanyName,"onUpdate:modelValue":a[2]||(a[2]=e=>g(v).componentsAddForm.formData.relatedCompanyName=e),placeholder:"请输入企业名称",clearable:"",maxlength:"128"},null,8,["modelValue"])])),_:1}),h(m,{label:"所属部门",prop:"organId"},{default:y((()=>[f("div",B,[h(r,{class:"ap-box-contBox-input width-100",readonly:"",modelValue:g(v).componentsAddForm.formData.organName,"onUpdate:modelValue":a[3]||(a[3]=e=>g(v).componentsAddForm.formData.organName=e),placeholder:"请选择",onClick:a[4]||(a[4]=e=>I())},null,8,["modelValue"]),h(r,{type:"hidden",modelValue:g(v).componentsAddForm.formData.organId,"onUpdate:modelValue":a[5]||(a[5]=e=>g(v).componentsAddForm.formData.organId=e)},null,8,["modelValue"]),f("div",V,[f("img",{onClick:a[6]||(a[6]=e=>I()),class:"ap-box-contBox-icon-img",src:d,alt:""})])])])),_:1}),h(m,{label:"联系人",prop:"contactName"},{default:y((()=>[h(r,{modelValue:g(v).componentsAddForm.formData.contactName,"onUpdate:modelValue":a[7]||(a[7]=e=>g(v).componentsAddForm.formData.contactName=e),placeholder:"请输入联系人",clearable:"",maxlength:"64"},null,8,["modelValue"])])),_:1}),h(m,{label:"联系方式",prop:"contactInformation"},{default:y((()=>[h(r,{modelValue:g(v).componentsAddForm.formData.contactInformation,"onUpdate:modelValue":a[8]||(a[8]=e=>g(v).componentsAddForm.formData.contactInformation=e),placeholder:"请输入联系方式",clearable:"",maxlength:"64"},null,8,["modelValue"])])),_:1}),h(m,{label:"备注",prop:"readme"},{default:y((()=>[h(r,{type:"textarea",rows:4,modelValue:g(v).componentsAddForm.formData.readme,"onUpdate:modelValue":a[9]||(a[9]=e=>g(v).componentsAddForm.formData.readme=e),placehoder:"请输入备注",maxlength:"512"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["show","title","confirmText","concelText"]),j.value?(i(),C(l,{key:0,show:j.value,"onUpdate:show":a[11]||(a[11]=e=>j.value=e),tabsShow:["organ"],multiple:!1,"onUpdate:searchSelected":E,searchSelected:g(v).searchSelected},null,8,["show","searchSelected"])):b("",!0)],64)}}},[["__scopeId","data-v-7c71dbe5"]]),_={class:"title"},z={class:"title-more"},k={class:"title-more-add"},S={class:"title-more-down"},J=(e=>(A("data-v-49cd03c2"),e=e(),D(),e))((()=>f("img",{class:"button-icon",src:e,alt:"",srcset:""},null,-1))),M={class:"header-div"},R=["src"],T=o({setup(e){const t=r(!1),o=r([]),l=r(!1),n=r(null),d=m({title:"新增",column:{},relatedCompanyIds:[],componetsAddForm:{showAddDialog:!1},componentsSearchForm:{style:{lineStyle:{width:"30%"},labelStyle:{width:"100px"}},data:[{id:"relatedCompanyName",label:"关键词",type:"input",inCommonUse:!0,defaultAttribute:{placeholder:"企业名称/企业编码/联系人/联系方式"}},{id:"organId",requestParams:"organId",label:"所属部门",type:"derivable",inCommonUse:!0,defaultAttribute:{type:"organ",placeholder:"+所属部门",joinStr:",",multiple:!0},values:[]}],butData:[{id:"more",name:"展开",type:"unfold",defaultAttribute:{type:"primary"},style:{}},{id:"inquire",name:"t-zgj-query",type:"click",defaultAttribute:{type:"primary"},style:{}},{id:"reset",name:"t-zgj-reset",type:"click",defaultAttribute:{},style:{}}]},componentsTable:{header:[{prop:"relatedCompanyName",label:"企业名称",sortable:!0,"min-width":150,fixed:!0,"show-overflow-tooltip":!0,show:!0},{prop:"relatedCompanyNo",label:"企业编码",sortable:!0,show:!0,"min-width":150},{prop:"organName",label:"所属部门",sortable:!0,show:!0,"min-width":150},{prop:"contactName",label:"联系人",sortable:!0,show:!0,"min-width":150},{prop:"contactInformation",label:"联系方式",sortable:!0,show:!0,"min-width":150},{prop:"readme",label:"备注",sortable:!0,show:!0,"min-width":150,"show-overflow-tooltip":!0},{prop:"7",label:"操作",fixed:"right",width:"120px",show:!0,align:"center",rankDisplayData:[{name:"t-zgj-Edit"},{name:"t-zgj-Delete"}]}],data:[],defaultAttribute:{stripe:!0,"header-cell-style":{background:"var(--jy-color-fill--3)"},"cell-style":({row:e,column:a,rowIndex:t,columnIndex:o})=>{if("relatedCompanyName"===a.property)return{color:"var(--jy-info-6)",cursor:"pointer"}}},loading:!1},componentsPagination:{data:{amount:0,index:1,pageNumber:10},defaultAttribute:{layout:"prev, pager, next, jumper",total:0,"page-sizes":[10,50,100],background:!0}},componentsBatch:{selectionData:[],defaultAttribute:{disabled:!0},data:[{name:"t-zgj-seal.BatchDelete"}]},JyElMessageBox:{show:!1,header:{data:"",icon:"/src/assets/svg/common/warning.svg"},content:{data:""},type:"删除"}}),s=()=>{l.value=!1},p=(e,a)=>{200===e.code&&(I.success(`${a}成功！`),l.value=!1,n.value.reloadData())};function C(e,a,l,n){"relatedCompanyName"===a.property&&(t.value=!0,o.value=[{value:"detail",params:e.relatedCompanyId}])}function b(e,a,t,o){d.relatedCompanyIds=[],d.relatedCompanyIds.push(a.relatedCompanyId),"t-zgj-Edit"===t.name&&(d.title="t-zgj-Edit",N.detailRelatedCompany(a.relatedCompanyId).then((e=>{200===e.code&&(d.column=e.data,l.value=!0)}))),"t-zgj-Delete"===t.name&&(d.JyElMessageBox.header.data="t-zgj-Delete",d.JyElMessageBox.content.data="请问确定要删除吗？",d.JyElMessageBox.show=!0)}const w=e=>{N.deleteRelatedCompany({relatedCompanyIds:d.relatedCompanyIds}).then((a=>{200===a.code&&(I.success(`${e}成功！`),d.JyElMessageBox.show=!1,n.value.reloadData())}))},A=(e,a)=>{d.relatedCompanyIds=[];const t=d.componentsBatch.selectionData=a;let o="";const l=[],n=[];t.forEach((e=>{l.push(`[${e.relatedCompanyName}]`),n.push(e.relatedCompanyId)})),d.relatedCompanyIds=n,o=l.join("、"),"t-zgj-seal.BatchDelete"===e.name&&(d.JyElMessageBox.header.data="t-zgj-seal.BatchDelete",d.JyElMessageBox.content.data=`已选中往来企业：${o}，请问确定要批量删除吗？`,d.JyElMessageBox.show=!0,d.JyElMessageBox.type="批量删除")};return j((()=>{})),(e,r)=>{const m=c("el-button"),j=c("el-dropdown-item"),D=c("el-dropdown-menu"),I=c("el-dropdown"),N=c("JyElMessageBox");return i(),u("div",null,[h(a,{url:"/tenant/relatedCompany/list",ref_key:"table",ref:n,needAutoRequest:!0,componentsSearchForm:g(d).componentsSearchForm,componentsTableHeader:g(d).componentsTable.header,componentsBatch:g(d).componentsBatch,tableClick:"relatedCompanyName",onCellClick:C,onCustomClick:b,onClickBatchButton:A},{title:y((()=>[f("div",_,[f("div",null,v(e.$t("t-zgj-F_CUSTOMER_MANAGE")),1),f("div",z,[f("div",k,[h(m,{type:"primary",onClick:r[0]||(r[0]=()=>{l.value=!0,g(d).title="t-zgj-add",g(d).column={}})},{default:y((()=>[x(" + "+v(e.$t("t-zgj-add")),1)])),_:1})]),f("div",S,[h(I,null,{dropdown:y((()=>[h(D,null,{default:y((()=>[h(j,null,{default:y((()=>[x(v(e.$t("t-zgj-importCustomer.title")),1)])),_:1})])),_:1})])),default:y((()=>[h(m,null,{default:y((()=>[J,f("span",null,v(e.$t("t-zgj-table.more.Operation")),1)])),_:1})])),_:1})])])])])),_:1},8,["componentsSearchForm","componentsTableHeader","componentsBatch"]),h(F,{modelValue:t.value,"onUpdate:modelValue":r[1]||(r[1]=e=>t.value=e),modulesName:"dealing_unit",detailParams:o.value,importParams:e.importParams},null,8,["modelValue","detailParams","importParams"]),h(E,{showAdd:l.value,title:g(d).title,column:g(d).column,onOnCancel:s,onOnConfirm:p},null,8,["showAdd","title","column"]),h(N,{modelValue:g(d).JyElMessageBox.show,"onUpdate:modelValue":r[2]||(r[2]=e=>g(d).JyElMessageBox.show=e),show:g(d).JyElMessageBox.show,defaultAttribute:{},showClose:!1,onConfirmClick:r[3]||(r[3]=a=>{return t=e.$t(g(d).JyElMessageBox.header.data),void w(t);var t})},{header:y((()=>[f("div",M,[f("img",{src:g(d).JyElMessageBox.header.icon,alt:""},null,8,R),f("span",null,v(e.$t(g(d).JyElMessageBox.header.data)),1)])])),content:y((()=>[x(v(g(d).JyElMessageBox.content.data),1)])),_:1},8,["modelValue","show"])])}}},[["__scopeId","data-v-49cd03c2"]]);export{T as default};
