System.register(["./main-legacy-e4f08f00.js","./index-legacy-6ef5f303.js","./index-legacy-63cb8d64.js","./back-legacy-abbf9c2a.js","./step_next-legacy-cd009860.js","./Layout-legacy-2d6304ed.js","./JyStep-legacy-0501cd89.js","./index-legacy-8e8fab9d.js","./index-legacy-4bc08aba.js","./home-back-legacy-d9a8ace4.js","./logo-legacy-7450937f.js","./request-util-legacy-a95fc64c.js"],(function(e,t){"use strict";var a,l,i,n,o,s,c,r,d,f,u,m,p,g,v,y,h,P,b,x,I,w,S,j,z,k,D,_,V,N,M,T,J,C,O,q,L,F,A=document.createElement("style");return A.textContent=".Seal-application-fill-form[data-v-5dd70f9f]{margin:0%;position:relative}.Seal-application-fill-form .contanier-flow[data-v-5dd70f9f]{width:100%;padding:0;margin-top:0}.Seal-application-fill-form .title[data-v-5dd70f9f]{display:flex;align-items:center;justify-content:space-between}.Seal-application-fill-form .title .title-desc[data-v-5dd70f9f]{display:flex;align-items:center}.Seal-application-fill-form .title .title-desc .title-desc-img[data-v-5dd70f9f]{margin-right:.5rem;cursor:pointer}.Seal-application-fill-form .PrintingProcess[data-v-5dd70f9f]{min-width:1440px}.Seal-application-fill-form .PrintingProcess .PrintingProcess-content[data-v-5dd70f9f]{display:flex;flex-flow:wrap}.Seal-application-fill-form .PrintingProcess .PrintingProcess-content .PrintingProcess-content-list[data-v-5dd70f9f]{margin-bottom:1rem;display:flex;align-items:center}.Seal-application-fill-form .PrintingProcess .PrintingProcess-content .PrintingProcess-content-list .PrintingProcess-content-list-cont[data-v-5dd70f9f]{height:17rem;align-self:flex-start;width:15rem;border:1px solid var(--jy-color-border-1);background-color:var(--jy-color-fill--1);padding:1rem;box-sizing:border-box}.Seal-application-fill-form .PrintingProcess .PrintingProcess-content .PrintingProcess-content-list .PrintingProcess-content-list-cont .PrintingProcess-content-list-cont-title[data-v-5dd70f9f]{display:flex;justify-content:center;height:2rem;align-items:center;font-size:var(--jy-font-size-title-1)}.Seal-application-fill-form .PrintingProcess .PrintingProcess-content .PrintingProcess-content-list .PrintingProcess-content-list-cont .PrintingProcess-content-list-cont-title .PrintingProcess-content-list-cont-title-img[data-v-5dd70f9f]{margin-right:.5rem}.Seal-application-fill-form .PrintingProcess .PrintingProcess-content .PrintingProcess-content-list .PrintingProcess-content-list-cont .PrintingProcess-content-list-cont-list[data-v-5dd70f9f]{display:flex;align-items:center;justify-content:space-between;padding:.5rem 1rem;box-sizing:border-box}.Seal-application-fill-form .PrintingProcess .PrintingProcess-content .PrintingProcess-content-list .PrintingProcess-content-list-iocn[data-v-5dd70f9f]{margin-left:1rem;margin-right:1rem;width:3rem;display:flex;align-items:center;justify-content:center}.Seal-application-fill-form .custom[data-v-5dd70f9f]{box-sizing:border-box;text-align:center;padding:10px 16px 0;max-height:calc(100vh - 210px)}.Seal-application-fill-form .custom-buzhou[data-v-5dd70f9f]{display:flex;justify-content:center;align-items:center;padding:0;box-sizing:border-box}.Seal-application-fill-form .custom-buzhou .custom-buzhou-list[data-v-5dd70f9f]{display:flex;justify-content:center;align-items:center}.Seal-application-fill-form .custom-buzhou .custom-buzhou-list .custom-buzhou-list-desc[data-v-5dd70f9f]{display:flex;justify-content:center;align-items:center;width:10rem}.Seal-application-fill-form .custom-buzhou .custom-buzhou-list .custom-buzhou-list-desc .custom-buzhou-list-desc-index[data-v-5dd70f9f]{width:1.5rem;height:1.5rem;display:flex;justify-content:center;align-items:center;background-color:var(--jy-color-fill--3);color:var(--jy-color-text-3);border-radius:var(--jy-border-radius-2);margin-right:.5rem}.Seal-application-fill-form .custom-buzhou .custom-buzhou-list .custom-buzhou-list-desc .custom-buzhou-list-desc-text[data-v-5dd70f9f]{font-size:var(--jy-font-size-title-1);color:var(--jy-color-text-3)}.Seal-application-fill-form .custom-buzhou .custom-buzhou-list .custom-buzhou-list-jiantou[data-v-5dd70f9f]{width:7rem;display:flex;justify-content:center;align-items:center}.Seal-application-fill-form .custom-buzhou .indexActive[data-v-5dd70f9f]{background-color:var(--jy-primary-6)!important;color:var(--jy-in-common-use-1)!important}.Seal-application-fill-form .custom-buzhou .textActive[data-v-5dd70f9f]{color:var(--jy-color-text-1)!important}.Seal-application-fill-form .custom-buzhou .font-color-45[data-v-5dd70f9f]{color:var(--jy-color-text-3)!important}.Seal-application-fill-form .ap-fixed[data-v-5dd70f9f]{width:100%;position:absolute;bottom:0%;height:4rem;display:flex;justify-content:center;align-items:center;border-top:1px solid var(--jy-color-border-2);background-color:var(--jy-in-common-use-1);z-index:9}.Seal-application-fill-form .ap-fixed .ap-fixed-save-icon .iconpark-icon[data-v-5dd70f9f]{width:1rem;height:1rem}.topTitles[data-v-5dd70f9f]{width:100%;display:flex;justify-content:space-between;align-items:center}.upload-demo[data-v-5dd70f9f]{text-align:left}.custom .ap-cont-box-title-label[data-v-5dd70f9f]{width:100%!important}\n",document.head.appendChild(A),{setters:[e=>{a=e._,l=e.I,i=e.C,n=e.v,o=e.h,s=e.j,c=e.k,r=e.r,d=e.o,f=e.c,u=e.a,m=e.w,p=e.m,g=e.u,v=e.P,y=e.Q,h=e.f,P=e.l,b=e.F,x=e.e,I=e.q,w=e.t,S=e.g,j=e.b4,z=e.Y,k=e.aa,D=e.cz,_=e.cB,V=e.y,N=e.z,M=e.aX},e=>{T=e.default},e=>{J=e.default},e=>{C=e._},e=>{O=e._},e=>{q=e.c},e=>{L=e.S},e=>{F=e._},null,null,null,null],execute:function(){const t=e=>(V("data-v-5dd70f9f"),e=e(),N(),e),A={class:"Seal-application-fill-form"},U={class:"breadcrumb"},B=S(" 用印申请 "),Q=S(" 新建用印申请 "),E=S(" 新建用印申请 "),Y=t((()=>p("div",null,null,-1))),H={class:"custom-buzhou"},K={class:"custom"},X={key:1},$={class:"PrintingProcess"},G={class:"PrintingProcess-content"},R={class:"PrintingProcess-content-list-cont"},W={class:"PrintingProcess-content-list-cont-title"},Z=t((()=>p("img",{class:"PrintingProcess-content-list-cont-title-img",src:"/zgj-web/assets/calendar-67a958ae.svg",alt:""},null,-1))),ee={class:"PrintingProcess-content-list-cont-title-span"},te={class:"PrintingProcess-content-list-cont-list-name"},ae=t((()=>p("div",{class:"PrintingProcess-content-list-cont-list-icon"},[p("img",{class:"PrintingProcess-content-list-cont-list-icon-img",src:"/zgj-web/assets/tips-e93e6fe1.svg",alt:""})],-1))),le={class:"PrintingProcess-content-list-iocn"},ie={key:0,class:"PrintingProcess-content-list-iocn-img",src:O,alt:""},ne={key:0,class:"fixed"},oe={class:"ap-fixed"},se=S("下一步"),ce=t((()=>p("span",{class:"ap-fixed-save-text"}," 保存模板 ",-1))),re=t((()=>p("div",{style:{width:"300px"}}," 模板可用于提高重复发起同种类型用印申请的填写效率，一种文件类型仅允许保存一个模板，保存后可在申请页面直接引用 ",-1))),de=t((()=>p("i",{class:"ap-fixed-save-icon"},[p("svg",{class:"iconpark-icon"},[p("use",{href:"#icon4"})])],-1))),fe={key:1,class:"fixed"},ue={class:"ap-fixed"},me=S("提交 "),pe=S("上一步"),ge=S(" 若当前文件类型已有模版则会覆盖，若当前文件类型没有模板则会创建，请问确定要保存吗？ ");e("default",a({setup(e){const t=l(),a=i(),S=n(null),V=n(null),N=n(null),O=n(null),ve=n(a.query.formVersionId),ye=n(null),he=n(!1),Pe=o({cache:{flowList:[{name:"填写表单信息",active:!0},{name:"确认审批流程",active:!1},{name:"完成",active:!1}],formData:{},optionData:{},SealformData:{},SealoptionData:{},PrintingProcess:{list:[{title:"盖前",list:[{name:"说明详情后续补上"}]},{title:"实时视频盖章",list:[{name:"说明详情后续补上"},{name:"说明详情后续补上"},{name:"说明详情后续补上"}]},{title:"盖中",list:[{name:"说明详情后续补上"},{name:"说明详情后续补上"},{name:"说明详情后续补上"},{name:"说明详情后续补上"},{name:"说明详情后续补上"}]},{title:"盖后",list:[{name:"说明详情后续补上"}]},{title:"归档",list:[{name:"说明详情后续补上"}]}]}}}),be=n(null),xe=n("one"),Ie=n(null),we=n([]),Se=n(null),je=n(!1),ze=n(null),ke=n({}),De=n(null),_e=n({padding:"24px 0 24px 24px"}),Ve=()=>{j.templateAdd({formVersionId:ve.value,templateName:ze.value.applyName,fileTypeId:ze.value.fileTypeId,templateValue:JSON.stringify(ze.value)}).then((e=>{z.success("保存模板成功"),je.value=!1})).catch((()=>{je.value=!1}))},Ne=()=>{je.value=!1};function Me(){t.go(-1)}function Te(){be.value.getFormData().then((e=>{Pe.cache.formData=e;const t=Pe.cache.flowList;t[0].active=!1,t[1].active=!0,Pe.cache.flowList=JSON.parse(JSON.stringify(t)),xe.value="two",j.flowList({formMessageId:a.query.formMessageId,fileTypeId:e.fileTypeId}).then((e=>{e.data&&e.data.length&&(we.value=e.data,Se.value=e.data[0].flowMessageId,ye.value=e.data[0].flowVersionId,Oe(e.data[0].modelId,e.data[0].definitionId))}))}))}const Je=async()=>{ze.value=null;const e=await be.value.getFormData(!1);e.fileTypeId||e.applyName?(ze.value=e,je.value=!0):z.warning("单据名称和文件类型必填，否则不允许保存模板")};function Ce(){const e=we.value.find((e=>e.flowMessageId===Se.value));ye.value=e.flowVersionId,Oe(e.modelId,e.definitionId)}function Oe(e,t){S.value={modelId:e,definitionId:t},j.flowDetail({...S.value,edit:!0}).then((async e=>{De.value=null,k((()=>{De.value=e.data.data,k((()=>{ke.value={height:document.getElementById("flow-designer-box").clientHeight+"px",overflow:"hidden"}}))}))}))}function qe(){const e=Pe.cache.flowList;e[0].active=!0,e[1].active=!1,Pe.cache.flowList=JSON.parse(JSON.stringify(e)),xe.value="one"}function Le(){if(!Se.value)return void z.warning("请选择审批流程");const e=M;let l={},i={};for(const t in Pe.cache.formData)e.indexOf(t)>-1?l={...l,[t]:Pe.cache.formData[t]}:i={...i,[t]:Pe.cache.formData[t]};const n={modelId:S.value.modelId,definitionId:S.value.definitionId,instanceName:Pe.cache.formData.applyName,suggest:null,formData:{...Pe.cache.formData,formVersionId:ve.value,flowVersionId:ye.value,formMessageId:a.query.formMessageId,flowMessageId:Se.value},variable:{subType:V.value,instanceType:N.value}};he.value=!0,j.submit(n).then((e=>{j.add({formMessageId:a.query.formMessageId,formVersionId:ve.value,flowVersionId:ye.value,applyTypeId:V.value,sealUseTypeId:O.value,flowMessageId:Se.value,gunsSysId:e.data.data.instanceId,customApplyField:"{}"===JSON.stringify(i)?null:i,...l}).then((()=>{t.replace({path:"/frontDesk/printControlManage/useSealManage/sealApplication/accomplish",query:{applyNo:Pe.cache.formData.applyNo}})})).finally((()=>{he.value=!1}))})).finally((()=>{he.value=!1}))}return s((()=>{a.query.useId?j.formQuery({formMessageId:a.query.formMessageId}).then((e=>{V.value=e.data.applyTypeId,N.value=e.data.applyTypePid,O.value=e.data.sealUseTypeId,Ie.value=JSON.parse(e.data.formInfo),j.templateView(a.query.useId).then((e=>{ve.value=e.data.formVersionId,be.value.setFormData(JSON.parse(e.data.templateValue)),k((()=>{be.value.setFieldValue("applyNo",D())}))}))})):j.formQuery({formMessageId:a.query.formMessageId}).then((e=>{V.value=e.data.applyTypeId,N.value=e.data.applyTypePid,O.value=e.data.sealUseTypeId,Ie.value=JSON.parse(e.data.formInfo),k((()=>{be.value.setFieldValue("applyNo",D())}))}))})),c((()=>{})),(e,t)=>{const a=r("el-breadcrumb-item"),l=r("el-breadcrumb"),i=J,n=r("el-option"),o=r("el-select"),s=T,c=r("el-scrollbar"),S=r("el-button"),j=r("el-tooltip"),z=_;return d(),f("div",A,[u(q,{Layout:"breadcrumb,title,custom,fixed",cardStyle:_e.value},{breadcrumb:m((()=>[p("div",U,[u(l,{separator:"/"},{default:m((()=>[u(a,{style:{"--el-text-color-regular":"rgba(0, 0, 0, 0.65)"}},{default:m((()=>[B])),_:1}),u(a,{style:{"--el-text-color-regular":"rgba(0, 0, 0, 0.25)"}},{default:m((()=>[Q])),_:1})])),_:1})])])),title:m((()=>[p("div",{class:"title"},[p("div",{class:"title-desc"},[p("img",{class:"title-desc-img",src:C,alt:"",onClick:Me}),E]),Y])])),custom:m((()=>[p("div",H,[u(L,{data:g(Pe).cache.flowList},null,8,["data"])]),u(c,{height:"calc(100vh - 300px)",style:{"padding-right":"24px"}},{default:m((()=>[p("div",K,[Ie.value?v((d(),h(i,{key:0,mode:"render",formJson:Ie.value,formData:g(Pe).cache.formData,optionData:g(Pe).cache.optionData,ref_key:"refFillFormInformation",ref:be},null,8,["formJson","formData","optionData"])),[[y,"one"===xe.value]]):P("",!0),"two"===xe.value?(d(),f("div",X,[u(s,{label:"审批流程"},{right:m((()=>[u(o,{modelValue:Se.value,"onUpdate:modelValue":t[0]||(t[0]=e=>Se.value=e),placeholder:"请选择流程",onChange:Ce},{default:m((()=>[(d(!0),f(b,null,x(we.value,(e=>(d(),h(n,{key:e.flowMessageId,label:e.flowName,value:e.flowMessageId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),De.value?(d(),h(F,I({key:0,id:"flow"},{readable:!0,mapable:!1,scroll:!1,scrollY:!1,top:"50"},{node:De.value,wrapStyle:ke.value}),null,16,["node","wrapStyle"])):P("",!0),p("div",$,[u(s,{label:"用印流程"}),p("div",G,[(d(!0),f(b,null,x(g(Pe).cache.PrintingProcess.list,((e,t)=>(d(),f("div",{class:"PrintingProcess-content-list",key:t},[p("div",R,[p("div",W,[Z,p("span",ee,w(e.title),1)]),(d(!0),f(b,null,x(e.list,((e,t)=>(d(),f("div",{class:"PrintingProcess-content-list-cont-list",key:t},[p("div",te,w(e.name),1),ae])))),128))]),p("div",le,[t<g(Pe).cache.PrintingProcess.list.length-1?(d(),f("img",ie)):P("",!0)])])))),128))])])])):P("",!0)])])),_:1})])),fixed:m((()=>["one"===xe.value?(d(),f("div",ne,[p("div",oe,[u(S,{type:"primary",onClick:Te},{default:m((()=>[se])),_:1}),u(S,{class:"ap-fixed-save",onClick:Je},{default:m((()=>[ce,u(j,{class:"box-item",effect:"dark",content:"",placement:"top"},{content:m((()=>[re])),default:m((()=>[de])),_:1})])),_:1})])])):P("",!0),"two"===xe.value?(d(),f("div",fe,[p("div",ue,[u(S,{type:"primary",loading:he.value,onClick:Le},{default:m((()=>[me])),_:1},8,["loading"]),u(S,{onClick:qe},{default:m((()=>[pe])),_:1})])])):P("",!0)])),_:1},8,["cardStyle"]),u(z,{modelValue:je.value,"onUpdate:modelValue":t[1]||(t[1]=e=>je.value=e),mode:1,onOnConfirm:Ve,onOnCancel:Ne,title:"保存模版"},{default:m((()=>[ge])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-5dd70f9f"]]))}}}));
