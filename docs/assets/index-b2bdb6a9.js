import{_ as e,v as a,s as t,h as o,i as l,aa as s,r,o as d,c as n,a as c,w as m,m as i,b as u,t as p,g as h,u as g,f,cu as b,l as D,x as w,ac as v,cv as S,a9 as y,y as F,z as T,ab as _,a8 as I,Y as x,k as A,q as B,F as O,e as U,ai as E,H as j,M as N}from"./main-e75bd94c.js";import{_ as V}from"./gengduo-caozuo-730fe1cb.js";import{_ as C}from"./ketanchude-a94e84bc.js";import{J as M}from"./JyTable-735e5f88.js";import{c as z}from"./documentsDetails-e4b559a6.js";import{m as k}from"./md5-e5d50886.js";import{a as P}from"./department-abadb76f.js";import{a as J}from"./actionMoreDialog-c32f63c4.js";import{a as $}from"./actionOneDialog-4ff87827.js";import"./sangedian-6ea00dcf.js";import"./Layout-a5f6ee71.js";import"./searchForm-6ca4b4e4.js";import"./KDocumentTypeDialog-6b47a1ba.js";import"./pagination-10abb664.js";import"./batch-99f4afc3.js";import"./index-7c7937e4.js";import"./cha-kong-c10eac4e.js";import"./JyTabs-82aef442.js";/* empty css                                                               */import"./table-d1366238.js";/* empty css                                                                         */import"./portion-ad7469a7.js";/* empty css                                                                */import"./yuan-hui-31c99901.js";const L=e=>(F("data-v-a0f61b00"),e=e(),T(),e),G={class:"jy-message-box"},R={class:"header-div"},q=[L((()=>i("svg",{class:"iconpark-icon"},[i("use",{href:"#Vector"})],-1)))],Y=h("手动输入"),H=h("随机生成"),W=L((()=>i("div",{class:"tips"},"提示：当员工存在手机号时会以短信的形式向员工发送随机密码，否则重置后请告知员工，以确保其正常登录",-1))),K=e({props:{show:{type:Boolean,default:!1},userIds:{type:Array,default:()=>[]},title:{type:String,default:"重置密码"}},emits:["update:show","on-confirm","on-cancel"],setup(e,{emit:F}){const T=e,_=a(null),I=t({get:()=>T.show,set(e){F("update:show",e)}}),x=o({formData:{newPassword:"",resetType:"1"},formRules:{resetType:[{required:!0,message:"请选择重置方式",trigger:"change"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"}]}});l((()=>T.show),(()=>{T.show&&s((()=>{_.value.resetFields(),x.formData.newPassword="",x.formData.resetType="1"}))}));const A=()=>{"2"===x.formData.resetType?B():x.formData.newPassword=null},B=()=>{const e=j(8);x.formData.newPassword=e},O=()=>{x.props.show=!1},U=()=>{_.value.validate((e=>{e&&("t-zgj-findpwd.resetPassword"===T.title&&v.userResetPassword({newPassword:k(x.formData.newPassword),userId:T.userIds[0]}).then((e=>{200===e.code?(F("on-confirm"),S("重置密码成功")):y("重置密码失败，请重试！")})),"t-zgj-findpwd.batchResetPassword"===T.title&&v.userBatchResetPassword({newPassword:x.formData.newPassword,userIds:T.userIds}).then((e=>{200===e.code?(F("on-confirm"),S("批量重置密码成功")):y("重置密码失败，请重试！")})))})),I.value=!1},E=e=>{F("on-cancel",e),I.value=!1},j=e=>{const a=[],t=()=>Math.floor(10*Math.random()),o=()=>String.fromCharCode(Math.floor(26*Math.random())+65),l=()=>String.fromCharCode(Math.floor(26*Math.random())+97),s=[t,o,l],r=()=>s[Math.floor(3*Math.random())]();Array(e-3).fill("").forEach((()=>{a.push(r())}));const d=[t(),o(),l()];return a.push(...d),a.join("")};return(e,a)=>{const t=r("el-radio"),o=r("el-radio-group"),l=r("el-form-item"),s=r("el-input"),v=r("el-col"),S=r("el-icon"),y=r("el-row"),F=r("el-form"),j=r("el-button"),N=r("el-dialog");return d(),n("div",G,[c(N,{modelValue:g(I),"onUpdate:modelValue":a[2]||(a[2]=e=>w(I)?I.value=e:null),"before-close":O,"show-close":!1,"destroy-on-close":"","close-on-press-escape":!1,"close-on-click-modal":!1,width:"40%","align-center":""},{header:m((()=>[i("div",null,[u(e.$slots,"header",{},(()=>[i("div",R,[i("span",null,p(e.$t(T.title)),1)])]),!0)]),i("div",{class:"dialog-header-remove",onClick:E},q)])),footer:m((()=>[c(j,{type:"primary",onClick:U},{default:m((()=>[h(p(e.$t("t-zgj-operation.submit")),1)])),_:1}),c(j,{onClick:E},{default:m((()=>[h(p(e.$t("t-zgj-operation.cancel")),1)])),_:1})])),default:m((()=>[c(F,{model:g(x).formData,rules:g(x).formRules,ref_key:"passwordForm",ref:_,"label-width":"80"},{default:m((()=>[c(l,{label:"重置方式",prop:"resetType",onChange:A},{default:m((()=>[c(o,{modelValue:g(x).formData.resetType,"onUpdate:modelValue":a[0]||(a[0]=e=>g(x).formData.resetType=e)},{default:m((()=>[c(t,{label:"1"},{default:m((()=>[Y])),_:1}),c(t,{label:"2"},{default:m((()=>[H])),_:1})])),_:1},8,["modelValue"])])),_:1}),c(l,{label:"新密码",prop:"newPassword"},{default:m((()=>[c(y,{gutter:10},{default:m((()=>[c(v,{span:"2"===g(x).formData.resetType?22:24},{default:m((()=>[c(s,{modelValue:g(x).formData.newPassword,"onUpdate:modelValue":a[1]||(a[1]=e=>g(x).formData.newPassword=e),placeholder:"请输入新密码",disabled:"2"===g(x).formData.resetType},null,8,["modelValue","disabled"])])),_:1},8,["span"]),"2"===g(x).formData.resetType?(d(),f(v,{key:0,span:2},{default:m((()=>[i("div",{onClick:B},[c(S,{class:"refresh-icon"},{default:m((()=>[c(g(b))])),_:1})])])),_:1})):D("",!0)])),_:1})])),_:1})])),_:1},8,["model","rules"]),W])),_:3},8,["modelValue"])])}}},[["__scopeId","data-v-a0f61b00"]]),Q=e=>(F("data-v-cb04f702"),e=e(),T(),e),X={class:"jy-message-box"},Z={class:"header-div"},ee=[Q((()=>i("svg",{class:"iconpark-icon"},[i("use",{href:"#Vector"})],-1)))],ae=Q((()=>i("div",{class:"el-upload__tip"}," 1.支持上传JPG/JPEG/PNG格式的人脸图片，大小不超过5M ",-1))),te=Q((()=>i("div",{class:"el-upload__tip"},"2.请尽量保证人脸图形完整清晰，没有遮挡 ",-1))),oe={class:"dialog-footer"},le=e({props:{userId:{type:Array,default:()=>[]},userFaceUri:{type:String,default:""},userUpdateFaceId:{type:String,default:""},show:{type:Boolean,default:!1}},emits:["update:modelValue","on-confirm","on-cancel"],setup(e,{emit:b}){const D=e,F=a(null);l((()=>D.userUpdateFaceId),(e=>{s((()=>{e&&(A.formData.userFaceId=e)}))}));const T=t({get:()=>D.show,set(e){b("update:modelValue",e)}}),A=o({formData:{userFaceId:"",userFaceUri:""},formRules:{userFaceId:[{required:!0,message:"",trigger:"change"}]},fileList:""}),B=e=>{A.formData.userFaceId=e.data.fileId,A.formData.userFaceUri=_+e.data.fileUrl},O=()=>{b("on-cancel"),A.formData.userFaceUri="",A.formData.userFaceId="",A.props.show=!1},U=()=>{F.value.validate((e=>{e?v.editOrganUserFace({userId:D.userId,fileId:A.formData.userFaceId,fileSourceType:"1"}).then((()=>{S("人脸设置成功"),A.formData.userFaceUri="",A.formData.userFaceId="",b("on-confirm")})):x.error("请上传人脸照片")}))},E=()=>{b("on-cancel")},j=e=>{const a="image/jpeg"===e.type||"image/jpg"===e.type||"image/png"===e.type,t=e.size/1024/1024<5;return a||y("上传头像图片只能是 JPG/JPEG/PNG 格式!"),t||y("上传头像图片大小不能超过 5MB!"),a&&t};return(e,a)=>{const t=r("el-image"),o=r("el-icon"),l=r("el-upload"),s=r("el-form-item"),b=r("el-form"),v=r("el-button"),S=r("el-dialog");return d(),n("div",X,[c(S,{title:"{{ $t(t-zgj-F_SEAL_CONSOLE_FACE_SETTING) }}",modelValue:g(T),"onUpdate:modelValue":a[0]||(a[0]=e=>w(T)?T.value=e:null),"before-close":O,"show-close":!1,"destroy-on-close":"","close-on-click-modal":!1,"close-on-press-escape":!1,width:"600","align-center":"",draggable:""},{header:m((()=>[i("div",null,[u(e.$slots,"header",{},(()=>[i("div",Z,[i("span",null,p(e.$t("t-zgj-F_SEAL_CONSOLE_FACE_SETTING")),1)])]),!0)]),i("div",{class:"dialog-header-remove",onClick:E},ee)])),footer:m((()=>[i("span",oe,[c(v,{type:"primary",onClick:U},{default:m((()=>[h(p(e.$t("t-zgj-operation.submit")),1)])),_:1}),c(v,{onClick:E},{default:m((()=>[h(p(e.$t("t-zgj-operation.cancel")),1)])),_:1})])])),default:m((()=>[c(b,{model:g(A).formData,rules:g(A).formRules,ref_key:"uploadForm",ref:F},{default:m((()=>[c(s,{label:"人脸照片",prop:"userFaceId"},{default:m((()=>[c(l,{class:"avatar-uploader",action:`${g(_)}/user/uploadUserFace`,"show-file-list":!1,"list-type":"picture-card","before-upload":j,"on-success":B},{tip:m((()=>[ae,te])),default:m((()=>[g(A).formData.userFaceUri||D.userFaceUri?(d(),f(t,{key:0,src:g(A).formData.userFaceUri||D.userFaceUri,style:{padding:"6px"}},{error:m((()=>[])),_:1},8,["src"])):(d(),f(o,{key:1,class:"avatar-uploader-icon"},{default:m((()=>[c(g(I))])),_:1}))])),_:1},8,["action"])])),_:1})])),_:1},8,["model","rules"])])),_:3},8,["modelValue"])])}}},[["__scopeId","data-v-cb04f702"]]),se=[{prop:"userName",label:"姓名",flex:!0,"min-width":150,show:!0},{prop:"accountNo",label:"账号","min-width":150,show:!0},{prop:"hostOrganName",label:"所属部门","min-width":150,show:!0},{prop:"userTitle",label:"职位","min-width":150,show:!0},{prop:"faceState",label:"人脸状态","min-width":150,show:!0},{prop:"flag",label:"状态","min-width":150,show:!0},{prop:"caozuo",label:"操作",fixed:"right","min-width":365,show:!0,align:"center",rankDisplayData:[{name:"t-zgj-Edit"},{name:"status"},{name:"t-zgj-Delete"},{name:"t-zgj-findpwd.resetPassword"},{name:"t-zgj-F_SEAL_CONSOLE_FACE_SETTING"}]}],re=e=>(F("data-v-a8bd7420"),e=e(),T(),e),de={class:"title"},ne={class:"title-more"},ce={class:"title-more-add"},me={class:"title-more-down"},ie=re((()=>i("img",{class:"button-icon",src:V,alt:"",srcset:""},null,-1))),ue={class:"components-tree"},pe={class:"select-box-contBox"},he={class:"ap-box-contBox-icon"},ge={class:"ap-box-contBox"},fe=[re((()=>i("img",{class:"ap-box-contBox-icon-img",src:C,alt:""},null,-1)))],be={class:"select-box-contBox"},De={class:"ap-box-contBox-icon"},we={class:"ap-box-contBox"},ve=[re((()=>i("img",{class:"ap-box-contBox-icon-img",src:C,alt:""},null,-1)))],Se={key:1,class:"iconpark-icon",style:{width:"28px",color:"var(--el-text-color-secondary)"}},ye=[re((()=>i("use",{href:"#icon-add"},null,-1)))],Fe=re((()=>i("div",{class:"el-upload__tip"},"1.支持上传JPG/JPEG/PNG格式的人脸图片，大小不超过5M",-1))),Te=re((()=>i("div",{class:"el-upload__tip"},"2.请尽量保证人脸图形完整清晰，没有遮挡",-1))),_e={class:"ap-box"},Ie=e({setup(e){const t=a(!1),l=a(!1),u=a(null),b=a(null),w=a(!1),S=a("t-zgj-index.updatePwd"),F=a(!1),T=a("-1"),I=a(null),V=a(null),k=a([]),L=a(!1),G=o({showToastDialog:{show:!1,header:{data:"",icon:"/src/assets/svg/common/warning.svg"},content:{data:""},type:"批量删除",oneBtn:!1,confirmText:"t-zgj-know"},title:"t-zgj-add",tabsShow:["organ"],multiple:!0,tabSelects:{searchSelected:[],hostOrganSelected:[],rolesSelected:[],leaderUserSelected:[],partTimeOrgansSelected:[]},JyElMessageBox:{show:!1,header:{data:"",icon:"/src/assets/svg/common/warning.svg"},content:{data:""},type:"删除",oneBtn:!1,confirmText:"",column:{}},componentsAddForm:{formData:{userId:"",userName:"",accountNo:"",userTel:"",hostOrganId:"",hostOrganName:"",partTimeOrganIds:[],partTimeOrgans:[],userTitle:"",userMail:"",roleIds:[],roles:[],qweiNo:"",dingdingNo:"",userNo:"",leaderUserId:"",leaderUserName:"",userFaceId:"",readme:""},formRules:{userName:[{required:!0,message:"请输入姓名",trigger:"change"}],accountNo:[{required:!0,message:"请输入帐号",trigger:"change"}],userTel:[{required:!0,message:"请输入正确的手机号",pattern:/^1(3[0-9]|4[01456879]|5[0-35-9]|6[2567]|7[0-8]|8[0-9]|9[0-35-9])\d{8}$/,trigger:"change"}],hostOrganName:[{required:!0,message:"请选择所属部门",trigger:"change"}],roleIds:[{required:!0,message:"请选择角色",trigger:"change"}]}},componentsSearchForm:{data:[{id:"keyWord",label:"关键词",type:"input",inCommonUse:!0,defaultAttribute:{placeholder:"姓名/账号/职位"}},{id:"flag",label:"状态",type:"select",inCommonUse:!0,options:[{status:"0",statusLabel:"停用"},{status:"1",statusLabel:"启用"}],optionLabel:"statusLabel",optionValue:"status",defaultAttribute:{placeholder:"请选择"}},{id:"faceState",label:"人脸状态",type:"select",inCommonUse:!1,options:[{faceState:"0",faceStateLabel:"未绑定"},{faceState:"1",faceStateLabel:"已绑定"}],optionLabel:"faceStateLabel",optionValue:"faceState",defaultAttribute:{placeholder:"请选择"}}],butData:[{id:"more",name:"展开",type:"unfold",defaultAttribute:{type:"primary"},style:{}},{id:"inquire",name:"t-zgj-query",label:"查询",type:"click",defaultAttribute:{type:"primary"},style:{}},{id:"reset",name:"t-zgj-reset",label:"重置",type:"click",defaultAttribute:{},style:{}}]},componentsTable:{header:se},componentsTree:{data:[],defaultAttribute:{"check-on-click-node":!0,"show-checkbox":!1,"expand-on-click-node":!1,"check-strictly":!0,"highlight-current":!0,"node-key":"organId","current-node-key":"-1",accordion:!0},defaultProps:{label:"organName",children:"children",isLeaf:"haveChildren"},value:""},componentsDocumentsDetails:{show:!1,visible:[{label:"员工详情",name:"Staff-Details"}]},componentsBatch:{selectionData:[],defaultAttribute:{disabled:!0},data:[{name:"t-zgj-dept.BatchDeactivation"},{name:"t-zgj-dept.BatchEnable"},{name:"t-zgj-seal.BatchDelete"},{name:"t-zgj-findpwd.batchResetPassword"}],userIds:[]},userUpdateFaceUri:"",userUpdateFaceId:""});function R(e,a){if(0===e.level)V.value=e,P.subOrganList(-1).then((e=>(e.data.forEach((e=>e.haveChildren=!e.haveChildren)),k.value=e.data,a([{organName:j("accountInfo")&&j("accountInfo").userDepartName,organId:"-1",haveChildren:!1,children:[]}])))).then((()=>{s((()=>{const e=V.value.childNodes[0];e.expanded=!0,e.loadData()}))}));else{if(1===e.level)return a(k.value);P.subOrganList(e.data.organId).then((e=>(e.data.forEach((e=>e.haveChildren=!e.haveChildren)),a(e.data))))}}const q=()=>{w.value=!1,F.value=!1,I.value.reloadData()},Y=()=>{w.value=!1,F.value=!1},H=()=>{G.title="t-zgj-add",t.value=!0,G.tabSelects.partTimeOrgansSelected=[],G.componentsAddForm.formData.partTimeOrganIds=[],G.componentsAddForm.formData.partTimeOrgans=[],G.tabSelects.rolesSelected=[],G.componentsAddForm.formData.roleIds=[],G.componentsAddForm.formData.roles=[];for(const e in G.componentsAddForm.formData)Array.isArray(e)||(G.componentsAddForm.formData[e]="");s((()=>{u.value.resetFields()}))},W=(e,a)=>{b.value=e,G.multiple=a,G.tabsShow=[],G.tabSelects.searchSelected=[],"hostOrgan"===b.value&&(G.tabsShow=["organ"],G.tabSelects.searchSelected=G.tabSelects.hostOrganSelected),"partTimeOrgan"===b.value&&(G.tabsShow=["organ"],G.tabSelects.searchSelected=G.tabSelects.partTimeOrgansSelected.length>0?G.tabSelects.partTimeOrgansSelected.map((e=>({id:e.value,name:e.label,haveChildren:e.haveChildren,type:"organ"}))):[]),"roles"===b.value&&(G.tabsShow=["role"],G.tabSelects.searchSelected=G.tabSelects.rolesSelected,G.tabSelects.searchSelected=G.tabSelects.rolesSelected.length>0?G.tabSelects.rolesSelected.map((e=>({id:e.value,name:e.label,type:"role"}))):[]),"leaderUser"===b.value&&(G.tabsShow=["user"],G.tabSelects.searchSelected=G.tabSelects.leaderUserSelected),l.value=!0},Q=e=>{"hostOrgan"===b.value&&(G.tabSelects.hostOrganSelected=e,G.componentsAddForm.formData.hostOrganName=e[0].name,G.componentsAddForm.formData.hostOrganId=e[0].id),"partTimeOrgan"===b.value&&(G.tabSelects.partTimeOrgansSelected=[],G.componentsAddForm.formData.partTimeOrgans=[],e.length>0&&(G.tabSelects.partTimeOrgansSelected=e.map((e=>({label:e.name,value:e.id,type:"organ",haveChildren:e.haveChildren}))),G.componentsAddForm.formData.partTimeOrganIds=e.map((e=>e.id)))),"roles"===b.value&&(G.tabSelects.rolesSelected=[],G.componentsAddForm.formData.roles=[],e.length>0&&(G.tabSelects.rolesSelected=e.map((e=>({label:e.name,value:e.id,type:"role"}))),G.componentsAddForm.formData.roleIds=e.map((e=>e.id)))),"leaderUser"===b.value&&(G.tabSelects.leaderUserSelected=e,G.componentsAddForm.formData.leaderUserId=e[0].id,G.componentsAddForm.formData.leaderUserName=e[0].name),l.value=!1},X=e=>{G.componentsAddForm.formData.fileId=e.data.fileId,G.componentsAddForm.formData.userFaceId=e.data.fileId,G.componentsAddForm.formData.userFaceUri=e.data.fileUrl},Z=e=>{const a="image/jpeg"===e.type||"image/jpg"===e.type||"image/png"===e.type,t=e.size/1024/1024<5;return a||y("上传头像图片只能是 JPG/JPEG/PNG 格式!"),t||y("上传头像图片大小不能超过 5MB!"),a&&t},ee=(e,a)=>{const t=G.componentsBatch.selectionData=a,o=[];t.forEach((e=>{o.push(e.userId)})),G.componentsBatch.userIds=o,"t-zgj-dept.BatchDeactivation"===e.name&&(G.showToastDialog.header.data="t-zgj-dept.BatchDeactivation",G.showToastDialog.content.data="已选中以下用户，请问确定要批量停用吗？",G.showToastDialog.show=!0,G.showToastDialog.type="批量停用"),"t-zgj-dept.BatchEnable"===e.name&&(G.showToastDialog.header.data="t-zgj-dept.BatchEnable",G.showToastDialog.content.data="已选中以下用户，请问确定要批量启用吗？",G.showToastDialog.show=!0,G.showToastDialog.type="批量启用"),"t-zgj-seal.BatchDelete"===e.name&&(G.showToastDialog.header.data="t-zgj-seal.BatchDelete",G.showToastDialog.content.data="已选中以下用户，请问确定要批量删除吗？",G.showToastDialog.show=!0,G.showToastDialog.type="批量删除"),"t-zgj-findpwd.batchResetPassword"===e.name&&(S.value="t-zgj-findpwd.batchResetPassword",w.value=!0)};function ae(e,a,t,o){"userName"===a.property&&(v.userGet(e.userId).then((e=>{if(200===e.code){const a=[],t=[];e.data.partTimeOrgans.forEach((e=>{a.push({name:e.organName})})),e.data.roles.forEach((e=>{t.push(e.roleName)}));const o={name:e.data.userName?e.data.userName:"-",cellPhone:e.data.userTel?e.data.userTel:"-",account:e.data.accountNo?e.data.accountNo:"-",hostOrganName:e.data.hostOrganName?e.data.hostOrganName:"-",departmentList:a||"-",role:t?t.join("、"):"-",jobTitle:e.data.userTitle?e.data.userTitle:"-",mailbox:e.data.userMail?e.data.userMail:"-",EnterpriseWechatID:e.data.qweiNo?e.data.qweiNo:"-",NailID:e.data.dingdingNo?e.data.dingdingNo:"-",remark:e.data.readme?e.data.readme:"-",FacePicturePath:e.data.userFaceUri?_+e.data.userFaceUri:null};G.componentsDocumentsDetails.visible.forEach(((e,a)=>{"Staff-Details"===e.name&&(G.componentsDocumentsDetails.visible[a]["basicInformation-data"]=o)}))}})),G.componentsDocumentsDetails.show=!0)}const te=(e,a,o,l)=>{G.JyElMessageBox.oneBtn=!1,G.JyElMessageBox.confirmText="t-zgj-select.confirm";const s=[];s.push(a.userId),G.componentsBatch.userIds=s,"t-zgj-Edit"===o.name&&(G.title="t-zgj-Edit",G.componentsAddForm.formData.partTimeOrgans=[],G.componentsAddForm.formData.partTimeOrganIds=[],G.componentsAddForm.formData.roleIds=[],G.componentsAddForm.formData.roles=[],G.tabSelects.rolesSelected=[],G.tabSelects.partTimeOrgansSelected=[],G.componentsAddForm.formData.userFaceUri="",v.userGet(a.userId).then((e=>{G.tabSelects.leaderUserSelected=[{id:e.data.leaderUserId,name:e.data.leaderUserName,type:"user"}],G.tabSelects.hostOrganSelected=[{id:e.data.hostOrganId,name:e.data.hostOrganName,type:"organ"}];for(const a in e.data)G.componentsAddForm.formData[a]=e.data[a],"partTimeOrgans"===a&&e.data[a].length>0&&(G.tabSelects.partTimeOrgansSelected=e.data[a].map((e=>({value:e.organId,label:e.organName,haveChildren:e.haveChildren,type:"organ"}))),G.tabSelects.partTimeOrgansSelected=Ae(G.tabSelects.partTimeOrgansSelected),G.componentsAddForm.formData.partTimeOrganIds=e.data[a].map((e=>e.organId))),"roles"===a&&e.data[a].length>0&&(G.tabSelects.rolesSelected=Ae(G.tabSelects.rolesSelected),G.tabSelects.rolesSelected=e.data[a].map((e=>({value:e.roleId,label:e.roleName,type:"role"}))),G.componentsAddForm.formData.roleIds=e.data[a].map((e=>e.roleId)))})),t.value=!0),"status"===o.name&&"启用"===a.flag&&(G.JyElMessageBox.header.data="t-zgj-seal.deactivated",G.JyElMessageBox.content.data="确认要停用该员工吗？",G.JyElMessageBox.show=!0,G.JyElMessageBox.type="停用"),"status"===o.name&&"停用"===a.flag&&(G.JyElMessageBox.header.data="t-zgj-Enable",G.JyElMessageBox.content.data="确认要启用该员工吗？",G.JyElMessageBox.show=!0,G.JyElMessageBox.type="启用"),"t-zgj-Delete"===o.name&&(G.JyElMessageBox.column=a,G.JyElMessageBox.header.data="t-zgj-Delete",G.JyElMessageBox.content.data="确认要删除该员工吗？",G.JyElMessageBox.show=!0,G.JyElMessageBox.type="删除"),"t-zgj-findpwd.resetPassword"===o.name&&(S.value="t-zgj-findpwd.resetPassword",w.value=!0),"t-zgj-F_SEAL_CONSOLE_FACE_SETTING"===o.name&&v.userGet(a.userId,!0).then((e=>{F.value=!0,G.userUpdateFaceUri=e.data.userFaceUri?_+e.data.userFaceUri:null,G.userUpdateFaceId=e.data.fileId}),(()=>{F.value=!0,G.userUpdateFaceUri=null,G.userUpdateFaceId=null}))},oe=()=>{G.showToastDialog.show=!1,setTimeout((()=>{G.showToastDialog.oneBtn=!1,G.showToastDialog.confirmText="t-zgj-select.confirm"}),1e3)},re=e=>{if("停用"===e&&v.userDisable(G.componentsBatch.userIds[0]).then((a=>{200===a.code&&(x.success(`${e}成功！`),G.JyElMessageBox.show=!1,I.value.reloadData(!0))})),"启用"===e&&v.userEnable(G.componentsBatch.userIds[0]).then((a=>{200===a.code&&(x.success(`${e}成功！`),G.JyElMessageBox.show=!1,I.value.reloadData(!0))})),"删除"===e){if("启用"===G.JyElMessageBox.column.flag)return G.JyElMessageBox.header.data="t-zgj-Delete",G.JyElMessageBox.content.data="请停用该员工后再进行删除",G.JyElMessageBox.oneBtn=!0,G.JyElMessageBox.type="提示",G.JyElMessageBox.confirmText="t-zgj-know",!1;v.userDelete(G.componentsBatch.userIds[0]).then((a=>{200===a.code&&(x.success(`${e}成功！`),G.JyElMessageBox.show=!1,I.value.reloadData())}))}if("批量停用"===e&&v.userBatchDisable(G.componentsBatch.userIds).then((a=>{200===a.code&&(x.success(`${e}成功！`),G.showToastDialog.show=!1,I.value.reloadData(!0))})),"批量启用"===e&&v.userBatchEnable(G.componentsBatch.userIds).then((a=>{200===a.code&&(x.success(`${e}成功！`),G.showToastDialog.show=!1,I.value.reloadData(!0))})),"批量删除"===e){const a=[];if(G.componentsBatch.selectionData.forEach((e=>{"启用"===e.flag&&a.push(e)})),a.length>0)return G.showToastDialog.content.data="请将以下员工停用后再进行删除",G.componentsBatch.selectionData=a,G.showToastDialog.confirmText="t-zgj-know",G.showToastDialog.oneBtn=!0,!1;v.userBatchDelete(G.componentsBatch.userIds).then((a=>{200===a.code&&(x.success(`${e}成功！`),G.showToastDialog.show=!1,I.value.reloadData())}))}};function Ie(){G.componentsDocumentsDetails.show=!1}const xe=e=>{u.value.validate((async e=>{e?(L.value=!0,G.componentsAddForm.formData.partTimeOrgans=[],G.tabSelects.partTimeOrgansSelected=Ae(G.tabSelects.partTimeOrgansSelected),G.tabSelects.rolesSelected=Ae(G.tabSelects.rolesSelected),G.componentsAddForm.formData.partTimeOrganIds.forEach((e=>{G.tabSelects.partTimeOrgansSelected.forEach((a=>{e===a.value&&G.componentsAddForm.formData.partTimeOrgans.push({organId:a.value,organName:a.label,haveChildren:a.haveChildren})}))})),G.componentsAddForm.formData.roles=[],G.componentsAddForm.formData.roleIds.forEach((e=>{G.tabSelects.rolesSelected.forEach((a=>{e===a.value&&G.componentsAddForm.formData.roles.push({roleId:a.value,roleName:a.label})}))})),G.componentsAddForm.formData.userId?Oe(G.componentsAddForm.formData):Be(G.componentsAddForm.formData)):L.value=!1}))},Ae=e=>{const a=new Map;for(const t of e)a.set(t.value,t);return e=[...a.values()]},Be=e=>{v.userAdd(G.componentsAddForm.formData).then((e=>{x.success("新增员工成功！"),I.value.reloadData(),u.value.resetFields(),t.value=!1,G.tabSelects={searchSelected:[],hostOrganSelected:[],rolesSelected:[],leaderUserSelected:[]},L.value=!1})).catch((()=>{L.value=!1}))},Oe=e=>{v.userEdit(e).then((e=>{200===e.code&&(x.success("修改员工成功！"),u.value.resetFields(),I.value.reloadData(!0),t.value=!1,G.tabSelects={searchSelected:[],hostOrganSelected:[],rolesSelected:[],leaderUserSelected:[],partTimeOrgansSelected:[]}),L.value=!1}))},Ue=()=>{t.value=!1},Ee=e=>{T.value=e.organId,I.value.reloadData()},je=(e,a)=>{"partTimeOrgan"===a&&(G.tabSelects.searchSelected=G.tabSelects.partTimeOrgansSelected.length>0?G.tabSelects.partTimeOrgansSelected.map((e=>({...e,id:e.value,name:e.label,type:"organ"}))):[],G.tabSelects.partTimeOrgansSelected=Ne(G.tabSelects.searchSelected,e)),"roles"===a&&(G.tabSelects.searchSelected=G.tabSelects.rolesSelected.length>0?G.tabSelects.rolesSelected.map((e=>({...e,id:e.value,name:e.label,type:"role"}))):[],G.tabSelects.rolesSelected=Ne(G.tabSelects.searchSelected,e))},Ne=(e,a)=>Array.isArray(e)&&0!==e.length?e.filter((e=>e.id!==a)):e;return A((()=>{I.value.reloadData()})),(e,a)=>{const o=r("el-button"),s=r("el-dropdown-item"),b=r("el-dropdown-menu"),v=r("el-dropdown"),y=r("el-tree"),x=r("el-input"),A=r("el-form-item"),j=r("el-option"),V=r("el-select"),k=r("el-col"),P=r("el-row"),se=r("el-image"),Ae=r("el-upload"),Be=r("el-form"),Oe=N;return d(),n("div",null,[c(M,{url:"/user/page",ref_key:"table",ref:I,hasTree:!0,needAutoRequest:!1,componentsSearchForm:g(G).componentsSearchForm,componentsTableHeader:g(G).componentsTable.header,componentsBatch:g(G).componentsBatch,tableClick:"userName",statusColoum:"flag",openValue:"启用",onCellClick:ae,onCustomClick:te,onClickBatchButton:ee,queryParams:{organId:T.value}},{title:m((()=>[i("div",de,[i("div",null,p(e.$t("t-zgj-F_SYSTEM_PERSON_MANAGE")),1),i("div",ne,[i("div",ce,[c(o,{type:"primary",onClick:H},{default:m((()=>[h("+ "+p(e.$t("t-zgj-add")),1)])),_:1})]),i("div",me,[c(v,{"popper-class":"more-operation-dropdown"},{dropdown:m((()=>[c(b,null,{default:m((()=>[c(s,null,{default:m((()=>[h(p(e.$t("t-zgj-F_SYSTEM_PERSON_MANAGE_IMPORT")),1)])),_:1}),c(s,null,{default:m((()=>[h(p(e.$t("t-zgj-F_SYSTEM_FACEINFO_MANAGE_IMPORT")),1)])),_:1})])),_:1})])),default:m((()=>[c(o,null,{default:m((()=>[ie,i("span",null,p(e.$t("t-zgj-table.more.Operation")),1)])),_:1})])),_:1})])])])])),tree:m((()=>[i("div",ue,[c(y,B({data:g(G).componentsTree.data,props:g(G).componentsTree.defaultProps},g(G).componentsTree.defaultAttribute,{lazy:"",load:R,onCurrentChange:Ee}),null,16,["data","props"])])])),_:1},8,["componentsSearchForm","componentsTableHeader","componentsBatch","queryParams"]),c(Oe,{show:t.value,title:e.$t(g(G).title),centerBtn:!0,confirmLoading:L.value,confirmText:e.$t("t-zgj-operation.submit"),concelText:e.$t("t-zgj-operation.cancel"),width:950,"destroy-on-close":"",height:"calc(100vh - 500px)",onClose:Ue,onConfirm:xe,class:"staff-add"},{default:m((()=>[c(Be,{model:g(G).componentsAddForm.formData,rules:g(G).componentsAddForm.formRules,ref_key:"formStaffRef",ref:u,"label-width":"100px"},{default:m((()=>[c(A,{label:"姓名",prop:"userName"},{default:m((()=>[c(x,{modelValue:g(G).componentsAddForm.formData.userName,"onUpdate:modelValue":a[0]||(a[0]=e=>g(G).componentsAddForm.formData.userName=e),placeholder:"请输入姓名",clearable:"",maxlength:"64"},null,8,["modelValue"])])),_:1}),c(A,{label:"帐号",prop:"accountNo"},{default:m((()=>[c(x,{modelValue:g(G).componentsAddForm.formData.accountNo,"onUpdate:modelValue":a[1]||(a[1]=e=>g(G).componentsAddForm.formData.accountNo=e),placeholder:"请输入帐号",clearable:"",maxlength:"64"},null,8,["modelValue"])])),_:1}),c(A,{label:"手机号",prop:"userTel"},{default:m((()=>[c(x,{modelValue:g(G).componentsAddForm.formData.userTel,"onUpdate:modelValue":a[2]||(a[2]=e=>g(G).componentsAddForm.formData.userTel=e),maxlength:"11",placeholder:"请输入手机号",clearable:""},null,8,["modelValue"])])),_:1}),c(A,{label:"所属部门",prop:"hostOrganName"},{default:m((()=>[i("div",pe,[c(x,{class:"ap-box-contBox-input width-100",readonly:"",modelValue:g(G).componentsAddForm.formData.hostOrganName,"onUpdate:modelValue":a[3]||(a[3]=e=>g(G).componentsAddForm.formData.hostOrganName=e),placeholder:"请选择所属部门",onClick:a[4]||(a[4]=e=>W("hostOrgan",!1))},null,8,["modelValue"]),i("div",he,[i("img",{onClick:a[5]||(a[5]=e=>W("hostOrgan",!1)),class:"ap-box-contBox-icon-img",src:C,alt:""})])])])),_:1}),c(A,{label:"兼职部门",prop:"partTimeOrganIds"},{default:m((()=>[i("div",ge,[c(V,{modelValue:g(G).componentsAddForm.formData.partTimeOrganIds,"onUpdate:modelValue":a[6]||(a[6]=e=>g(G).componentsAddForm.formData.partTimeOrganIds=e),multiple:"",placeholder:"请选择兼职部门",style:{width:"100%"},"popper-class":"hidePoper","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":5,onClick:a[7]||(a[7]=e=>W("partTimeOrgan",!0)),onRemoveTag:a[8]||(a[8]=e=>je(e,"partTimeOrgan"))},{default:m((()=>[(d(!0),n(O,null,U(g(G).tabSelects.partTimeOrgansSelected,(e=>(d(),f(j,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),i("div",{class:"ap-box-contBox-icon",onClick:a[9]||(a[9]=e=>W("partTimeOrgan",!0))},fe)])])),_:1}),c(A,{label:"职位",prop:"userTitle"},{default:m((()=>[c(x,{modelValue:g(G).componentsAddForm.formData.userTitle,"onUpdate:modelValue":a[10]||(a[10]=e=>g(G).componentsAddForm.formData.userTitle=e),placeholder:"请输入职位",clearable:"",maxlength:"128"},null,8,["modelValue"])])),_:1}),c(A,{label:"邮箱",prop:"userMail"},{default:m((()=>[c(x,{modelValue:g(G).componentsAddForm.formData.userMail,"onUpdate:modelValue":a[11]||(a[11]=e=>g(G).componentsAddForm.formData.userMail=e),placeholder:"请输入邮箱",clearable:"",maxlength:"128"},null,8,["modelValue"])])),_:1}),c(A,{label:"工号",prop:"userNo"},{default:m((()=>[c(x,{modelValue:g(G).componentsAddForm.formData.userNo,"onUpdate:modelValue":a[12]||(a[12]=e=>g(G).componentsAddForm.formData.userNo=e),placeholder:"请输入工号",clearable:"",maxlength:"64"},null,8,["modelValue"])])),_:1}),c(A,{label:"主管",prop:"leaderUserName"},{default:m((()=>[i("div",be,[c(x,{class:"ap-box-contBox-input width-100",readonly:"",modelValue:g(G).componentsAddForm.formData.leaderUserName,"onUpdate:modelValue":a[13]||(a[13]=e=>g(G).componentsAddForm.formData.leaderUserName=e),placeholder:"请选择主管",onClick:a[14]||(a[14]=e=>W("leaderUser",!1))},null,8,["modelValue"]),c(x,{class:"ap-box-contBox-input width-100",readonly:"",type:"hidden",modelValue:g(G).componentsAddForm.formData.leaderUserId,"onUpdate:modelValue":a[15]||(a[15]=e=>g(G).componentsAddForm.formData.leaderUserId=e),placeholder:"请选择"},null,8,["modelValue"]),i("div",De,[i("img",{onClick:a[16]||(a[16]=e=>W("leaderUser",!1)),class:"ap-box-contBox-icon-img",src:C,alt:""})])])])),_:1}),c(A,{label:"角色",prop:"roleIds"},{default:m((()=>[i("div",we,[c(V,{modelValue:g(G).componentsAddForm.formData.roleIds,"onUpdate:modelValue":a[17]||(a[17]=e=>g(G).componentsAddForm.formData.roleIds=e),multiple:"",placeholder:"请选择角色",style:{width:"100%"},"popper-class":"hidePoper",onClick:a[18]||(a[18]=e=>W("roles",!0)),onRemoveTag:a[19]||(a[19]=e=>je(e,"roles"))},{default:m((()=>[(d(!0),n(O,null,U(g(G).tabSelects.rolesSelected,(e=>(d(),f(j,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),i("div",{class:"ap-box-contBox-icon",onClick:a[20]||(a[20]=e=>W("roles",!0))},ve)])])),_:1}),c(P,{gutter:20},{default:m((()=>[c(k,{span:12},{default:m((()=>[c(A,{label:"企业微信ID",prop:"qweiNo"},{default:m((()=>[c(x,{modelValue:g(G).componentsAddForm.formData.qweiNo,"onUpdate:modelValue":a[21]||(a[21]=e=>g(G).componentsAddForm.formData.qweiNo=e),placeholder:"请输入企业微信ID",clearable:"",maxlength:"256"},null,8,["modelValue"])])),_:1})])),_:1}),c(k,{span:12},{default:m((()=>[c(A,{label:"钉钉ID",prop:"dingdingNo"},{default:m((()=>[c(x,{modelValue:g(G).componentsAddForm.formData.dingdingNo,"onUpdate:modelValue":a[22]||(a[22]=e=>g(G).componentsAddForm.formData.dingdingNo=e),placeholder:"请输入钉钉ID",clearable:"",maxlength:"256"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(P,{gutter:20},{default:m((()=>[c(k,{span:12},{default:m((()=>[c(A,{label:"人脸照片",prop:"userFaceId"},{default:m((()=>[c(Ae,{ref:"uploadRef",action:`${g(_)}/user/uploadUserFace`,"show-file-list":!1,"list-type":"picture-card","on-success":X,"before-upload":Z},{tip:m((()=>[Fe,Te])),default:m((()=>[c(x,{type:"hidden",modelValue:g(G).componentsAddForm.formData.userFaceId,"onUpdate:modelValue":a[23]||(a[23]=e=>g(G).componentsAddForm.formData.userFaceId=e)},null,8,["modelValue"]),g(G).componentsAddForm.formData.userFaceUri?(d(),f(se,{key:0,src:g(_)+g(G).componentsAddForm.formData.userFaceUri,style:{padding:"6px"}},{error:m((()=>[])),_:1},8,["src"])):(d(),n("svg",Se,ye))])),_:1},8,["action"])])),_:1})])),_:1}),c(k,{span:12},{default:m((()=>[c(A,{label:"备注",prop:"readme"},{default:m((()=>[c(x,{type:"textarea",rows:7,modelValue:g(G).componentsAddForm.formData.readme,"onUpdate:modelValue":a[24]||(a[24]=e=>g(G).componentsAddForm.formData.readme=e),placehoder:"请输入备注",maxlength:"512"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["show","title","confirmLoading","confirmText","concelText"]),l.value?(d(),f(g(E),{key:0,show:l.value,multiple:g(G).multiple,"onUpdate:show":a[25]||(a[25]=e=>l.value=e),tabsShow:g(G).tabsShow,"onUpdate:searchSelected":Q,searchSelected:g(G).tabSelects.searchSelected,haveIncluded:!1},null,8,["show","multiple","tabsShow","searchSelected"])):D("",!0),i("div",_e,[c(z,{show:g(G).componentsDocumentsDetails.show,visible:g(G).componentsDocumentsDetails.visible,onClickClose:Ie},null,8,["show","visible"])]),c(g(J),{"onUpdate:modelValue":a[26]||(a[26]=e=>g(G).showToastDialog.show=!1),show:g(G).showToastDialog.show,selectionData:g(G).componentsBatch.selectionData,showToastDialogContent:g(G).showToastDialog,label:"userName",oneBtn:g(G).showToastDialog.oneBtn,confirmText:g(G).showToastDialog.confirmText,onCancel:oe,onSureAction:a[27]||(a[27]=e=>re(g(G).showToastDialog.type))},null,8,["show","selectionData","showToastDialogContent","oneBtn","confirmText"]),c(g($),{modelValue:g(G).JyElMessageBox.show,"onUpdate:modelValue":[a[28]||(a[28]=e=>g(G).JyElMessageBox.show=e),g(G).JyElMessageBox.show],JyElMessageBox:g(G).JyElMessageBox,confirmText:g(G).JyElMessageBox.confirmText,oneBtn:g(G).JyElMessageBox.oneBtn,onSubmitElMessageBox:a[29]||(a[29]=e=>re(g(G).JyElMessageBox.type))},null,8,["modelValue","JyElMessageBox","confirmText","oneBtn","onUpdate:modelValue"]),c(K,{show:w.value,title:S.value,userIds:g(G).componentsBatch.userIds,onOnConfirm:q,onOnCancel:Y},null,8,["show","title","userIds"]),c(le,{show:F.value,userId:g(G).componentsBatch.userIds[0],userFaceUri:g(G).userUpdateFaceUri,userUpdateFaceId:g(G).userUpdateFaceId,onOnConfirm:q,onOnCancel:Y},null,8,["show","userId","userFaceUri","userUpdateFaceId"])])}}},[["__scopeId","data-v-a8bd7420"]]);export{Ie as default};
