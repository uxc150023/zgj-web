import{H as e,V as t,J as a,K as o,M as r,N as i,O as l}from"./chunk-vform-d740b35c.js";import{a as s}from"./index-d761d72f.js";import{r as n,j as u,a1 as d,F as m,G as p,Q as c,u as f,E as g,n as F}from"./chunk-element-plus-a77de3d2.js";const y={languageMenu:!1,externalLink:!1,formTemplates:!0,widgetNameReadonly:!1,eventCollapse:!0,clearDesignerButton:!1,previewFormButton:!0,importJsonButton:!0,exportJsonButton:!0,exportCodeButton:!1,generateSFCButton:!0,toolbarMaxWidth:420,toolbarMinWidth:300,presetCssCode:"",resetFormJson:!1,productName:"",productTitle:"",logoHeader:!1},v={name:"JyVform"},b=Object.assign(v,{props:{mode:{type:String,default:""},designerConfig:{type:Object,default:()=>y},formJson:{type:Object,default:()=>{}},formData:{type:Object,default:()=>{}},optionData:{type:Object,default:()=>{}},hideModuleList:{type:Array,default:()=>[]},prefabricationFieldList:{type:Array,default:()=>[]},userType:{type:String,default:""}},emits:["formChange","appendButtonClick","buttonClick","on-loaded"],setup(v,{expose:b,emit:h}){const L=v,D=e(),J=n(null),C=n([]),T=n([]),j=n(0),k=u((()=>D.fileTypeList||[])),B=e=>{h("buttonClick",e)},W=e=>{h("appendButtonClick",e)},M=(e,t,a,o,r,i)=>{h("formChange",{fieldName:e,newValue:t,oldValue:a,formModel:o,subFormName:r,subFormRowIndex:i})},w=async e=>{try{const t=await s.formColumnBasic({applyTypeId:e}),a=[...o,...r,...i,...l].map((e=>e.type)).filter((e=>![...t.data.columSys,...t.data.columBiz].includes(e)));C.value=a,j.value++}catch(t){g.error(t)}},O=async e=>{try{const t=await s.getFormTemplate({applyTypeId:e});T.value=t.data.map((e=>JSON.parse(e.formTemplateInfo)));const a=J.value.getFieldWidgets();F((()=>{L.mode||a.length||J.value.setFormJson(JSON.parse(JSON.stringify(T.value[0].jsonUrl)))}))}catch(t){g.error(t)}};return d((()=>{h("on-loaded")})),b({getFormJson:()=>J.value.getFormJson()||"",clearDesigner:()=>{J.value.clearDesigner()},previewForm:()=>{J.value.previewForm()},getFieldWidgets:()=>J.value.getFieldWidgets(),exportJson:()=>{J.value.exportJson()},importJson:e=>{J.value.importJson(e)},getWidgetRef:e=>J.value.getWidgetRef(e),buildFormDataSchema:()=>J.value.buildFormDataSchema(),changeLanguage:()=>{J.value.changeLanguage()},setFormJson:e=>{J.value.setFormJson(e)},validateForm:async()=>{let e=!1;return await J.value.validateForm((t=>{e=t})),e},getFormData:async(e=!0)=>{try{return J.value.getFormData(e)}catch(t){return Promise.reject(t)}},setFormData:e=>{J.value.setFormData(e)},setFieldValue:(e,t)=>{J.value.setFieldValue(e,t)},resetForm:()=>{J.value.resetForm()},setReadMode:()=>{J.value.setReadMode()},showDialog:()=>{J.value.showDialog()},setFormColumnBasic:w,setFormTemplate:O,initDesigner:e=>{w(e),O(e)},disableForm:()=>{J.value.disableForm()},getFieldValue:async e=>{try{return J.value.getFieldValue(e)}catch(t){return Promise.reject(t)}},reloadOptionData:async e=>{try{return J.value.reloadOptionData(e)}catch(t){return Promise.reject(t)}},hideWidgets:(e=null)=>{J.value.hideWidgets(e)},disableWidgets:(e=null)=>{J.value.disableWidgets(e)}}),(e,o)=>(m(),p("div",null,["render"===L.mode?(m(),c(f(t),{key:0,"form-json":L.formJson,"form-data":L.formData,optionData:L.optionData,ref_key:"vFormRef",ref:J,onFormChange:M,onAppendButtonClick:W,onButtonClick:B,fileTypeList:f(k),prefabricationFieldList:L.prefabricationFieldList},null,8,["form-json","form-data","optionData","fileTypeList","prefabricationFieldList"])):(m(),c(f(a),{ref_key:"vFormRef",ref:J,bannedWidgets:C.value,"designer-config":f(y),hideModuleList:v.hideModuleList,prefabricationFieldList:L.prefabricationFieldList,templateList:T.value,fileTypeList:f(k),userType:v.userType,key:j.value},null,8,["bannedWidgets","designer-config","hideModuleList","prefabricationFieldList","templateList","fileTypeList","userType"]))]))}});export{b as default};
