import{_ as e,v as a,N as l,h as s,j as t,r as i,o as d,c as r,m as o,t as n,u,F as c,e as p,f as m,w as v,a as f,P as h,g,l as b,a8 as _,S as y,a2 as w,a9 as k,Y as x,W as I,aa as V,ab as F,Q as L,y as N,z as C}from"./main-e75bd94c.js";import{_ as U}from"./back-bdc75944.js";import{V as E}from"./VerificationBtn-c2bf7566.js";import{a as M}from"./navbar-b5f4b842.js";const j=e=>(N("data-v-85dcc1bb"),e=e(),C(),e),z={class:"personall-container"},G={key:0,class:"head"},T=j((()=>o("span",{class:"title"},"个人中心",-1))),q={class:"cont"},Z={class:"info"},S={class:"user"},D={class:"user-msg"},A={class:"user-name"},B={class:"user-phone"},O={class:"phone-item"},P=j((()=>o("div",{class:"label"},"手机号:",-1))),$={class:"number"},H=j((()=>o("div",{class:"right-line"},null,-1))),J={class:"phone-item"},R=j((()=>o("div",{class:"label"},"邮箱:",-1))),K={class:"number"},Q=w('<div class="back-img" data-v-85dcc1bb><svg width="296" height="120" viewBox="0 0 296 120" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-85dcc1bb><mask id="mask0_2802_81596" style="mask-type:alpha;" maskUnits="userSpaceOnUse" x="0" y="0" width="296" height="120" data-v-85dcc1bb><rect width="296" height="120" rx="2" fill="#F1F4F8" data-v-85dcc1bb></rect></mask><g mask="url(#mask0_2802_81596)" data-v-85dcc1bb><path d="M148.393 -31.4769L295.998 35.3846L145.608 104.272L-1.99775 37.4108L148.393 -31.4769Z" fill="url(#paint0_linear_2802_81596)" data-v-85dcc1bb></path><path d="M-2 37.4111L145.607 104.274V265.354H-2V37.4111Z" fill="url(#paint1_linear_2802_81596)" data-v-85dcc1bb></path><path d="M296 35.3877L145.607 104.277V265.356H293.215L296 35.3877Z" fill="#EDEDED" data-v-85dcc1bb></path></g><defs data-v-85dcc1bb><linearGradient id="paint0_linear_2802_81596" x1="147" y1="99.7167" x2="147" y2="-29.9573" gradientUnits="userSpaceOnUse" data-v-85dcc1bb><stop stop-color="white" data-v-85dcc1bb></stop><stop offset="0.702553" stop-color="white" stop-opacity="0" data-v-85dcc1bb></stop></linearGradient><linearGradient id="paint1_linear_2802_81596" x1="145.607" y1="151.889" x2="-41.6869" y2="151.889" gradientUnits="userSpaceOnUse" data-v-85dcc1bb><stop stop-color="#F0F0F0" data-v-85dcc1bb></stop><stop offset="0.80732" stop-color="#EEEEEE" stop-opacity="0" data-v-85dcc1bb></stop></linearGradient></defs></svg></div>',1),W={class:"cont-box"},Y={class:"label"},X={class:"column"},ee=j((()=>o("div",{class:"label"},"角色 :",-1))),ae={key:0},le=j((()=>o("div",{class:"label"},"职位 :",-1))),se={class:"column"},te=j((()=>o("div",{class:"label"},"工号 :",-1))),ie={class:"column"},de=j((()=>o("div",{class:"label"},"人脸图片 :",-1))),re={class:"column"},oe=j((()=>o("div",null,null,-1))),ne=j((()=>o("div",{class:"tips"},[o("div",null,"提示"),o("div",null,"1:支持上传JPG/JPEG/PNG格式的人脸图片，大小不超过5M"),o("div",null,"2:请尽量保证人脸图形完整清晰，没有遮挡")],-1))),ue=j((()=>o("div",{class:"from-label"},"已绑定手机号",-1))),ce=j((()=>o("div",{class:"from-label"},"新手机号",-1))),pe=j((()=>o("div",{class:"from-label"},"验证码",-1))),me=g(" 提交 "),ve=g("取消"),fe=j((()=>o("div",{class:"from-label"},"已绑定邮箱",-1))),he=j((()=>o("div",{class:"from-label"},"新邮箱",-1))),ge=g(" 提交 "),be=g("取消"),_e=e({setup(e){const w=a(null),N=a({"zgj-token":l().token}),C=s({phone:"",code:""}),j=s({email:""}),_e=a(null),ye=a(null),we=(e,a)=>{Ge.userFaceImage=a.url},ke=(e,a,l)=>{k(e)},xe=e=>"image/jpeg"!==e.type&&"image/png"!==e.type&&"image/jpg"!==e.type?(x.error("请上传格式为jpg、jpeg、png的人脸图片"),!1):!(e.size/1024/1024>5)||(x.error("人脸图片最多支持5MB"),!1),Ie=()=>{I.go(-1)},Ve=a(!1),Fe=a(!1),Le=()=>{Fe.value=!0,V((()=>{ye.value.resetFields(),j.email=""}))},Ne=e=>{Fe.value=!1},Ce=()=>{ye.value.validate((e=>{if(!e)return!1;M.changeEmail(j.email).then((e=>{Fe.value=!1,x.success("更改邮箱成功!"),qe()}))}))},Ue=()=>{Ve.value=!0,V((()=>{_e.value.resetFields(),C.phone="",C.code=""}))},Ee=e=>{Ve.value=!1},Me=()=>{_e.value.validate((e=>{if(!e)return!1;M.changeMobile({phone:C.phone,code:C.code}).then((e=>{Ve.value=!1,x.success("更改手机号成功!"),qe()}))}))},je={width:"120px",height:"32px",fontSize:"14px"},ze=a(!1),Ge=s({userId:"",userName:"",userTel:"",userMail:"",userTitle:"",userNo:"",userFaceImage:"",organInfoList:[],roleInfoList:[]}),Te=()=>{_e.value.validateField("phone",(async e=>{e&&M.sendChangeMobileVerificationCode({phone:C.phone,type:"LOGIN"}).then((e=>{w.value.countDown()})).catch((e=>{}))}))},qe=()=>{M.getUserInfo().then((e=>{Ge.userId=e.data.userId,Ge.userName=e.data.userName,Ge.userTel=e.data.userTel,Ge.userMail=e.data.userMail,Ge.userTitle=e.data.userTitle,Ge.userNo=e.data.userNo,Ge.userFaceImage=e.data.userFaceImage?F+e.data.userFaceImage:"",Ge.organInfoList=e.data.organInfoList,Ge.roleInfoList=e.data.roleInfoList,ze.value=!0})).catch((e=>{ze.value=!0}))},Ze=()=>{},Se=()=>{};return t((()=>{qe()})),(e,a)=>{const l=i("el-col"),s=i("el-row"),t=i("el-image"),k=i("el-icon"),x=i("el-upload"),I=i("el-form-item"),V=i("el-input"),F=i("el-form"),M=i("el-button");return d(),r("div",z,[ze.value?(d(),r("div",G,[o("img",{class:"img",src:U,alt:"",onClick:Ie}),T,o("div",q,[o("div",Z,[o("div",S,n(u(Ge).userName&&u(Ge).userName.substr(1)),1),o("div",D,[o("div",A,n(u(Ge).userName),1),o("div",B,[o("div",O,[P,o("div",$,n(u(Ge).userTel||"-"),1),o("div",{class:"change",onClick:Ue},"更换")]),H,o("div",J,[R,o("div",K,n(u(Ge).userMail||"-"),1),o("div",{class:"change",onClick:Le},"更换")])])]),Q]),o("div",W,[(d(!0),r(c,null,p(u(Ge).organInfoList,((e,a)=>(d(),m(s,{class:"row",key:a},{default:v((()=>[f(l,{span:2,style:{"min-width":"100px"}},{default:v((()=>[h(o("div",Y,"所属部门 :",512),[[L,0===a]])])),_:2},1024),f(l,{span:16},{default:v((()=>[o("div",X,n(e.organName),1)])),_:2},1024)])),_:2},1024)))),128)),f(s,{class:"row"},{default:v((()=>[f(l,{span:2,style:{"min-width":"100px"}},{default:v((()=>[ee])),_:1}),f(l,{span:16},{default:v((()=>[(d(!0),r(c,null,p(u(Ge).roleInfoList,((e,a)=>(d(),r("span",{class:"column",key:a},[g(n(e.roleName)+" ",1),a!==u(Ge).roleInfoList.length-1?(d(),r("span",ae," 、 ")):b("",!0)])))),128))])),_:1})])),_:1}),f(s,{class:"row"},{default:v((()=>[f(l,{span:2,style:{"min-width":"100px"}},{default:v((()=>[le])),_:1}),f(l,{span:16},{default:v((()=>[o("div",se,n(u(Ge).userTitle),1)])),_:1})])),_:1}),f(s,{class:"row"},{default:v((()=>[f(l,{span:2,style:{"min-width":"100px"}},{default:v((()=>[te])),_:1}),f(l,{span:16},{default:v((()=>[o("div",ie,n(u(Ge).userNo),1)])),_:1})])),_:1}),f(s,{class:"row"},{default:v((()=>[f(l,{span:2,style:{"min-width":"100px"}},{default:v((()=>[de])),_:1}),f(l,{span:16},{default:v((()=>[o("div",re,[f(x,{action:"/api/user/editUserCenterFace",headers:N.value,"show-file-list":!1,"list-type":"picture-card","on-success":we,"on-error":ke,"before-upload":xe,"on-preview":Se,"on-remove":Ze},{default:v((()=>[u(Ge).userFaceImage?(d(),m(t,{key:0,src:u(Ge).userFaceImage,style:{padding:"6px"}},null,8,["src"])):(d(),m(k,{key:1},{default:v((()=>[f(u(_))])),_:1}))])),_:1},8,["headers"])])])),_:1})])),_:1}),f(s,null,{default:v((()=>[f(l,{span:2,style:{"min-width":"80px"}},{default:v((()=>[oe])),_:1}),f(l,{span:16},{default:v((()=>[ne])),_:1})])),_:1})])]),f(y,{title:"更换手机号",modelValue:Ve.value,"onUpdate:modelValue":a[2]||(a[2]=e=>Ve.value=e),width:600,height:220},{footer:v((()=>[f(M,{type:"primary",onClick:Me},{default:v((()=>[me])),_:1}),f(M,{onClick:Ee},{default:v((()=>[ve])),_:1})])),default:v((()=>[f(F,{"label-position":"left",ref_key:"loginformRef",ref:_e,"label-width":"100px",model:u(C),"hide-required-asterisk":""},{default:v((()=>[f(I,null,{label:v((()=>[ue])),default:v((()=>[o("div",null,n(u(Ge).userTel),1)])),_:1}),f(I,{prop:"phone",required:"",rules:[{required:!0,message:"请输入正确的手机号",pattern:/^1(3[0-9]|4[01456879]|5[0-35-9]|6[2567]|7[0-8]|8[0-9]|9[0-35-9])\d{8}$/,trigger:"change"}]},{label:v((()=>[ce])),default:v((()=>[f(V,{modelValue:u(C).phone,"onUpdate:modelValue":a[0]||(a[0]=e=>u(C).phone=e),placeholder:"请输入",style:{width:"210px"},maxlength:"11",oninput:"value=value.replace(/^\\.+|[^\\d.]/g,'')"},null,8,["modelValue"])])),_:1},8,["rules"]),f(I,{class:"clearfix",label:"验证码",prop:"code",required:"",rules:[{required:!0,message:"验证码是6位数字",trigger:"change",pattern:/^\d{6}$/}]},{label:v((()=>[pe])),default:v((()=>[f(V,{modelValue:u(C).code,"onUpdate:modelValue":a[1]||(a[1]=e=>u(C).code=e),placeholder:"请输入验证码",style:{width:"210px"},maxlength:"6",oninput:"value=value.replace(/^\\.+|[^\\d.]/g,'')"},null,8,["modelValue"]),f(E,{customStyle:je,customClick:!0,onCustomClickFn:Te,ref_key:"verificationBtn",ref:w},null,512)])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),f(y,{title:"更换邮箱",modelValue:Fe.value,"onUpdate:modelValue":a[4]||(a[4]=e=>Fe.value=e),width:600,height:100},{footer:v((()=>[f(M,{type:"primary",onClick:Ce},{default:v((()=>[ge])),_:1}),f(M,{onClick:Ne},{default:v((()=>[be])),_:1})])),default:v((()=>[f(F,{"label-position":"left",ref_key:"loginEmailformRef",ref:ye,"label-width":"100px",model:u(j),"hide-required-asterisk":""},{default:v((()=>[f(I,null,{label:v((()=>[fe])),default:v((()=>[o("div",null,n(u(Ge).userMail||"暂未绑定邮箱"),1)])),_:1}),f(I,{prop:"email",required:"",rules:[{required:!0,message:"邮箱格式不正确",pattern:/^[a-z0-9A-Z]+[-|a-z0-9A-Z._]+@([a-z0-9A-Z]+(-[a-z0-9A-Z]+)?\.)+[a-z]{2,}$/,trigger:"change"}]},{label:v((()=>[he])),default:v((()=>[f(V,{modelValue:u(j).email,"onUpdate:modelValue":a[3]||(a[3]=e=>u(j).email=e),placeholder:"请输入",style:{width:"210px"}},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["model"])])),_:1},8,["modelValue"])])):b("",!0)])}}},[["__scopeId","data-v-85dcc1bb"]]);export{_e as default};
