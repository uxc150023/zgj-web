import e from"./index-e01f9df9.js";import{J as a}from"./JyTable-d62bb35b.js";import{a as o}from"./actionOneDialog-54db6636.js";import{a as t}from"./actionMoreDialog-7035c1c1.js";import{g as s,j as l,a3 as n}from"./chunk-vform-d740b35c.js";import{a as i}from"./businessRule-46ce96e1.js";import{_ as r}from"./index-c506766f.js";import{r as d,b as u,a1 as h,C as m,F as p,G as g,B as c,N as w,H as D,R as y,I as B,u as T,V as f,W as b}from"./chunk-element-plus-a77de3d2.js";import"./sangedian-6ea00dcf.js";import"./Layout-e90710df.js";import"./searchForm-96cc0cf8.js";import"./ketanchude-a94e84bc.js";import"./KDocumentTypeDialog-63de8919.js";import"./pagination-3c925a2b.js";import"./batch-6eb7c760.js";import"./index-d761d72f.js";import"./index-0b145b80.js";import"./cha-kong-c10eac4e.js";import"./index-5b654134.js";import"./yuan-hui-31c99901.js";import"./index-2f43646f.js";import"./home-back-d5b479fa.js";import"./logo-ad08cc7e.js";import"./request-util-79a78767.js";import"./main-673bace6.js";const C=[{prop:"ruleBusinessName",label:"业务规则名称","min-width":150,fixed:"left",show:!0},{prop:"ruleBusinessNo",label:"业务规则编码",width:180,align:"center",show:!0},{prop:"fileTypeName",label:"文件类型","min-width":180,show:!0},{prop:"sealUseTypeName",label:"用印类型",align:"center",width:120,show:!0},{prop:"flag",label:"状态",sortable:"custom",align:"center",width:120,show:!0},{prop:"modifyDatetime",label:"更新时间",sortable:"custom",align:"center",width:180,show:!0},{prop:"createUserName",label:"创建人",align:"center","min-width":150,show:!0},{prop:"caozuo",label:"操作",width:280,fixed:"right",align:"center",show:!0,rankDisplayData:[{name:"t-zgj-Edit"},{name:"t-zgj-Delete"},{name:"status"},{name:"t-zgj-qyWechat.Copy"}]}],j=e=>(f("data-v-ec9c8c16"),e=e(),b(),e),x={class:"title"},E=j((()=>D("div",null,"业务规则配置",-1))),M={class:"title-more"},v={class:"title-more-add"},J=y(" 业务规则复制 "),N=j((()=>D("div",{class:"from-label"},"业务规则名称",-1))),F=y(" 提交 "),I=y("取消"),k=s({setup(s){const f=d(!1),b=d([]),j=l(),k=u({componentsSearchForm:{data:[{id:"keyword",label:"关键词",type:"input",inCommonUse:!0,defaultAttribute:{placeholder:"业务规则名称/业务规则编码/创建人"}},{id:"flag",label:"状态",type:"select",inCommonUse:!0,defaultAttribute:{placeholder:"请选择"},options:[{value:"1",label:"启用"},{value:"0",label:"停用"}]},{id:"updateTime",label:"更新时间",type:"picker",inCommonUse:!1,requestType:"array",startRequest:"updateStartTime",endRequest:"updateEndTime",defaultAttribute:{type:"daterange","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"YYYY-MM-DD","disabled-date":e=>e.getTime()>Date.now(),"default-value":[new Date((new Date).setMonth((new Date).getMonth()-1)),new Date]},style:{}},{id:"sealUseTypeId",label:"用印类型",type:"select",inCommonUse:!1,defaultAttribute:{placeholder:"请选择"},options:[{value:"1",label:"物理用印"},{value:"2",label:"电子签章"}]},{id:"fileTypeId",requestParams:"fileTypeId",label:"文件类型",type:"derivable",inCommonUse:!1,defaultAttribute:{placeholder:"请选择",type:"fileType",multiple:!0,joinStr:","},options:[]}],butData:[{id:"more",name:"展开",type:"unfold",defaultAttribute:{type:"primary"},style:{}},{id:"inquire",name:"查询",type:"click",defaultAttribute:{type:"primary"},style:{}},{id:"reset",name:"重置",type:"click",defaultAttribute:{},style:{}}]},componentsTable:{header:C},componentsBatch:{selectionData:[],defaultAttribute:{disabled:!0},data:[{name:"t-zgj-seal.BatchDelete"},{name:"t-zgj-dept.BatchEnable"},{name:"t-zgj-dept.BatchDeactivation"}]},JyElMessageBox:{type:"",id:"",flag:"",show:!1,header:{data:""},content:{data:""}},showToastDialog:{curKey:"",type:"",show:!1,header:{data:""},content:{data:""}},showFormDialog:{show:!1,header:{data:"业务规则复制"},content:{data:""},ruleBusinessName:""},showToastDialogContent:{show:!1,header:"",content:"",selectionTableData:{headers:[{prop:"fileTypeName",label:"文件类型",align:"center"},{prop:"ruleBusinessName",label:"关联业务规则(已启用)",align:"center"}],data:[]}}}),z=d(null),V=d(null),U=()=>{j.push({name:"EditBusinessRule"})};function _(e,a,o,t){"ruleBusinessName"===a.property&&(f.value=!0,b.value=[{value:"detail",params:e.ruleBusinessId},{value:"record",params:{operationId:""}}])}function q(e,a,o,t){"t-zgj-Edit"===o.name&&j.push({name:"EditBusinessRule",query:{ruleBusinessId:a.ruleBusinessId}}),"t-zgj-Delete"===o.name&&(k.JyElMessageBox.type=o.name,k.JyElMessageBox.id=a.ruleBusinessId,k.JyElMessageBox.header.data="提示？",k.JyElMessageBox.content.data="您确定要删除该记录吗？",k.JyElMessageBox.show=!0),"status"===o.name&&(k.JyElMessageBox.type=o.name,k.JyElMessageBox.flag=a.flag,k.JyElMessageBox.id=a.ruleBusinessId,k.JyElMessageBox.header.data="提示？",k.JyElMessageBox.content.data=`您确定要${"1"===a.flag?"停用":"启用"}该记录吗？`,k.JyElMessageBox.show=!0),"t-zgj-qyWechat.Copy"===o.name&&(k.showFormDialog.show=!0,k.showFormDialog.id=a.ruleBusinessId,k.showFormDialog.ruleBusinessName=a.ruleBusinessName+" - 副本")}const A=()=>{V.value.validate((e=>{e&&i.ruleCopy({ruleBusinessId:k.showFormDialog.id,ruleBusinessName:k.showFormDialog.ruleBusinessName}).then((()=>{n("复制成功"),k.showFormDialog.show=!1,z.value.reloadData()}))}))},S=()=>{k.showFormDialog.show=!1},K=()=>{"t-zgj-Delete"===k.JyElMessageBox.type?i.ruleBatchDelete({ruleBusinessIds:[k.JyElMessageBox.id]}).then((()=>{n("删除成功"),z.value.reloadData()}),(e=>{e.data&&(k.showToastDialogContent.show=!0)})).finally((()=>{k.JyElMessageBox.show=!1})):"status"===k.JyElMessageBox.type&&i.ruleDisable({ruleBusinessId:k.JyElMessageBox.id,flag:"1"===k.JyElMessageBox.flag?"0":"1"}).then((()=>{n("1"===k.JyElMessageBox.flag?"停用成功":"启用成功"),z.value.reloadData()}),(e=>{e.data&&(k.showToastDialogContent.show=!0,k.showToastDialogContent.header="1"===k.JyElMessageBox.flag?"停用失败":"启用失败",k.showToastDialogContent.content="当前业务规则中关联的一下文件类型已用于其他已启用的业务规则，请确保一个文件类型仅关联一个已启用的业务规则",k.showToastDialogContent.selectionTableData.data=e.data)})).finally((()=>{k.JyElMessageBox.show=!1}))},R=(e,a)=>{k.componentsBatch.selectionData=a,"t-zgj-seal.BatchDelete"===e.name?(k.showToastDialog.show=!0,k.showToastDialog.type=e.name,k.showToastDialog.curKey="ruleBusinessName",k.showToastDialog.header={data:"批量删除"},k.showToastDialog.content={data:"是否删除以下业务规则？"}):"t-zgj-dept.BatchEnable"===e.name?(k.showToastDialog.show=!0,k.showToastDialog.type=e.name,k.showToastDialog.curKey="ruleBusinessName",k.showToastDialog.header={data:"批量启用"},k.showToastDialog.content={data:"是否启用以下业务规则？"}):"t-zgj-dept.BatchDeactivation"===e.name&&(k.showToastDialog.show=!0,k.showToastDialog.type=e.name,k.showToastDialog.curKey="ruleBusinessName",k.showToastDialog.header={data:"批量停用"},k.showToastDialog.content={data:"是否停用以下业务规则？"})},Y=()=>{"t-zgj-seal.BatchDelete"===k.showToastDialog.type?i.ruleBatchDelete({ruleBusinessIds:k.componentsBatch.selectionData.map((e=>e.ruleBusinessId))}).then((()=>{n("删除成功"),z.value.reloadData()}),(e=>{e.data&&(k.showToastDialogContent.show=!0,k.showToastDialogContent.header="删除失败",k.showToastDialogContent.content=e.msg,k.showToastDialogContent.selectionTableData.data=e.data)})).finally((()=>{k.showToastDialog.show=!1})):"t-zgj-dept.BatchEnable"===k.showToastDialog.type?i.ruleBatchEnable({ruleBusinessIds:k.componentsBatch.selectionData.map((e=>e.ruleBusinessId))}).then((()=>{n("启用成功"),z.value.reloadData()}),(e=>{e.data&&(k.showToastDialogContent.show=!0,k.showToastDialogContent.header="启用失败",k.showToastDialogContent.content=e.msg,k.showToastDialogContent.selectionTableData.data=e.data)})).finally((()=>{k.showToastDialog.show=!1})):"t-zgj-dept.BatchDeactivation"===k.showToastDialog.type&&i.ruleBatchDisable({ruleBusinessIds:k.componentsBatch.selectionData.map((e=>e.ruleBusinessId))}).then((()=>{n("停用成功"),z.value.reloadData()}),(e=>{e.data&&(k.showToastDialogContent.show=!0,k.showToastDialogContent.header="停用失败",k.showToastDialogContent.content=e.msg,k.showToastDialogContent.selectionTableData.data=e.data)})).finally((()=>{k.showToastDialog.show=!1}))};return h((()=>{})),(s,l)=>{const n=m("el-button"),i=m("el-input"),d=m("el-form-item"),u=m("el-form"),h=m("JyElMessageBox"),C=e;return p(),g("div",null,[c(a,{url:"/biz/rule/page",ref_key:"table",ref:z,method:"POST",componentsSearchForm:T(k).componentsSearchForm,componentsTableHeader:T(k).componentsTable.header,componentsBatch:T(k).componentsBatch,tableClick:"ruleBusinessName",statusColoum:"flag",openValue:"1",onCellClick:_,onCustomClick:q,onClickBatchButton:R},{title:w((()=>[D("div",x,[E,D("div",M,[D("div",v,[c(n,{type:"primary",onClick:U},{default:w((()=>[y("+ "+B(s.$t("t-zgj-add")),1)])),_:1})])])])])),_:1},8,["componentsSearchForm","componentsTableHeader","componentsBatch"]),c(r,{modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=e=>f.value=e),modulesName:"rule_business_management",detailParams:b.value},null,8,["modelValue","detailParams"]),c(o,{modelValue:T(k).JyElMessageBox.show,"onUpdate:modelValue":[l[1]||(l[1]=e=>T(k).JyElMessageBox.show=e),T(k).JyElMessageBox.show],JyElMessageBox:T(k).JyElMessageBox,onSubmitElMessageBox:K},null,8,["modelValue","JyElMessageBox","onUpdate:modelValue"]),c(T(t),{"onUpdate:modelValue":l[2]||(l[2]=e=>T(k).showToastDialog.show=!1),show:T(k).showToastDialog.show,selectionData:T(k).componentsBatch.selectionData,showToastDialogContent:T(k).showToastDialog,label:"formName",onSureAction:Y,curKey:T(k).showToastDialog.curKey},null,8,["show","selectionData","showToastDialogContent","curKey"]),c(h,{modelValue:T(k).showFormDialog.show,"onUpdate:modelValue":l[4]||(l[4]=e=>T(k).showFormDialog.show=e),show:T(k).showFormDialog.show,defaultAttribute:{}},{header:w((()=>[J])),content:w((()=>[c(u,{ref_key:"formRef",ref:V,"label-position":"left","label-width":"100px",model:T(k).showFormDialog,"hide-required-asterisk":""},{default:w((()=>[c(d,{prop:"ruleBusinessName",rules:[{required:!0,message:"业务规则名称不能为空",trigger:"change"}]},{label:w((()=>[N])),default:w((()=>[c(i,{modelValue:T(k).showFormDialog.ruleBusinessName,"onUpdate:modelValue":l[3]||(l[3]=e=>T(k).showFormDialog.ruleBusinessName=e),placeholder:"请输入",style:{width:"210px"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),footer:w((()=>[c(n,{type:"primary",onClick:A},{default:w((()=>[F])),_:1}),c(n,{onClick:S},{default:w((()=>[I])),_:1})])),_:1},8,["modelValue","show"]),c(C,{show:T(k).showToastDialogContent.show,showToastDialogContent:T(k).showToastDialogContent,"onUpdate:modelValue":l[5]||(l[5]=e=>T(k).showToastDialogContent.show=!1)},null,8,["show","showToastDialogContent"])])}}},[["__scopeId","data-v-ec9c8c16"]]);export{k as default};
